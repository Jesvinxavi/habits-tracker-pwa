const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-CM0JCX04.js","assets/chunk-D8P7fKnl.js","assets/chunk-97VqPUVn.js","assets/RestToggle-B5rqNNKe.js","assets/chunk-Dwp9fxXX.js"])))=>i.map(i=>d[i]);
import{h as e,g as t,d as n,A as s,_ as i,s as a}from"./chunk-D8P7fKnl.js";import{c as o,o as r,m as c,a as l}from"./chunk-97VqPUVn.js";import{e as d,a as u,g,j as y,i as p,b as m,k as h,l as f,M as v,D as b,c as x,m as w}from"./chunk-CM0JCX04.js";import{S as k,A as S,a as D}from"./chunk-Dwp9fxXX.js";let L={isRunning:!1,elapsedSeconds:0,startTime:null,pausedTime:0},E=null,A=null;function _(){return{...L}}function I(e){L.isRunning&&(L.isRunning=!1,E&&(clearInterval(E),E=null),e&&e())}function C(e){A=e}function T(){L={isRunning:!1,elapsedSeconds:0,startTime:null,pausedTime:0},E&&(clearInterval(E),E=null),A=null}let $=!1,M=0,q=null,B=!1,R=!1;function H(e){const t=document.getElementById("close-search-btn"),n=document.getElementById("fitness-view");t&&t.classList.remove("hidden"),n&&n.classList.add("search-expanded"),$=!0,e&&e()}function j(e){const t=document.getElementById("close-search-btn"),n=document.getElementById("fitness-activity-search"),s=document.getElementById("fitness-view");t&&t.classList.add("hidden"),s&&s.classList.remove("search-expanded"),n&&""!==n.value&&(n.value=""),n&&n.classList.remove("temp-focus"),M=0,B=!1,R=!1,q&&(clearTimeout(q),q=null),$=!1,e&&e()}function N(){const e=document.getElementById("fitness-activity-search");return e?e.value:""}function O(){return $}function F(e){return`<div class="muscle-header pl-3 py-1 text-sm font-semibold text-gray-700 dark:text-gray-300">${t=e,t.split("_").map(e=>d(e)).join(" ")}</div>`;var t}function P(e,t=null,n=null){const s=`search-category-${e.id}`,i=`\n    <button class="search-expand-btn h-5 w-5 flex items-center justify-center text-black" data-category-id="${e.id}">\n      <span class="material-icons transition-transform leading-none">expand_more</span>\n    </button>\n  `,a=`\n    <button class="search-edit-category-btn w-8 h-8 rounded-full flex items-center justify-center ml-2" data-category-id="${e.id}" style="background-color:${e.color}">\n      <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n        <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke="currentColor" stroke-width="2"/>\n        <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2"/>\n      </svg>\n    </button>\n  `;let o="";return n?o=Object.entries(n).map(([t,n])=>`\n      <div class="muscle-group mb-2">\n        ${F(t)}\n        <div class="category-activities pl-6">\n          ${n.map(t=>W(t,e)).join("")}\n        </div>\n      </div>\n    `).join(""):t&&(o=`\n      <div class="category-activities pl-6">\n        ${t.map(t=>W(t,e)).join("")}\n      </div>\n    `),`\n    <div class="search-category-section mb-4" data-category-id="${e.id}" id="${s}">\n      <div class="search-category-header-wrapper flex items-center">\n        <div class="search-category-header flex items-center justify-between px-4 py-1 rounded-t-xl cursor-pointer select-none flex-grow" style="background:${e.color}20;">\n          <div class="category-title flex items-center gap-2">\n            <span class="text-lg" aria-hidden="true">${e.icon}</span>\n            <span class="font-semibold text-gray-900 dark:text-white">${e.name}</span>\n          </div>\n          ${i}\n        </div>\n        <div class="-ml-2">${a}</div>\n      </div>\n      <div class="search-category-content">\n        ${o}\n      </div>\n    </div>\n  `}function W(t,n){return`\n    <div style="margin-bottom: 0.25rem;">\n      <div class="search-activity-item activity-card flex items-center px-3 py-2 rounded-xl w-full transition-colors focus:outline-none focus:ring-2 focus:ring-ios-blue focus:ring-offset-2 dark:focus:ring-offset-gray-800" style="border: 3px solid ${n.color}; background-color: ${e(n.color,.05)};" data-activity-id="${t.id}">\n        <div class="activity-icon w-9 h-9 flex-shrink-0 rounded-full flex items-center justify-center mr-3 text-xl" style="border: 2px solid ${n.color}; color: ${n.color};" aria-hidden="true">\n          ${t.icon||n.icon}\n        </div>\n        <div class="activity-content flex-grow text-left">\n          <div class="activity-name font-semibold leading-tight text-gray-900 dark:text-white">${t.name}</div>\n        </div>\n        <div class="activity-actions flex items-center gap-2 ml-3">\n          <button class="stats-btn w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-600 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors" data-activity-id="${t.id}" title="View Stats">\n            <span class="material-icons text-lg">bar_chart</span>\n          </button>\n          <button class="edit-activity-btn w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors" data-activity-id="${t.id}" title="Edit Activity">\n            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n              <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke="currentColor" stroke-width="2"/>\n              <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2"/>\n            </svg>\n          </button>\n        </div>\n      </div>\n    </div>\n  `}function V(e){const t=document.querySelector(`#search-category-${e}`);if(!t)return;const n=t.querySelector(".search-category-content"),s=t.querySelector(".search-expand-btn .material-icons");if(!n||!s)return;t.classList.contains("collapsed")?(n.style.maxHeight="0px",n.style.overflow="hidden",n.classList.remove("hidden"),n.offsetHeight,n.style.maxHeight=n.scrollHeight+"px",s.style.transform="rotate(0deg)",t.classList.remove("collapsed"),setTimeout(()=>{t.classList.contains("collapsed")||(n.style.maxHeight="",n.style.overflow="")},300)):(n.style.maxHeight=n.scrollHeight+"px",n.style.overflow="hidden",n.offsetHeight,n.style.maxHeight="0px",s.style.transform="rotate(-90deg)",t.classList.add("collapsed"),setTimeout(()=>{t.classList.contains("collapsed")&&n.classList.add("hidden")},300))}function Y(e,t){const n=e.dataset.categoryId,s=document.querySelector(".category-color-picker");s&&s.remove();const i=document.createElement("div");i.className="category-color-picker bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700",i.style.cssText="\n    position: absolute;\n    z-index: 1000;\n    border-radius: 12px;\n    padding: 12px;\n    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);\n    display: grid;\n    grid-template-columns: repeat(3, 1fr);\n    gap: 12px;\n    width: 180px;\n    max-width: 180px;\n  ";const a=function(e){if(!e)return"";if(e.startsWith("#"))return e;const t=e.match(/\d+/g);if(!t||t.length<3)return"";const n=parseInt(t[0]),s=parseInt(t[1]),i=parseInt(t[2]);return`#${((1<<24)+(n<<16)+(s<<8)+i).toString(16).slice(1)}`}(e.style.backgroundColor);[{hex:"#ef4444",gradient:"from-red-500 to-red-600",shadow:"hover:shadow-red-500/25"},{hex:"#f97316",gradient:"from-orange-500 to-orange-600",shadow:"hover:shadow-orange-500/25"},{hex:"#eab308",gradient:"from-yellow-500 to-yellow-600",shadow:"hover:shadow-yellow-500/25"},{hex:"#22c55e",gradient:"from-green-500 to-green-600",shadow:"hover:shadow-green-500/25"},{hex:"#06b6d4",gradient:"from-cyan-500 to-cyan-600",shadow:"hover:shadow-cyan-500/25"},{hex:"#3b82f6",gradient:"from-blue-500 to-blue-600",shadow:"hover:shadow-blue-500/25"},{hex:"#8b5cf6",gradient:"from-violet-500 to-violet-600",shadow:"hover:shadow-violet-500/25"},{hex:"#ec4899",gradient:"from-pink-500 to-pink-600",shadow:"hover:shadow-pink-500/25"},{hex:"#64748b",gradient:"from-slate-500 to-slate-600",shadow:"hover:shadow-slate-500/25"},{hex:"#374151",gradient:"from-gray-700 to-gray-800",shadow:"hover:shadow-gray-500/25"},{hex:"#7c2d12",gradient:"from-red-900 to-red-950",shadow:"hover:shadow-red-900/25"},{hex:"#166534",gradient:"from-green-800 to-green-900",shadow:"hover:shadow-green-800/25"}].forEach(({hex:s,gradient:o,shadow:r})=>{const c=document.createElement("button");c.className=`color-option w-10 h-10 rounded-xl bg-gradient-to-br ${o} shadow-lg hover:scale-110 transition-all duration-200 ${r}`,s===a&&c.classList.add("ring-2","ring-black","dark:ring-white","ring-offset-2","ring-offset-white","dark:ring-offset-gray-800"),c.addEventListener("click",()=>{t&&t(n,s,e),i.remove()}),i.appendChild(c)});const o=e.getBoundingClientRect(),r=document.querySelector("#activities-search-section"),c=r.getBoundingClientRect();i.style.top=o.top-c.top+"px",i.style.right=c.right-o.left+8+"px",r.appendChild(i);const l=t=>{i.contains(t.target)||t.target===e||(i.remove(),document.removeEventListener("click",l))};setTimeout(()=>{document.addEventListener("click",l)},100)}async function z(e){const{getLocalMidnightISOString:a}=await i(async()=>{const{getLocalMidnightISOString:e}=await import("./chunk-CM0JCX04.js").then(e=>e.A);return{getLocalMidnightISOString:e}},__vite__mapDeps([0,1,2])),o={id:u(),name:e.name,categoryId:e.categoryId,icon:e.icon||t().activityCategories.find(t=>t.id===e.categoryId)?.icon||"🎯",createdAt:a(new Date),...e};return n(s.addActivity(o)),o}function G(e,i,a={}){const o=t().activities.find(t=>t.id===e);if(!o)return null;const r=i.slice(0,10),c={id:u(),activityId:e,activityName:o.name,categoryId:o.categoryId,date:r,timestamp:(new Date).toISOString(),duration:a.duration||null,intensity:a.intensity||null,notes:a.notes||"",...a};return n(s.recordActivity(e,i,a)),c}function U(e){const n=e.slice(0,10);return t().recordedActivities[n]||[]}function X(e,t){const i=t.slice(0,10);n((t,n)=>{const a={...n().recordedActivities};a[i]&&(a[i]=a[i].filter(t=>t.id!==e),0===a[i].length&&delete a[i]),t(s.importData({recordedActivities:a}))})}function K(e,t,i={}){const a=t.slice(0,10);n((t,n)=>{const o={...n().recordedActivities};if(o[a]){const t=o[a].findIndex(t=>t.id===e);-1!==t&&(o[a][t]={...o[a][t],...i})}t(s.importData({recordedActivities:o}))})}function J(e){return t().activityCategories.find(t=>t.id===e)}function Q(e){return t().activities.find(t=>t.id===e)}function Z(e){const t={};return e.forEach(e=>{let n=e.muscleGroup;if(!n&&e.activityId){const t=Q(e.activityId);n=t?.muscleGroup}n||(n="Other"),t[n]||(t[n]=[]),t[n].push(e)}),t}function ee(e){n(s.deleteActivity(e))}function te(e,t){n(s.updateActivity(e,t))}function ne(e={}){const t=document.createElement("div");t.className="search-panel";const n=function(e,t,n){const s=document.createElement("div");s.className="search-container px-4",s.style.position="relative",s.innerHTML='\n    <div class="search-input relative border-2 border-gray-300 dark:border-gray-500 rounded-xl bg-gray-100 dark:bg-gray-700 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-400">\n      <svg class="w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n        <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>\n      </svg>\n      <input id="fitness-activity-search" type="text" placeholder="Search activities..." class="w-full pl-10 pr-10 py-3 bg-transparent text-gray-700 dark:text-gray-300 rounded-xl border-none outline-none focus:ring-0 transition-colors cursor-pointer placeholder-gray-500 dark:placeholder-gray-400" autocomplete="off" spellcheck="false">\n      <button id="close-search-btn" class="absolute right-3 top-1/2 transform -translate-y-1/2 w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors hidden rounded-full hover:bg-gray-200 dark:hover:bg-gray-600">\n        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n          <path d="M6 18L18 6M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>\n        </svg>\n      </button>\n    </div>\n  ';const i=s.querySelector("#fitness-activity-search"),a=s.querySelector("#close-search-btn");return i.addEventListener("click",e=>{if(e.preventDefault(),e.stopPropagation(),$&&R)return B=!0,void i.focus();M++,q&&clearTimeout(q),q=setTimeout(()=>{M=0,B=!1},400),1===M?($?(R=!0,i.classList.add("temp-focus")):(H(t),R=!0,i.classList.add("temp-focus")),B=!1,i.blur()):2===M&&(B=!0,i.classList.remove("temp-focus"),i.focus())}),i.addEventListener("focus",e=>{if(!B&&(M>0||i.classList.contains("temp-focus")))return e.preventDefault(),void i.blur();$||H(t)}),i.addEventListener("input",t=>{const n=t.target.value;$&&e&&e(n)}),a&&a.addEventListener("click",e=>{e.stopPropagation(),e.preventDefault(),i.value="",j(n)}),document.addEventListener("click",e=>{if($&&!i.contains(e.target)&&!document.querySelector("#activities-search-section")?.contains(e.target)){if(e.target.closest(".modal")||e.target.closest("[data-modal]")||e.target.closest(".modal-backdrop")||e.target.closest(".modal-content"))return;if(e.target.closest(".color-picker")||e.target.closest(".color-option")||e.target.closest("[data-color]"))return;j(n)}}),i.addEventListener("keydown",e=>{if("Escape"===e.key)j(n),i.blur();else if("ArrowDown"===e.key&&$){e.preventDefault();const t=document.querySelector("#activities-search-section .search-activity-item");t&&t.focus()}}),s}(se,ie,ae),s=function(){const e=document.createElement("div");return e.id="activities-search-section",e.className="activities-search-section hidden",e.innerHTML='\n    <div class="activities-search-content">\n      \x3c!-- Content will be populated dynamically --\x3e\n    </div>\n  ',e}();n.appendChild(s),t.appendChild(n),t._callbacks=e;const i=a(()=>{if(O()){oe(N())}});return t._unsubscribe=i,document.addEventListener("ActivityDeleted",()=>{if(O()){oe(N())}}),document.addEventListener("modalClosed",e=>{const t=e.detail?.modalId;["activity-stats-modal"].includes(t)&&O()&&ae()}),t}function se(e){oe(e)}function ie(){!function(){const e=document.getElementById("activities-search-section");if(!e)return;e.classList.remove("hidden"),e.offsetHeight,e.classList.add("expanded");const t=window.innerHeight-83-40,n=e.querySelector(".activities-search-content");n&&(n.style.maxHeight=`${t}px`)}();oe(N())}function ae(){!function(){const e=document.getElementById("activities-search-section");e&&(e.classList.remove("expanded"),setTimeout(()=>{e.classList.add("hidden")},400))}()}function oe(e=""){let n="";if(""===e.trim()){const e=function(){const e={};return t().activityCategories.forEach(n=>{e[n.id]={category:n,activities:t().activities.filter(e=>e.categoryId===n.id)}}),e}();Object.values(e).forEach(({category:e,activities:t})=>{if(0!==t.length)if("strength"===e.id){const s=Z(t);n+=P(e,null,s)}else n+=P(e,t)})}else{const s=function(e){if(!e||""===e.trim())return t().activities;const n=e.toLowerCase().trim();return t().activities.filter(e=>e.name.toLowerCase().includes(n))}(e);if(s.length>0){const e={};s.forEach(t=>{const n=J(t.categoryId);e[n.id]||(e[n.id]={category:n,activities:[]}),e[n.id].activities.push(t)}),Object.values(e).forEach(({category:e,activities:t})=>{if("strength"===e.id){const s=Z(t);n+=P(e,null,s)}else n+=P(e,t)})}}""===n&&(n=""===e.trim()?'\n        <div class="flex flex-col items-center justify-center py-8 text-center space-y-2">\n          <span class="material-icons text-4xl text-gray-400">fitness_center</span>\n          <p class="text-gray-600 dark:text-gray-400">No activities available</p>\n          <p class="text-sm text-gray-500">Tap "New Activity" to create your first activity</p>\n        </div>\n      ':'\n        <div class="flex flex-col items-center justify-center py-8 text-center space-y-2">\n          <span class="material-icons text-4xl text-gray-400">search_off</span>\n          <p class="text-gray-600 dark:text-gray-400">No activities found</p>\n          <p class="text-sm text-gray-500">Try a different search term or create a new activity</p>\n        </div>\n      '),function(e){const t=document.querySelector("#activities-search-section .activities-search-content");t&&(t.innerHTML=e)}(n),function(){const e=document.querySelector("#activities-search-section .activities-search-content");if(!e)return;const t=document.querySelector(".search-panel"),n=t?._callbacks||{};(function(e,t){e&&(e.querySelectorAll(".search-expand-btn").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation(),V(e.dataset.categoryId)})}),e.querySelectorAll(".search-category-header").forEach(e=>{e.addEventListener("click",t=>{t.target.closest(".search-expand-btn")||t.target.closest(".search-edit-category-btn")||V(e.closest(".search-category-section").dataset.categoryId)})}),e.querySelectorAll(".search-edit-category-btn").forEach(e=>{e.addEventListener("click",n=>{n.stopPropagation(),t&&t(e)})}))})(e,re),function(e,t,n,s){e&&(e.querySelectorAll(".stats-btn").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation(),n&&n(e.dataset.activityId)})}),e.querySelectorAll(".edit-activity-btn").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation(),s&&s(e.dataset.activityId)})}),e.querySelectorAll(".search-activity-item").forEach(e=>{e.addEventListener("click",n=>{if(n.target.closest(".activity-actions"))return;const s=e.dataset.activityId;t&&t(s)})}))}(e,n.onActivityClick,n.onStatsClick,n.onEditClick),function(e){const t=document.querySelectorAll("#activities-search-section .search-activity-item");t.forEach((n,s)=>{n.setAttribute("tabindex","0"),n.addEventListener("keydown",i=>{switch(i.key){case"ArrowDown":i.preventDefault();const a=t[s+1];a&&a.focus();break;case"ArrowUp":if(i.preventDefault(),0===s){const e=document.getElementById("fitness-activity-search");e&&e.focus()}else{const e=t[s-1];e&&e.focus()}break;case"Enter":case" ":i.preventDefault(),n.click();break;case"Escape":i.preventDefault(),e&&e();const o=document.getElementById("fitness-activity-search");o&&o.focus()}}),n.addEventListener("focus",()=>{n.style.outline="2px solid #3B82F6",n.style.outlineOffset="2px"}),n.addEventListener("blur",()=>{n.style.outline="",n.style.outlineOffset=""})})}(ae)}()}function re(e){Y(e,(e,t,i)=>{!function(e,t){if(n(s.updateActivityCategoryColor(e,t)),O()){oe(N())}}(e,t),function(e,t){e.style.backgroundColor=t}(i,t)})}function ce(e,t,n){!function(e,{instant:t=!1}={}){if(!e)return;const n=e.parentElement;requestAnimationFrame(()=>requestAnimationFrame(()=>{const s=e.offsetLeft-(n.clientWidth-e.clientWidth)/2,i=n.scrollWidth-n.clientWidth;let a=Math.max(0,Math.min(s,i));s<0&&e.offsetLeft<n.clientWidth/2&&(a=0),n.scrollTo({left:a,behavior:t?"auto":"smooth"})}))}(e.querySelector(t),n)}const le="fitnessRestDays";try{const e=localStorage.getItem(le);if(e&&"string"==typeof e){const t=JSON.parse(e);Array.isArray(t)&&n((e,n)=>{const i={...n().restDays};t.forEach(e=>{i[e]=!0}),e(s.importData({restDays:i}))}),localStorage.removeItem(le)}}catch{}function de(e){return!!t().restDays?.[e]}function ue(e){n((t,n)=>{const i={...n().restDays};i[e]?delete i[e]:i[e]=!0,t(s.importData({restDays:i}))})}function ge(e,n=null){const s=n||t().selectedGroup||"daily",i=e.getFullYear(),a=String(i).slice(-2),o=v[e.getMonth()];switch(s){case"weekly":return{name:String(i),number:`W${x(e)}`,month:""};case"monthly":return{name:o,number:a,month:""};case"yearly":return{name:"",number:a,month:""};default:return{name:b[e.getDay()],number:e.getDate(),month:1===e.getDate()?o:""}}}function ye(e,n=t().selectedGroup||"daily"){const s=new Date(e);switch(n){case"weekly":{const e=(s.getDay()+6)%7;return s.setDate(s.getDate()-e),s.setHours(0,0,0,0),s}case"monthly":return s.setDate(1),s.setHours(0,0,0,0),s;case"yearly":return s.setMonth(0,1),s.setHours(0,0,0,0),s;default:return s.setHours(0,0,0,0),s}}function pe(e,t,n=!1){if(e&&"daily"!==t){if("weekly"===t){const t=n?16:12;return e.style.paddingTop=t+"px",void(e.style.paddingBottom=t+"px")}if("monthly"===t){const t=n?16:12;return e.style.paddingTop=t+"px",void(e.style.paddingBottom=t+"px")}if("yearly"===t){const t=n?"22px":"18px";e.style.paddingTop=t,e.style.paddingBottom=t}}}function me(e){e.ready,e.setDate,e.scrollToSelected,"undefined"!=typeof window&&(window._homeCalendarApi=e)}class he extends HTMLElement{constructor(){super(),this._api=null,this._readyPromise=new Promise(e=>this._resolveReady=e)}static get observedAttributes(){return["selected-key"]}connectedCallback(){if(this._initialised)return;this._initialised=!0;const e=document.createElement("div");e.className="week-calendar",this.appendChild(e);const i=this.getAttribute("state-key")||"currentDate";this._api=function({container:e,stateKey:i="currentDate",onDateChange:a}={}){if(!e)throw new Error("[calendar] mountCalendar: container is required");const o={};let r,c=e.querySelector(".week-days");c||(c=document.createElement("div"),c.className="week-days",e.appendChild(c));const l=new Promise(e=>{r=e});function d(){return new Date(t()[i])}function u(e){n("fitnessSelectedDate"===i?s.setFitnessSelectedDate(g(e)):s.setSelectedDate(g(e))),"function"==typeof a&&a(e)}function v(e){ce(c,".day-item.current-day",{instant:!1})}function b({instant:e=!1}={}){c.querySelector(".day-item.current-day")&&ce(c,".day-item.current-day",{instant:e})}function x(){c.innerHTML="";const n=d(),s="fitnessSelectedDate"===i?"daily":t().selectedGroup||"daily",a=ye(function(){if("fitnessSelectedDate"===i){const e=d();return e&&!isNaN(e)?new Date(e):new Date}return(t().habits||[]).reduce((e,t)=>{let n=null;if(t.createdAt)n=new Date(t.createdAt);else if("string"==typeof t.id&&/^\d{13}/.test(t.id)){const e=parseInt(t.id.slice(0,13),10);if(!Number.isNaN(e)){const t=new Date(e);n=new Date(t.getFullYear(),t.getMonth(),t.getDate())}}return!e||n&&n<e?n:e},null)||new Date}(),s);o[s]=new Date(a);const r=new Date(o[s]),l={daily:"fitnessSelectedDate"===i?270:180,weekly:156,monthly:36,yearly:40}[s]||180;let u=new Date(r);for(let e=0;e<l;e++){const e="fitnessSelectedDate"===i?ge(u,"daily"):ge(u),t=document.createElement("div");t.className="day-item","yearly"===s&&(t.style.paddingTop="16px",t.style.paddingBottom="16px"),t.dataset.date=g(u),t.innerHTML=`<span class="day-name block text-xs">${e.name}</span>\n                      <span class="day-number block text-lg font-semibold">${e.number}</span>\n                      <span class="day-month text-xs mt-0.5 ${e.month?"":"hidden"}">${e.month}</span>`;const a=y(u,new Date,s),o=y(u,n,s);if(o?t.classList.add("current-day"):a&&t.classList.add("today"),pe(t,s,o),"fitnessSelectedDate"!==i){const e="daily"===s&&p(m(u));t.classList.toggle("holiday",e);const n=!!t.querySelector(".holiday-icon");e&&!n?t.insertAdjacentHTML("beforeend",'<span class="material-icons holiday-icon">flight</span>'):!e&&n&&t.querySelector(".holiday-icon").remove()}if("fitnessSelectedDate"===i){const e=de(h(u));t.classList.toggle("rest-day",e);const n=t.querySelector(".rest-icon");e&&!n?t.insertAdjacentHTML("beforeend",'<span class="material-icons rest-icon block mt-0.5 text-lg">bed</span>'):!e&&n&&n.remove()}c.appendChild(t),f(u,s,1)}c.scrollLeft=0;const v=c.querySelector(".day-item");if(v){let t=e.getBoundingClientRect().width;!t&&e.parentElement&&(t=e.parentElement.getBoundingClientRect().width),t||"undefined"==typeof window||(t=window.innerWidth);const n=v.getBoundingClientRect().width;c.style.paddingLeft=`${Math.max(0,t/2-n/2)}px`}}function w(){const e="fitnessSelectedDate"===i?"daily":t().selectedGroup||"daily";c.querySelectorAll(".day-item").forEach(t=>{const n=new Date(t.dataset.date),s=y(n,d(),e),a=y(n,new Date,e);t.classList.toggle("current-day",s),t.classList.toggle("today",a&&!s);const o="fitnessSelectedDate"===i?ge(new Date(t.dataset.date),"daily"):ge(new Date(t.dataset.date)),r=t.querySelector(".day-name"),c=t.querySelector(".day-number"),l=t.querySelector(".day-month");if(r&&(r.textContent=o.name,r.style.display=o.name?"":"none"),c&&(c.textContent=o.number),l&&(l.textContent=o.month,l.style.display=o.month?"":"none"),"daily"===e&&l&&(1===n.getDate()||s||a?(l.textContent=new Date(n).toLocaleString("en-US",{month:"short"}),l.style.display=""):l.style.display="none"),"fitnessSelectedDate"!==i){const s="daily"===e&&p(m(n));t.classList.toggle("holiday",s);const i=!!t.querySelector(".holiday-icon");s&&!i?t.insertAdjacentHTML("beforeend",'<span class="material-icons holiday-icon">flight</span>'):!s&&i&&t.querySelector(".holiday-icon").remove()}if("fitnessSelectedDate"===i){const e=de(h(n));t.classList.toggle("rest-day",e);const s=t.querySelector(".rest-icon");e&&!s?t.insertAdjacentHTML("beforeend",'<span class="material-icons rest-icon block mt-0.5 text-lg">bed</span>'):!e&&s&&s.remove()}if("yearly"===e){const e=s?22:16;t.style.paddingTop=e+"px",t.style.paddingBottom=e+"px"}pe(t,e,s)})}function k(e){const t=e.target.closest(".day-item");t&&(u(new Date(t.dataset.date)),w(),v())}!async function(){x(),w(),await document.fonts.ready,await new Promise(e=>setTimeout(e,50)),r(),b({instant:!0})}(),c.addEventListener("click",k),e.querySelectorAll(".nav-arrow").forEach(e=>{e.addEventListener("click",()=>{let n=d();const s="fitnessSelectedDate"===i?"daily":t().selectedGroup||"daily",a=e.classList.contains("prev-week"),r=e.classList.contains("next-week");if(a||r){const e=a?-1:1;switch(s){case"weekly":n.setDate(n.getDate()+28*e);break;case"monthly":n.setMonth(n.getMonth()+6*e);break;case"yearly":n.setFullYear(n.getFullYear()+5*e);break;default:n.setDate(n.getDate()+7*e)}}else if(e.classList.contains("prev-day")||e.classList.contains("next-day")){const t=e.classList.contains("prev-day")?-1:1;if("fitnessSelectedDate"===i)n.setDate(n.getDate()+t);else switch(s){case"weekly":n.setDate(n.getDate()+7*t);break;case"monthly":n.setMonth(n.getMonth()+t);break;case"yearly":n.setFullYear(n.getFullYear()+t);break;default:n.setDate(n.getDate()+t)}}const l=o[s]?new Date(o[s]):null;l&&n<l&&(n=new Date(l)),u(n),w(),c.querySelector(".day-item.current-day")&&v()})});const S=e.querySelector(".today-btn");S&&S.addEventListener("click",()=>{u(new Date),w(),c.querySelector(".day-item.current-day")&&v()});let D="fitnessSelectedDate"===i?"daily":t().selectedGroup;return document.addEventListener("visibilitychange",()=>{document.hidden||b({instant:!0})}),{ready:l,setDate:function(e){u(e),w(),b({instant:!0})},scrollToSelected:b,destroy:()=>{c.removeEventListener("click",k)},refresh:()=>{if("fitnessSelectedDate"===i)parseFloat(c.style.paddingLeft||"0")||x(),w(),c.querySelector(".day-item.current-day")&&v();else{const e=t().selectedGroup;if(e!==D){const n=(t().habits||[]).reduce((e,t)=>{let n=null;if(t.createdAt)n=new Date(t.createdAt);else if("string"==typeof t.id&&/^\d{13}/.test(t.id)){const e=parseInt(t.id.slice(0,13),10);if(!Number.isNaN(e)){const t=new Date(e);n=new Date(t.getFullYear(),t.getMonth(),t.getDate())}}return!e||n&&n<e?n:e},null)||new Date;o[e]=ye(n,e),x(),D=e}w(),c.querySelector(".day-item.current-day")&&v()}}}}({container:e,stateKey:i,onDateChange:e=>{this.dispatchEvent(new CustomEvent("select",{detail:{date:e},bubbles:!0,composed:!0}))}}),this._api&&this._api.ready?this._api.ready.then(()=>{this._addNavigation(),this._resolveReady(),this._autoScrolled||(requestAnimationFrame(()=>{this._api?.scrollToSelected?.({instant:!1})}),this._autoScrolled=!0)}):(this._addNavigation(),this._resolveReady())}_addNavigation(){if(this.querySelector(".calendar-nav"))return;const e=this.querySelector(".week-days");if(!e)return;const a=document.createElement("div");a.className="calendar-nav flex justify-center items-center gap-4 lg:gap-6",a.innerHTML='\n      <button class="nav-arrow prev-week text-ios-blue p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors spring font-bold lg:p-3 lg:text-lg">‹‹</button>\n      <button class="nav-arrow prev-day text-ios-blue p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors spring font-bold lg:p-3 lg:text-lg">‹</button>\n      <button class="today-btn bg-ios-blue text-white rounded-full font-medium hover:bg-blue-600 transition-colors spring lg:px-6 lg:text-lg">Today</button>\n      <button class="nav-arrow next-day text-ios-blue p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors spring font-bold lg:p-3 lg:text-lg">›</button>\n      <button class="nav-arrow next-week text-ios-blue p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors spring font-bold lg:p-3 lg:text-lg">››</button>\n    ',e.insertAdjacentElement("afterend",a),a.querySelectorAll(".nav-arrow").forEach(e=>{e.addEventListener("click",async()=>{const a=this.getAttribute("state-key")||"currentDate";let o=new Date(t()[a]);const r="fitnessSelectedDate"===a?"daily":t().selectedGroup||"daily",c=e.classList.contains("prev-week"),l=e.classList.contains("next-week");if(c||l){const e=c?-1:1;switch(r){case"weekly":o.setDate(o.getDate()+28*e);break;case"monthly":o.setMonth(o.getMonth()+6*e);break;case"yearly":o.setFullYear(o.getFullYear()+5*e);break;default:o.setDate(o.getDate()+7*e)}}else if(e.classList.contains("prev-day")||e.classList.contains("next-day")){const t=e.classList.contains("prev-day")?-1:1;if("fitnessSelectedDate"===a)o.setDate(o.getDate()+t);else switch(r){case"weekly":o.setDate(o.getDate()+7*t);break;case"monthly":o.setMonth(o.getMonth()+t);break;case"yearly":o.setFullYear(o.getFullYear()+t);break;default:o.setDate(o.getDate()+t)}}const{getLocalMidnightISOString:d}=await i(async()=>{const{getLocalMidnightISOString:e}=await import("./chunk-CM0JCX04.js").then(e=>e.A);return{getLocalMidnightISOString:e}},__vite__mapDeps([0,1,2]));n("fitnessSelectedDate"===a?s.setFitnessSelectedDate(d(o)):s.setSelectedDate(d(o))),this._api?.refresh?.(),requestAnimationFrame(()=>{this._api?.scrollToSelected?.({instant:!1})})})}),a.querySelector(".today-btn")?.addEventListener("click",async()=>{const e=new Date;await this.setDate(e,{smooth:!0})}),this._applyVirtualWindow(),this._setupResizeObserver()}_applyVirtualWindow(){const e=this.querySelector(".week-days");if(!e)return;const n=this.getAttribute("state-key")||"currentDate",s=new Date(t()[n]);if(isNaN(s))return;const i={daily:90,weekly:540,monthly:3650,yearly:36500}["fitnessSelectedDate"===n?"daily":t().selectedGroup||"daily"]||365,a=new Date(s);a.setDate(a.getDate()-i);const o=new Date(s);o.setDate(o.getDate()+i),e.querySelectorAll(".day-item").forEach(e=>{const t=new Date(e.dataset.date),n=t<a||t>o;e.style.display=n?"none":""})}_setupResizeObserver(){this.querySelector(".week-days")&&(this._ro||(this._ro=new ResizeObserver(()=>this._recalcPadding()),this._ro.observe(this)))}_recalcPadding(){const e=this.querySelector(".week-days");if(!e)return;const t=e.querySelector(".day-item");if(!t)return;let n=this.getBoundingClientRect().width;n||"undefined"==typeof window||(n=window.innerWidth);const s=t.getBoundingClientRect().width;e.style.paddingLeft=`${Math.max(0,n/2-s/2)}px`}async setDate(e,{smooth:t=!1}={}){const a=this.getAttribute("state-key")||"currentDate",{getLocalMidnightISOString:o}=await i(async()=>{const{getLocalMidnightISOString:e}=await import("./chunk-CM0JCX04.js").then(e=>e.A);return{getLocalMidnightISOString:e}},__vite__mapDeps([0,1,2]));n("fitnessSelectedDate"===a?s.setFitnessSelectedDate(o(e)):s.setSelectedDate(o(e))),this._api?.refresh?.(),this._applyVirtualWindow(),t&&requestAnimationFrame(()=>{this._api?.scrollToSelected?.({instant:!1})})}refresh(){this._api?.refresh?.(),this._applyVirtualWindow(),this._recalcPadding()}invalidate(){this.refresh()}get ready(){return this._readyPromise}scrollToSelected(e={}){this._api?.scrollToSelected?.(e)}disconnectedCallback(){this._api?.destroy?.()}}customElements.get("hh-calendar")||customElements.define("hh-calendar",he);let fe=null;const ve={ready:null,setDate:null,scrollToSelected:null,destroy:()=>{fe&&(fe.destroy(),fe=null)}};function be(e={}){if(!document.getElementById("fitness-view"))return;const t=document.createElement("hh-calendar");var n;return t.className="week-calendar overflow-x-auto no-scrollbar m-0 p-0",t.id="fitness-calendar",t.setAttribute("state-key","fitnessSelectedDate"),t.style.minHeight="120px",t.style.overflowY="visible",t.style.overflowX="auto",t.style.width="100%",t.addEventListener("select",t=>{"function"==typeof e.onDateChange&&e.onDateChange(t.detail.date)}),fe=n=t,ve.ready=n.ready,ve.setDate=n.setDate,ve.scrollToSelected=n.scrollToSelected,window.fitnessCalendarApi=t,"undefined"!=typeof window&&t.ready?.then?.(()=>t.refresh?.()),t}function xe(){if("undefined"==typeof window)return;const e=document.querySelector("#activities-list");if(!e)return;const t=e.getBoundingClientRect();let n=0;const s=document.querySelector("#fitness-view").closest(".content-area");if(s){const e=window.getComputedStyle(s);n=parseFloat(e.paddingBottom)||0}const i=window.innerHeight-t.top-n;i>0&&(e.style.maxHeight=i+"px",e.style.overflowY="auto")}function we(){const e=document.querySelector("#activities-search-section .activities-search-content");if(!e)return;const t=window.innerHeight-83-40;e.style.maxHeight=`${t}px`}function ke(e,t,n,{onRestore:s=()=>{}}={}){let i=0,a=0,o=0,r=!1,c=0,l=null;function d(e){t.style.transform=`translateX(${e}px)`}t.style.cursor="grab",t.style.touchAction="pan-y",t.addEventListener("pointerdown",function(n){const s=n.touches?n.touches[0]:n;i=s.clientX,a=s.clientY,o=0,r=!1,c=.2*e.offsetWidth,l=void 0!==n.pointerId?n.pointerId:null,void 0!==n.pointerId&&t.setPointerCapture&&t.setPointerCapture(n.pointerId)}),t.addEventListener("pointermove",function(e){if(null!==l&&e.pointerId!==l)return;const n=e.touches?e.touches[0]:e,s=n.clientX-i,u=n.clientY-a;if(!r){if(!(Math.abs(s)>12&&Math.abs(s)>Math.abs(u)))return;r=!0,t.style.transition="none"}o=s,o>0&&(o=0),o<-c&&(o=-c),d(o)}),t.addEventListener("pointerup",function(e){null!==l&&e.pointerId!==l||r&&(r=!1,t.style.transition="transform 0.2s",Math.abs(o)>c/2?d(-c):d(0),void 0!==e.pointerId&&t.releasePointerCapture&&t.releasePointerCapture(e.pointerId),l=null)}),t.addEventListener("touchmove",e=>{r&&e.preventDefault()},{passive:!1}),e.querySelector(".restore-btn")?.addEventListener("click",()=>{s(),d(0)})}function Se(e,t){return e.sets&&e.sets.length>0?function(e,t){const n=e.sets.length,s=Math.ceil(n/2),i=[];for(let o=0;o<s;o++){i.push(o);const e=s+o;e<n&&i.push(e)}const a=i.map(n=>{const s=e.sets[n];let i=`Set ${n+1}: ${s.reps} reps`;if(s.value&&s.unit&&"none"!==s.unit){let e="";e="seconds"===s.unit?"s":"minutes"===s.unit?" Mins":"kg"===s.unit?"kg":s.unit,i+=` × ${s.value}${e}`}else s.value&&(i+=` × ${s.value}`);return`<span class="inline-block text-white text-xs px-2 py-1 rounded-lg mr-1 mb-1 font-medium" style="background-color: ${t.color};">${i}</span>`}).join("");return`<div class="set-pills grid grid-cols-2 gap-1">${a}</div>`}(e,t):function(e,t){let n=[];if(e.duration){const s=e.durationUnit||"minutes";let i="";i="minutes"===s?e.duration>1?"Mins":"Min":"hours"===s?e.duration>1?"Hrs":"Hr":"s",n.push(`<span class="inline-block text-white text-xs px-2 py-1 rounded-lg mr-1 mb-1 font-medium" style="background-color: ${t.color};">${e.duration} ${i}</span>`)}if(e.intensity){const s=e.intensity.charAt(0).toUpperCase()+e.intensity.slice(1);n.push(`<span class="inline-block text-white text-xs px-2 py-1 rounded-lg mr-1 mb-1 font-medium" style="background-color: ${t.color};">${s}</span>`)}return n.join("")}(e,t)}const De={build(t,n,s={}){const i=new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),a=s.getActivity?s.getActivity(t.activityId):null,o=a?.icon||n.icon,r=Se(t,n);return`\n      <div class="swipe-container relative overflow-visible" data-record-id="${t.id}">\n        <button class="restore-btn absolute top-0 right-0 h-full bg-red-600 text-white font-semibold rounded-xl w-1/5 touch-manipulation" aria-label="Delete ${t.activityName} activity">Delete</button>\n        <div class="swipe-slide transition-transform bg-white dark:bg-gray-800 rounded-xl w-full relative z-1 touch-pan-y">\n          <div class="activity-card relative flex items-start px-3 py-2 rounded-xl w-full mb-0" style="border: 3px solid ${n.color}; background-color: ${e(n.color,.05)};">\n            <div class="activity-icon w-9 h-9 flex-shrink-0 rounded-full flex items-center justify-center mr-3 text-xl" style="border: 2px solid ${n.color}; color: ${n.color};" aria-hidden="true">\n              ${o}\n            </div>\n            <div class="activity-content flex-grow text-left">\n              <div class="activity-name font-semibold leading-tight text-gray-900 dark:text-white mb-1">${t.activityName}</div>\n              ${t.notes?`<div class="activity-notes text-xs text-gray-500 dark:text-gray-400 my-1 p-2 bg-gray-100 dark:bg-gray-700 rounded-lg w-fit max-w-full">${t.notes}</div>`:""}\n              ${r}\n            </div>\n            \x3c!-- Time placed absolutely so it doesn't restrict content width --\x3e\n            <div class="activity-meta absolute top-2 right-3 text-xs text-gray-500 dark:text-gray-400" aria-label="Activity recorded at ${i}">${i}</div>\n          </div>\n        </div>\n      </div>\n    `},bindEvents(e,t,n={}){e&&e.querySelectorAll(".swipe-container").forEach(e=>{const s=e.querySelector(".swipe-slide"),i=e.dataset.recordId,a=t.find(e=>e.id===i);if(s&&a){ke(e,s,0,{onRestore:()=>{n.onActivityDelete&&n.onActivityDelete(i)}});const t=s.querySelector(".activity-card");t&&a.activityId&&(t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),n.onActivityClick&&n.onActivityClick(a.activityId,a)}),t.style.cursor="pointer")}})}},Le={build(e,t,n={}){if(0===t.length)return"";if("strength"===e.id){const s=Z(t);return`\n        <div class="category-group mb-4">\n          <div class="category-header flex items-center gap-2 px-4 py-2 rounded-t-xl" style="background:${e.color}20;">\n            <div class="category-title flex items-center gap-2">\n              <span class="text-lg" aria-hidden="true">${e.icon}</span>\n              <span class="font-semibold text-gray-900 dark:text-white">${e.name}</span>\n            </div>\n          </div>\n          ${Object.entries(s).map(([t,s])=>`\n            <div class="muscle-group mb-2">\n              ${F(t)}\n              <div class="category-activities pl-6">\n                ${s.map(t=>De.build(t,e,n)).join("")}\n              </div>\n            </div>\n          `).join("")}\n        </div>\n      `}return`\n        <div class="category-group mb-4" style="overflow: visible;">\n          <div class="category-header flex items-center gap-2 px-4 py-2 rounded-t-xl" style="background:${e.color}20;">\n            <div class="category-title flex items-center gap-2">\n              <span class="text-lg" aria-hidden="true">${e.icon}</span>\n              <span class="font-semibold text-gray-900 dark:text-white">${e.name}</span>\n            </div>\n          </div>\n          <div class="category-activities pl-6" style="overflow: visible;">\n            ${t.map(t=>`<div style="margin-bottom: 0.25rem; overflow: visible;">${De.build(t,e,n)}</div>`).join("")}\n          </div>\n        </div>\n      `},bindEvents(e,t,n={}){e&&De.bindEvents(e,t,n)}};function Ee(e){const n=document.getElementById("activities-list");if(!n)return;const s=t().fitnessSelectedDate||(new Date).toISOString(),i=h(s),a=de(i),o=U(i);if(0===o.length)return void(n.innerHTML=a?'\n        <div class="flex flex-col items-center justify-center py-20 text-center space-y-2">\n          <span class="material-icons text-5xl text-orange-500">bed</span>\n          <h2 class="text-lg font-bold text-gray-900 dark:text-white">Enjoy your rest day</h2>\n        </div>\n      ':'\n        <div class="flex flex-col items-center justify-center py-20 text-center space-y-2">\n          <span class="material-icons text-5xl text-gray-400">fitness_center</span>\n          <h2 class="text-lg font-semibold text-gray-900 dark:text-white">No activities recorded</h2>\n          <p class="text-sm text-gray-600 dark:text-gray-400">Tap "Record Activity" to log your fitness activities for this day.</p>\n        </div>\n      ');const r={};o.forEach(e=>{const t=J(e.categoryId);r[t.id]||(r[t.id]={category:t,records:[]}),r[t.id].records.push(e)});let c="";Object.values(r).forEach(({category:t,records:s})=>{0!==s.length&&(c+=Le.build(t,s,{onActivityClick:e||n._onActivityClick,onActivityDelete:t=>{X(t,i),Ee(e||n._onActivityClick)},getActivity:Q}))}),n.innerHTML=c,Le.bindEvents(n,o,{onActivityClick:e||n._onActivityClick,onActivityDelete:t=>{X(t,i),Ee(e||n._onActivityClick)},getActivity:Q}),xe()}const Ae={update(){const e=document.getElementById("start-timer-btn");if(!e)return;_().isRunning?(e.classList.remove("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"),e.classList.add("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300")):(e.classList.remove("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300"),e.classList.add("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"))}},_e={_sessionLapTimes:[],clearLaps(){this._sessionLapTimes=[]},recordLap(){const e=_();if(!e.isRunning&&0===e.elapsedSeconds)return;const t=e.elapsedSeconds,n=t-this._sessionLapTimes.reduce((e,t)=>e+t.duration,0),s={number:this._sessionLapTimes.length+1,duration:n,totalTime:t,timestamp:(new Date).toISOString()};this._sessionLapTimes.push(s),this.render()},deleteLap(e){e<0||e>=this._sessionLapTimes.length||(this._sessionLapTimes.splice(e,1),this._sessionLapTimes.forEach((e,t)=>{e.number=t+1}),this.render())},getCurrentLapTime(){const e=_(),t=this._sessionLapTimes.reduce((e,t)=>e+t.duration,0);return e.elapsedSeconds-t},getTotalSessionTime:()=>_().elapsedSeconds,render(){const e=document.getElementById("lap-times-container"),t=document.getElementById("lap-times-list"),n=document.getElementById("total-session-time");if(!e||!t)return;if(n){const e=this.getTotalSessionTime();n.textContent=w(e)}if(0===this._sessionLapTimes.length)return void e.classList.add("hidden");e.classList.remove("hidden"),t.innerHTML="";const s=this._sessionLapTimes.length,i=Math.ceil(s/2),a=[];for(let r=0;r<i;r++){a.push(r);const e=i+r;e<s&&a.push(e)}const o=document.createElement("div");o.className="lap-times-grid grid grid-cols-2 gap-2",a.forEach(e=>{const t=this._sessionLapTimes[e],n=document.createElement("div");n.className="flex justify-between items-center py-2 px-3 bg-white dark:bg-gray-600 rounded-lg border border-gray-200 dark:border-gray-500",n.innerHTML=`\n        <span class="text-sm font-medium text-gray-700 dark:text-gray-200">Lap ${t.number}</span>\n        <div class="flex items-center gap-2">\n          <span class="text-sm font-mono text-gray-900 dark:text-white">${w(t.duration)}</span>\n          <button class="delete-lap-btn text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 p-1 rounded transition-colors" data-lap-index="${e}">\n            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n              <path d="M6 18L18 6M6 6l12 12" stroke-width="2" stroke-linecap="round"/>\n            </svg>\n          </button>\n        </div>\n      `,o.appendChild(n)}),t.appendChild(o),setTimeout(()=>{if(t.scrollHeight>t.clientHeight){if(!t.querySelector(".scroll-fade")){const e=document.createElement("div");e.className="scroll-fade absolute bottom-0 left-0 right-0 h-6 bg-gradient-to-t from-gray-50 dark:from-gray-700 to-transparent pointer-events-none",t.appendChild(e)}}else{const e=t.querySelector(".scroll-fade");e&&e.remove()}},0)},bindEvents(){const e=document.getElementById("record-lap-btn");e&&e.addEventListener("click",()=>this.recordLap());const t=document.getElementById("lap-times-list");t&&t.addEventListener("click",e=>{if(e.target.closest(".delete-lap-btn")){e.stopPropagation();const t=e.target.closest(".delete-lap-btn"),n=parseInt(t.dataset.lapIndex);this.deleteLap(n)}})}},Ie={update(){const e=_(),t=document.getElementById("timer-start-stop-btn"),n=document.getElementById("record-lap-btn");if(t){const n=t.querySelector(".material-icons");e.isRunning?(n.textContent="pause",t.classList.remove("bg-ios-blue"),t.classList.add("bg-red-500")):(n.textContent="play_arrow",t.classList.remove("bg-red-500"),t.classList.add("bg-ios-blue"))}n&&(n.disabled=0===e.elapsedSeconds)},bindEvents(e){const t=document.getElementById("timer-start-stop-btn");t&&t.addEventListener("click",()=>{var t;_().isRunning?I(()=>{e&&e(),Ce()}):(t=()=>{e&&e(),Ce()},L.isRunning||(L.isRunning=!0,L.startTime=Date.now()-1e3*L.elapsedSeconds,E=setInterval(()=>{const e=Date.now();L.elapsedSeconds=Math.floor((e-L.startTime)/1e3),A&&A()},1e3),t&&t()))});const n=document.getElementById("timer-reset-btn");n&&n.addEventListener("click",()=>{var t;t=()=>{_e.clearLaps(),e&&e(),Ce()},L.isRunning&&I(),L.elapsedSeconds=0,L.startTime=null,L.pausedTime=0,t&&t()})}};function Ce(){const e=document.getElementById("start-timer-btn");if(!e)return;_().isRunning?(e.classList.remove("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"),e.classList.add("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300")):(e.classList.remove("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300"),e.classList.add("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"))}const Te={_updateInterval:null,open(){0===_().elapsedSeconds&&_e.clearLaps(),this.updateDisplay(),r("timer-modal"),this._startUpdateInterval()},close(){this._stopUpdateInterval();const e=document.getElementById("timer-modal");e&&e._escapeHandler&&(document.removeEventListener("keydown",e._escapeHandler),e._escapeHandler=null),this._updateTimerButton(),o("timer-modal")},_startUpdateInterval(){this._stopUpdateInterval(),this.updateDisplay(),this._updateInterval=setInterval(()=>{this.updateDisplay()},1e3)},_stopUpdateInterval(){this._updateInterval&&(clearInterval(this._updateInterval),this._updateInterval=null)},updateDisplay(){const e=_(),t=document.getElementById("timer-time-display"),n=document.getElementById("timer-status");if(t){const e=_e.getCurrentLapTime();t.textContent=w(e)}n&&(e.isRunning?n.textContent="Running...":e.elapsedSeconds>0?n.textContent="Paused":n.textContent="Ready to start"),Ie.update(),_e.render(),this._updateTimerButton()},_updateTimerButton(){const e=document.getElementById("start-timer-btn");if(!e)return;_().isRunning?(e.classList.remove("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"),e.classList.add("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300")):(e.classList.remove("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300"),e.classList.add("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"))},bindEvents(){const e=document.getElementById("close-timer-modal");e&&e.addEventListener("click",()=>this.close()),Ie.bindEvents(()=>{this.updateDisplay()}),_e.bindEvents();const t=document.getElementById("timer-modal");t&&t.addEventListener("click",e=>{e.target===t&&this.close()});const n=e=>{if("Escape"===e.key){const e=document.getElementById("timer-modal");e&&!e.classList.contains("hidden")&&this.close()}};document.addEventListener("keydown",n),t&&(t._escapeHandler=n)}},$e={updateButton(){Ae.update()},openModal(){Te.open()},closeModal(){Te.close()},bindEvents(){Te.bindEvents()}},Me={async mount(e,t={}){if(!e)return null;e.innerHTML="";const n=c({});e.appendChild(n);const s=l({type:"fitness",callbacks:{onNewActivity:t.onNewActivity,onTimer:()=>$e.openModal()}});e.appendChild(s);const a=ne({onActivityClick:t.onSearchActivityClick,onStatsClick:t.onStatsClick,onEditClick:t.onEditClick});e.appendChild(a);const o=this._buildCalendarWrapper(t.onDateChange);e.appendChild(o);const r=await i(()=>import("./RestToggle-B5rqNNKe.js"),__vite__mapDeps([3,1,2,0,4])).then(e=>e.mountRestToggle(t.onRestToggle));e.appendChild(r);const d=function(e){const t=document.createElement("div");return t.className="activities-container flex-grow overflow-y-auto px-4 pb-8",t.style.overflowX="visible",t.id="activities-list",t._onActivityClick=e,t}(t.onActivityClick);return e.appendChild(d),e},renderActivities(e){Ee(e)},updateTimerButton(){$e.updateButton()},updateRestToggle(){i(async()=>{const{updateRestToggle:e}=await import("./RestToggle-B5rqNNKe.js");return{updateRestToggle:e}},__vite__mapDeps([3,1,2,0,4])).then(({updateRestToggle:e})=>{e()})},_buildCalendarWrapper(e){const t=document.createElement("div");t.className="calendar-wrapper mb-2";const n=be(e);return t.appendChild(n),t},setupResponsiveBehavior(){"undefined"!=typeof window&&(window.addEventListener("resize",()=>{xe(),we(),setTimeout(()=>{const e=document.querySelector("#activities-search-section .activities-search-content");if(e){const t=function(){const e=document.querySelector("#fitness-view .search-container");if(!e)return 500;const t=e.getBoundingClientRect(),n=window.innerHeight,s=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--tab-bar-height").replace("px",""))||83,i=parseInt(getComputedStyle(document.documentElement).getPropertyValue("padding-bottom").replace("px",""))||0,a=n-t.bottom-s-i-20;return Math.max(300,Math.min(a,700))}();e.style.maxHeight=`${t}px`}},100)}),window.addEventListener("orientationchange",()=>{setTimeout(()=>{we()},500)}))}},qe={openAddActivity(){D.openAddMode()},openEditActivity(e){D.openEditMode(e)},openActivityDetails(e){S.open(e)},openActivityDetailsWithRecord(e,t){S.openWithRecord(e,t)},openStats(e){k.open(e)}};let Be=!1;async function Re(){if(Be)return;Be=!0,function(){if("true"===localStorage.getItem("habitsAppFitnessMigrationV1"))return;n((e,t)=>{const n=t().categories.filter(e=>!e.id.startsWith("fitness-")),i=[{id:"cardio",name:"Cardio",icon:"❤️",color:"#ef4444"},{id:"strength",name:"Strength",icon:"💪",color:"#3b82f6"},{id:"stretching",name:"Stretching",icon:"🧘‍♀️",color:"#10b981"},{id:"sports",name:"Sports",icon:"⚽",color:"#f59e0b"},{id:"other",name:"Other",icon:"🎯",color:"#eab308"}];e(s.importData({categories:n,activityCategories:i}))}),localStorage.setItem("habitsAppFitnessMigrationV1","true")}(),function(){if("true"===localStorage.getItem("habitsAppFitnessMigrationV1"))return;const e=["Running","Push-ups","Squats","Yoga","Basketball","Swimming"];n((t,n)=>{const i=n().activities.filter(t=>!e.includes(t.name));t(s.importData({activities:i}))}),localStorage.setItem("habitsAppFitnessMigrationV1","true")}();const e=new Date;e.setHours(0,0,0,0);const i=g(e);n(s.setFitnessSelectedDate(i));const o=document.getElementById("fitness-view");if(!o)return;await Me.mount(o,{onNewActivity:()=>qe.openAddActivity(),onSearchActivityClick:e=>qe.openActivityDetails(e),onStatsClick:e=>qe.openStats(e),onEditClick:e=>qe.openEditActivity(e),onActivityClick:e=>qe.openActivityDetails(e),onDateChange:e=>{n(s.setFitnessSelectedDate(g(e))),ve.ready&&ve.scrollToSelected&&ve.ready.then(()=>{ve.scrollToSelected({instant:!0})}),Me.updateRestToggle()},onRestToggle:()=>{ve.ready&&ve.scrollToSelected&&ve.ready.then(()=>{ve.scrollToSelected({instant:!0})}),Me.renderActivities((e,t)=>{t?qe.openActivityDetailsWithRecord(e,t):qe.openActivityDetails(e)})}}),ve.ready&&ve.scrollToSelected&&(await ve.ready,ve.scrollToSelected({instant:!0}));let r=t().fitnessSelectedDate;a(()=>{Me.renderActivities((e,t)=>{t?qe.openActivityDetailsWithRecord(e,t):qe.openActivityDetails(e)}),Me.updateTimerButton(),t().fitnessSelectedDate!==r&&(r=t().fitnessSelectedDate,Me.updateRestToggle())}),Me.renderActivities((e,t)=>{t?qe.openActivityDetailsWithRecord(e,t):qe.openActivityDetails(e)}),Me.setupResponsiveBehavior(),$e.bindEvents(),document.addEventListener("ActivityRecorded",()=>{Me.renderActivities((e,t)=>{t?qe.openActivityDetailsWithRecord(e,t):qe.openActivityDetails(e)})})}async function He(){await Re()}const je={init:He},Ne=Object.freeze(Object.defineProperty({__proto__:null,FitnessModule:je,init:He,initializeFitness:Re},Symbol.toStringTag,{value:"Module"}));export{Ne as F,z as a,K as b,J as c,ee as d,_ as e,Re as f,Q as g,de as h,T as i,me as j,U as k,Ee as l,ke as m,G as r,C as s,ue as t,te as u};
