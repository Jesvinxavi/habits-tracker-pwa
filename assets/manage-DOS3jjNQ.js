import{z as h,B as n,E as g,J as E,g as v,K as f,L as I,M as k,N as L}from"./index-CWk_d2Bu.js";import"./vendor-DbHZnqlu.js";let x=!1,b=!1,c=null;function M(){x||w(),s(),h("holiday-modal")}function w(){var e,a,d,l;const t=document.getElementById("holiday-modal");t&&((e=t.querySelector("#cancel-holiday"))==null||e.addEventListener("click",()=>n("holiday-modal")),(a=t.querySelector("#done-holiday"))==null||a.addEventListener("click",()=>n("holiday-modal")),P(),(d=t.querySelector("#add-period-btn"))==null||d.addEventListener("click",()=>{u({mode:"add"})}),(l=t.querySelector("#delete-all-periods"))==null||l.addEventListener("click",()=>{g({title:"Delete All Holiday Periods",message:"This will remove every holiday period you have added. Continue?",okText:"Delete All",cancelText:"Cancel",onOK:()=>{E(),s()}})}),x=!0)}function P(){if(b)return;b=!0;const t="holiday-period-modal",e=document.getElementById(t);if(!e)return;const a=e.querySelector("#period-label-input"),d=e.querySelector("#period-start-input"),l=e.querySelector("#period-end-input"),i=e.querySelector("#save-period"),S=e.querySelector("#cancel-period"),p=e.querySelector("#period-form-title");function y(){const o=a.value.trim()!==""&&d.value&&l.value&&l.value>=d.value;i.disabled=!o,i.classList.toggle("opacity-50",!o)}[a,d,l].forEach(o=>o.addEventListener("input",y)),S.addEventListener("click",()=>n(t)),i.addEventListener("click",()=>{i.disabled||(c?L({id:c,label:a.value.trim(),startISO:d.value,endISO:l.value}):k({label:a.value.trim(),startISO:d.value,endISO:l.value}),n(t),s())}),u=function({mode:o,period:r}){c=o==="edit"?r.id:null,p.textContent=o==="edit"?"Edit Holiday Period":"New Holiday Period",a.value=(r==null?void 0:r.label)||"";const m=new Date().toISOString().slice(0,10);d.value=(r==null?void 0:r.startISO)||m,l.value=(r==null?void 0:r.endISO)||m,y(),h(t)}}let u=()=>{};function s(){const t=document.getElementById("period-list");if(t){if(t.innerHTML="",v().holidayPeriods.length===0){t.insertAdjacentHTML("beforeend",'<p class="text-center text-gray-500 dark:text-gray-400 text-sm">No holiday periods yet.</p>');return}v().holidayPeriods.forEach(e=>{const a=document.createElement("div");a.className="flex justify-between items-center p-3 bg-white/80 dark:bg-gray-700/80 border border-gray-200 dark:border-gray-600 rounded-lg";const d=Math.round((new Date(e.endISO)-new Date(e.startISO))/864e5)+1,l=f(e.startISO),i=f(e.endISO);a.innerHTML=`
      <div>
        <div class="font-semibold text-gray-900 dark:text-white">${e.label}</div>
        <div class="text-gray-500 dark:text-gray-400 text-sm">${l} &rarr; ${i}</div>
        <div class="text-gray-400 dark:text-gray-500 text-xs">${d} ${d===1?"day":"days"}</div>
      </div>
      <div class="flex items-center gap-2">
        <button class="edit-period w-8 h-8 flex items-center justify-center rounded-full border border-ios-blue text-ios-blue hover:bg-ios-blue/10" aria-label="Edit"><span class="material-icons text-ios-blue">edit</span></button>
        <button class="delete-period w-8 h-8 flex items-center justify-center rounded-full border border-red-500 text-red-600 hover:bg-red-600/10" aria-label="Delete"><span class="material-icons text-red-600">delete</span></button>
      </div>`,a.querySelector(".edit-period").addEventListener("click",()=>{u({mode:"edit",period:e})}),a.querySelector(".delete-period").addEventListener("click",()=>{g({title:"Delete Holiday Period",message:"Are you sure you want to delete this period? This cannot be undone.",okText:"Delete",cancelText:"Cancel",onOK:()=>{I(e.id),s()}})}),t.appendChild(a)})}}export{M as openHolidayModal};
