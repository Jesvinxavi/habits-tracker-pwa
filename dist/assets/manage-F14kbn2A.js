import{o as h,c as s,s as g,d as I,a as v,b as E,e as k,m as w,r as L}from"./index-DJCdj0tE.js";let x=!1,f=!1,u=null;function q(){x||P(),c(),h("holiday-modal")}function P(){var e,d,l,r;const t=document.getElementById("holiday-modal");t&&((e=t.querySelector("#cancel-holiday"))==null||e.addEventListener("click",()=>s("holiday-modal")),(d=t.querySelector("#done-holiday"))==null||d.addEventListener("click",()=>s("holiday-modal")),D(),(l=t.querySelector("#add-period-btn"))==null||l.addEventListener("click",()=>{y({mode:"add"})}),(r=t.querySelector("#delete-all-periods"))==null||r.addEventListener("click",()=>{g({title:"Delete All Holiday Periods",message:"This will remove every holiday period you have added. Continue?",okText:"Delete All",cancelText:"Cancel",onOK:()=>{I(),c()}})}),x=!0)}function D(){if(f)return;f=!0;const t="holiday-period-modal",e=document.getElementById(t);if(!e)return;const d=e.querySelector("#period-label-input"),l=e.querySelector("#period-start-input"),r=e.querySelector("#period-end-input"),i=e.querySelector("#save-period"),S=e.querySelector("#cancel-period"),p=e.querySelector("#period-form-title");function m(){const o=d.value.trim()!==""&&l.value&&r.value&&r.value>=l.value;i.disabled=!o,i.classList.toggle("opacity-50",!o)}[d,l,r].forEach(o=>o.addEventListener("input",m)),S.addEventListener("click",()=>s(t)),i.addEventListener("click",()=>{i.disabled||(u?(w(o=>{const a=o.holidayPeriods.find(n=>n.id===u);a&&(a.label=d.value.trim(),a.startISO=l.value,a.endISO=r.value)}),L()):k({label:d.value.trim(),startISO:l.value,endISO:r.value}),s(t),c())}),y=function({mode:o,period:a}){u=o==="edit"?a.id:null,p.textContent=o==="edit"?"Edit Holiday Period":"New Holiday Period",d.value=(a==null?void 0:a.label)||"";const n=new Date().toISOString().slice(0,10);l.value=(a==null?void 0:a.startISO)||n,r.value=(a==null?void 0:a.endISO)||n,m(),h(t)}}let y=()=>{};function b(t){return new Date(t).toLocaleDateString(void 0,{day:"2-digit",month:"short",year:"numeric"})}function c(){const t=document.getElementById("period-list");if(t){if(t.innerHTML="",v.holidayPeriods.length===0){t.insertAdjacentHTML("beforeend",'<p class="text-center text-gray-500 dark:text-gray-400 text-sm">No holiday periods yet.</p>');return}v.holidayPeriods.forEach(e=>{const d=document.createElement("div");d.className="flex justify-between items-center p-3 bg-white/80 dark:bg-gray-700/80 border border-gray-200 dark:border-gray-600 rounded-lg";const l=Math.round((new Date(e.endISO)-new Date(e.startISO))/864e5)+1,r=b(e.startISO),i=b(e.endISO);d.innerHTML=`
      <div>
        <div class="font-semibold text-gray-900 dark:text-white">${e.label}</div>
        <div class="text-gray-500 dark:text-gray-400 text-sm">${r} &rarr; ${i}</div>
        <div class="text-gray-400 dark:text-gray-500 text-xs">${l} ${l===1?"day":"days"}</div>
      </div>
      <div class="flex items-center gap-2">
        <button class="edit-period w-8 h-8 flex items-center justify-center rounded-full border border-ios-blue text-ios-blue hover:bg-ios-blue/10" aria-label="Edit"><span class="material-icons text-ios-blue">edit</span></button>
        <button class="delete-period w-8 h-8 flex items-center justify-center rounded-full border border-red-500 text-red-600 hover:bg-red-600/10" aria-label="Delete"><span class="material-icons text-red-600">delete</span></button>
      </div>`,d.querySelector(".edit-period").addEventListener("click",()=>{y({mode:"edit",period:e})}),d.querySelector(".delete-period").addEventListener("click",()=>{g({title:"Delete Holiday Period",message:"Are you sure you want to delete this period? This cannot be undone.",okText:"Delete",cancelText:"Cancel",onOK:()=>{E(e.id),c()}})}),t.appendChild(d)})}}export{q as openHolidayModal};
