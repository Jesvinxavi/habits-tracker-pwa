const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HabitsModule-C12ATHgi.js","assets/vendor-DbHZnqlu.js","assets/HomeModule-CJtdgle-.js","assets/stats-B_Yw9SmN.js","assets/categories-DPpWsi8d.js","assets/RestToggle-CtrWkNZJ.js"])))=>i.map(i=>d[i]);
import{_ as A}from"./vendor-DbHZnqlu.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();document.documentElement.classList.add("js-loading");function An(){document.documentElement.classList.remove("js-loading")}const Cn=Object.freeze(Object.defineProperty({__proto__:null,removeLoadingState:An},Symbol.toStringTag,{value:"Module"}));function Bn(e,t=300){let n;return(...a)=>{clearTimeout(n),n=setTimeout(()=>e(...a),t)}}function Te(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function j(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Xe(e){return structuredClone(e)}function Mn(e,t=null){try{return JSON.parse(e)}catch{return t}}function $n(e,t="{}"){try{return JSON.stringify(e)}catch{return t}}function pe(e){const t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7));const n=new Date(t.getFullYear(),0,1);return Math.ceil(((t-n)/864e5+1)/7)}function ye(e,t,n="daily"){switch(n){case"weekly":return e.getFullYear()===t.getFullYear()&&pe(e)===pe(t);case"monthly":return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth();case"yearly":return e.getFullYear()===t.getFullYear();case"daily":default:return e.toDateString()===t.toDateString()}}function Hn(e,t){return e.toDateString()===t.toDateString()}function Ne(e){const t=new Date(e),n=t.getDay(),a=n===0?-6:1-n;return t.setDate(t.getDate()+a),t.setHours(0,0,0,0),t}function Ge(e,t){return Math.floor((Ne(t)-Ne(e))/6048e5)}function en(e,t="daily",n=1){switch(t){case"weekly":e.setDate(e.getDate()+n*7);break;case"monthly":e.setMonth(e.getMonth()+n);break;case"yearly":e.setFullYear(e.getFullYear()+n);break;case"daily":default:e.setDate(e.getDate()+n)}return e}function tn(e,t=new Date){const n=new Date(t);switch(n.setHours(0,0,0,0),e){case"day":return{start:new Date(n),end:new Date(n)};case"week":const a=Ne(n),s=new Date(a);return s.setDate(a.getDate()+6),{start:a,end:s};case"month":const i=new Date(n.getFullYear(),n.getMonth(),1),o=new Date(n.getFullYear(),n.getMonth()+1,0);return{start:i,end:o};case"year":const r=new Date(n.getFullYear(),0,1),l=new Date(n.getFullYear(),11,31);return{start:r,end:l};default:throw new Error(`Unknown period: ${e}`)}}function*ut(e,t){const n=new Date(e);n.setHours(0,0,0,0);const a=new Date(t);for(a.setHours(0,0,0,0);n<=a;)yield Y(n),n.setDate(n.getDate()+1)}function Se(e){let t;if(typeof e=="string")e.includes("T")?t=e.slice(0,10):t=e;else{const n=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");t=`${n}-${a}-${s}`}return t}function Y(e){e instanceof Date||(e=new Date(e));const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${a}`}function gt(e){if(e<60)return`${Math.round(e)}m`;if(e<1440){const t=Math.floor(e/60),n=Math.round(e%60);return n>0?`${t}h ${n}m`:`${t}h`}else{const t=Math.floor(e/1440),n=Math.floor(e%1440/60);return n>0?`${t}d ${n}h`:`${t}d`}}function je(e){const t=Math.floor(e/60),n=e%60;return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function vt(e){if(!e)return"Never";const t=new Date(e),a=Math.floor((new Date-t)/(1e3*60*60*24));return a===0?"Today":a===1?"Yesterday":a<7?`${a} days ago`:a<30?`${Math.floor(a/7)} weeks ago`:t.toLocaleDateString()}function On(e){return new Date(e).toLocaleDateString(void 0,{day:"2-digit",month:"short",year:"numeric"})}function Q(e){return`${Se(e)}T00:00:00.000Z`}function nn(e,t){const n=new Date(e);return n.setHours(0,0,0,0),t==="daily"?n.setDate(n.getDate()+1):t==="weekly"?n.setDate(n.getDate()-n.getDay()+8):t==="monthly"?n.setMonth(n.getMonth()+1,1):t==="yearly"&&n.setFullYear(n.getFullYear()+1,0,1),n}const ie=Object.freeze(Object.defineProperty({__proto__:null,advanceDate:en,dateToKey:Y,eachDayInRange:ut,formatDate:On,formatDuration:gt,formatElapsedTime:je,formatLastPerformed:vt,getISOWeekNumber:pe,getLocalISODate:Se,getLocalMidnightISOString:Q,getNextPeriodStart:nn,getPeriodBounds:tn,isSameDay:Hn,isSamePeriod:ye,mondayStart:Ne,weeksBetween:Ge},Symbol.toStringTag,{value:"Module"}));function it(){return Q(new Date)}const bt={categories:[],habits:[],currentDate:it(),selectedDate:it(),fitnessSelectedDate:it(),selectedGroup:"daily",holidayDates:[],holidayPeriods:[],settings:{darkMode:!1,hideCompleted:!1,hideSkipped:!1,holidayMode:!1},foodLog:[],stats:{},activities:[],activityCategories:[{id:"cardio",name:"Cardio",color:"#EF4444",icon:"🏃‍♂️"},{id:"strength",name:"Strength Training",color:"#2563EB",icon:"💪"},{id:"stretching",name:"Stretching",color:"#22C55E",icon:"🧘‍♀️"},{id:"sports",name:"Sports",color:"#F97316",icon:"⚽"},{id:"other",name:"Other",color:"#EAB308",icon:"🎯"}],recordedActivities:{},restDays:{}},H=Xe(bt);typeof window<"u"&&(window.appData=H);function v(){return Xe(H)}const Ye=new Set;function _e(e){return Ye.add(e),()=>Ye.delete(e)}function an(){Ye.forEach(e=>e(H))}const x={ADD_HABIT:"ADD_HABIT",UPDATE_HABIT:"UPDATE_HABIT",DELETE_HABIT:"DELETE_HABIT",TOGGLE_HABIT_COMPLETED:"TOGGLE_HABIT_COMPLETED",SET_HABIT_PROGRESS:"SET_HABIT_PROGRESS",SKIP_HABIT:"SKIP_HABIT",REORDER_HABITS:"REORDER_HABITS",REORDER_CATEGORIES:"REORDER_CATEGORIES",ADD_CATEGORY:"ADD_CATEGORY",UPDATE_CATEGORY:"UPDATE_CATEGORY",DELETE_CATEGORY:"DELETE_CATEGORY",SET_SELECTED_DATE:"SET_SELECTED_DATE",SET_SELECTED_GROUP:"SET_SELECTED_GROUP",SET_FITNESS_SELECTED_DATE:"SET_FITNESS_SELECTED_DATE",ADD_HOLIDAY_PERIOD:"ADD_HOLIDAY_PERIOD",DELETE_HOLIDAY_PERIOD:"DELETE_HOLIDAY_PERIOD",DELETE_ALL_HOLIDAY_PERIODS:"DELETE_ALL_HOLIDAY_PERIODS",TOGGLE_SINGLE_HOLIDAY:"TOGGLE_SINGLE_HOLIDAY",SET_HOLIDAY_DATES:"SET_HOLIDAY_DATES",UPDATE_HOLIDAY_PERIOD:"UPDATE_HOLIDAY_PERIOD",ADD_ACTIVITY:"ADD_ACTIVITY",UPDATE_ACTIVITY:"UPDATE_ACTIVITY",DELETE_ACTIVITY:"DELETE_ACTIVITY",RECORD_ACTIVITY:"RECORD_ACTIVITY",UPDATE_ACTIVITY_CATEGORY_COLOR:"UPDATE_ACTIVITY_CATEGORY_COLOR",UPDATE_SETTINGS:"UPDATE_SETTINGS",SET_DARK_MODE:"SET_DARK_MODE",TOGGLE_DARK_MODE:"TOGGLE_DARK_MODE",TOGGLE_COMPLETED:"TOGGLE_COMPLETED",TOGGLE_SKIPPED:"TOGGLE_SKIPPED",RESET_STATE:"RESET_STATE",IMPORT_DATA:"IMPORT_DATA"},L={addHabit:e=>({type:x.ADD_HABIT,payload:e}),updateHabit:(e,t)=>({type:x.UPDATE_HABIT,payload:{habitId:e,updates:t}}),deleteHabit:e=>({type:x.DELETE_HABIT,payload:e}),toggleHabitCompleted:(e,t)=>({type:x.TOGGLE_HABIT_COMPLETED,payload:{habitId:e,date:t}}),setHabitProgress:(e,t,n)=>({type:x.SET_HABIT_PROGRESS,payload:{habitId:e,date:t,progress:n}}),skipHabit:(e,t)=>({type:x.SKIP_HABIT,payload:{habitId:e,date:t}}),reorderHabits:e=>({type:x.REORDER_HABITS,payload:e}),reorderCategories:e=>({type:x.REORDER_CATEGORIES,payload:e}),addCategory:e=>({type:x.ADD_CATEGORY,payload:e}),updateCategory:(e,t)=>({type:x.UPDATE_CATEGORY,payload:{categoryId:e,updates:t}}),deleteCategory:e=>({type:x.DELETE_CATEGORY,payload:e}),setSelectedDate:e=>({type:x.SET_SELECTED_DATE,payload:e}),setSelectedGroup:e=>({type:x.SET_SELECTED_GROUP,payload:e}),setFitnessSelectedDate:e=>({type:x.SET_FITNESS_SELECTED_DATE,payload:e}),addHolidayPeriod:e=>({type:x.ADD_HOLIDAY_PERIOD,payload:e}),deleteHolidayPeriod:e=>({type:x.DELETE_HOLIDAY_PERIOD,payload:e}),deleteAllHolidayPeriods:()=>({type:x.DELETE_ALL_HOLIDAY_PERIODS}),updateHolidayPeriod:e=>({type:x.UPDATE_HOLIDAY_PERIOD,payload:e}),toggleSingleHoliday:e=>({type:x.TOGGLE_SINGLE_HOLIDAY,payload:e}),setHolidayDates:e=>({type:x.SET_HOLIDAY_DATES,payload:e}),addActivity:e=>({type:x.ADD_ACTIVITY,payload:e}),updateActivity:(e,t)=>({type:x.UPDATE_ACTIVITY,payload:{activityId:e,updates:t}}),deleteActivity:e=>({type:x.DELETE_ACTIVITY,payload:e}),recordActivity:(e,t,n)=>({type:x.RECORD_ACTIVITY,payload:{activityId:e,date:t,data:n}}),updateActivityCategoryColor:(e,t)=>({type:x.UPDATE_ACTIVITY_CATEGORY_COLOR,payload:{categoryId:e,newColor:t}}),updateSettings:e=>({type:x.UPDATE_SETTINGS,payload:e}),setDarkMode:e=>({type:x.SET_DARK_MODE,payload:e}),toggleDarkMode:()=>({type:x.TOGGLE_DARK_MODE}),toggleCompleted:()=>({type:x.TOGGLE_COMPLETED}),toggleSkipped:()=>({type:x.TOGGLE_SKIPPED}),resetState:()=>({type:x.RESET_STATE}),importData:e=>({type:x.IMPORT_DATA,payload:e})};function D(e){if(typeof e=="function")return e(D,()=>H);const t=Xe(H);try{const n=sn(t,e);Object.assign(H,n),an()}catch(n){console.error("Error dispatching action:",e,n),Object.assign(H,t)}}function sn(e,t){switch(t.type){case x.ADD_HABIT:const n=t.payload;return xt(n),{...e,habits:[...e.habits,n]};case x.UPDATE_HABIT:return{...e,habits:e.habits.map(g=>g.id===t.payload.habitId?{...g,...t.payload.updates}:g)};case x.DELETE_HABIT:return{...e,habits:e.habits.filter(g=>g.id!==t.payload)};case x.SET_HABIT_PROGRESS:return{...e,habits:e.habits.map(g=>g.id===t.payload.habitId?{...g,progress:{...g.progress,[t.payload.date]:t.payload.progress}}:g)};case x.TOGGLE_HABIT_COMPLETED:return{...e,habits:e.habits.map(g=>{if(g.id!==t.payload.habitId)return g;const S=t.payload.date,w=typeof g.completed=="object"&&g.completed!==null?{...g.completed}:{},I=w[S]===!0;return w[S]=!I,{...g,completed:w}})};case x.SKIP_HABIT:return{...e,habits:e.habits.map(g=>{if(g.id!==t.payload.habitId)return g;const S=t.payload.date,w=g.skippedDates||[],I=w.includes(S);return{...g,skippedDates:I?w.filter(_=>_!==S):[...w,S]}})};case x.REORDER_HABITS:return{...e,habits:t.payload.map(g=>e.habits.find(S=>S.id===g)).filter(Boolean)};case x.REORDER_CATEGORIES:return{...e,categories:t.payload.map(g=>e.categories.find(S=>S.id===g)).filter(Boolean)};case x.ADD_CATEGORY:return{...e,categories:[...e.categories,t.payload]};case x.UPDATE_CATEGORY:return{...e,categories:e.categories.map(g=>g.id===t.payload.categoryId?{...g,...t.payload.updates}:g)};case x.DELETE_CATEGORY:return{...e,categories:e.categories.filter(g=>g.id!==t.payload),habits:e.habits.filter(g=>g.categoryId!==t.payload)};case x.SET_SELECTED_DATE:return{...e,selectedDate:t.payload};case x.SET_SELECTED_GROUP:return{...e,selectedGroup:t.payload};case x.SET_FITNESS_SELECTED_DATE:return{...e,fitnessSelectedDate:t.payload};case x.SET_HOLIDAY_DATES:return{...e,holidayDates:[...t.payload]};case x.ADD_HOLIDAY_PERIOD:return{...e,holidayPeriods:[...e.holidayPeriods,t.payload]};case x.DELETE_HOLIDAY_PERIOD:return{...e,holidayPeriods:e.holidayPeriods.filter(g=>g.id!==t.payload)};case x.DELETE_ALL_HOLIDAY_PERIODS:return{...e,holidayPeriods:[]};case x.UPDATE_HOLIDAY_PERIOD:return{...e,holidayPeriods:e.holidayPeriods.map(g=>g.id===t.payload.id?{...g,...t.payload}:g)};case x.TOGGLE_SINGLE_HOLIDAY:const a=t.payload,s=e.holidayDates||[],i=s.includes(a);return{...e,holidayDates:i?s.filter(g=>g!==a):[...s,a]};case x.ADD_ACTIVITY:return{...e,activities:[...e.activities,t.payload]};case x.UPDATE_ACTIVITY:const{activityId:o,updates:r}=t.payload,l=e.activities.map(g=>g.id===o?{...g,...r,updatedAt:new Date().toISOString()}:g);if(!r||!r.name&&!r.categoryId)return{...e,activities:l};const d=Object.entries(e.recordedActivities).reduce((g,[S,w])=>(w.some(I=>I.activityId===o)?g[S]=w.map(I=>I.activityId===o?{...I,activityName:r.name!==void 0?r.name:I.activityName,categoryId:r.categoryId!==void 0?r.categoryId:I.categoryId}:I):g[S]=w,g),{});return{...e,activities:l,recordedActivities:d};case x.DELETE_ACTIVITY:const c=t.payload,u={...e.recordedActivities};return Object.keys(u).forEach(g=>{u[g]=u[g].filter(S=>S.activityId!==c),u[g].length===0&&delete u[g]}),{...e,activities:e.activities.filter(g=>g.id!==c),recordedActivities:u};case x.RECORD_ACTIVITY:const{activityId:p,date:y,data:k}=t.payload,f=y.slice(0,10),E=e.activities.find(g=>g.id===p);if(!E)return e;const m={id:Te(),activityId:p,activityName:E.name,categoryId:E.categoryId,date:f,timestamp:new Date().toISOString(),duration:k.duration||null,intensity:k.intensity||null,notes:k.notes||"",...k},b=e.recordedActivities||{},h=b[f]||[];return{...e,recordedActivities:{...b,[f]:[...h,m]}};case x.UPDATE_ACTIVITY_CATEGORY_COLOR:return{...e,activityCategories:e.activityCategories.map(g=>g.id===t.payload.categoryId?{...g,color:t.payload.newColor}:g)};case x.UPDATE_SETTINGS:return{...e,settings:{...e.settings,...t.payload}};case x.SET_DARK_MODE:return{...e,settings:{...e.settings,darkMode:t.payload}};case x.TOGGLE_DARK_MODE:return{...e,settings:{...e.settings,darkMode:!e.settings.darkMode}};case x.TOGGLE_COMPLETED:return{...e,settings:{...e.settings,hideCompleted:!e.settings.hideCompleted}};case x.TOGGLE_SKIPPED:return{...e,settings:{...e.settings,hideSkipped:!e.settings.hideSkipped}};case x.IMPORT_DATA:return{...e,...t.payload};case x.RESET_STATE:return Xe(bt);default:return e}}const Pn={getHabits:(e=H)=>e.habits,getHabitById:(e=H,t)=>e.habits.find(n=>n.id===t),getCategories:(e=H)=>e.categories,getSelectedDate:(e=H)=>e.selectedDate,getSelectedGroup:(e=H)=>e.selectedGroup,getSettings:(e=H)=>e.settings,isDarkMode:(e=H)=>e.settings.darkMode};function xt(e){e&&((typeof e.progress!="object"||e.progress===null)&&(e.progress={}),Array.isArray(e.skippedDates)||(e.skippedDates=[]))}H.habits.forEach(xt);function on(e=H){Array.isArray(e.holidayDates)||(e.holidayDates=[]),Array.isArray(e.holidayPeriods)||(e.holidayPeriods=[])}on(H);const Rn=Object.freeze(Object.defineProperty({__proto__:null,ActionTypes:x,Actions:L,Selectors:Pn,dispatch:D,ensureHabitIntegrity:xt,ensureHolidayIntegrity:on,getState:v,initialState:bt,listeners:Ye,notify:an,reducer:sn,subscribe:_e},Symbol.toStringTag,{value:"Module"})),Et="healthyHabitsData";function rn(){try{if(typeof localStorage>"u")return!1;const e="__storage_test__";return localStorage.setItem(e,"1"),localStorage.removeItem(e),!0}catch{return!1}}const qn=(()=>{let e={};return{getItem:t=>e[t]??null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}})(),ln=rn()?localStorage:qn,Fn="healthyHabitsDB",he="state";let Ce=null;function cn(){return Ce||(Ce=new Promise((e,t)=>{if(!("indexedDB"in window))return e(null);const n=indexedDB.open(Fn,1);n.onupgradeneeded=()=>{const a=n.result;a.objectStoreNames.contains(he)||a.createObjectStore(he)},n.onsuccess=()=>e(n.result),n.onerror=()=>e(null)}),Ce)}async function Nn(e){const t=await cn();return t?new Promise(n=>{const i=t.transaction(he,"readonly").objectStore(he).get(e);i.onsuccess=()=>n(i.result||null),i.onerror=()=>n(null)}):null}async function Gn(e,t){const n=await cn();if(n)return new Promise(a=>{const s=n.transaction(he,"readwrite");s.objectStore(he).put(t,e),s.oncomplete=()=>a(),s.onerror=()=>a()})}let wt=!1;function jn(){return new Promise(e=>{const t=ln.getItem(Et);if(t)try{const n=Mn(t,{});D(L.importData(n));const s=Q(new Date);D(L.setSelectedDate(s)),D(L.setFitnessSelectedDate(s)),D(L.setSelectedGroup("daily"))}catch(n){console.error("[storage] Error parsing stored data:",n)}wt=!0,Nn("appData").then(n=>{if(n&&typeof n=="object"){D(L.importData(n));const s=Q(new Date);D(L.setSelectedDate(s)),D(L.setFitnessSelectedDate(s)),D(L.setSelectedGroup("daily"))}e()}).catch(n=>{e()})})}function Yn(){try{const e=$n(v(),"{}");ln.setItem(Et,e),Gn("appData",v())}catch(e){console.error("[storage] Error saving data to localStorage:",e)}}const Vn=Bn(()=>{wt&&Yn()},250);_e(Vn);typeof window<"u"&&rn()&&window.addEventListener("storage",e=>{if(e.key===Et&&e.newValue&&wt)try{D(L.importData(JSON.parse(e.newValue)))}catch{}});function Un(){const e=localStorage.getItem("theme"),t=e==="dark";D(L.setDarkMode(t)),e===null&&localStorage.setItem("theme","light"),dn()}function zn(){D(L.toggleDarkMode(!v().settings.darkMode)),dn(),localStorage.setItem("theme",v().settings.darkMode?"dark":"light")}function dn(){const e=v().settings.darkMode?"dark":"light";document.documentElement.setAttribute("data-theme",e);const t=document.getElementById("theme-toggle");if(t){const n=t.querySelector("svg");if(!n)return;v().settings.darkMode?n.innerHTML='<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" fill="none"/>':n.innerHTML='<circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="2"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2"/>'}}function Wn(){const e=document.querySelectorAll(".tab-item"),t=document.querySelectorAll(".view"),n={"fitness-view":"fitness-view-placeholder","stats-view":"stats-view-placeholder"},a={home:{loaded:!1,loading:!1,error:null},habits:{loaded:!1,loading:!1,error:null},fitness:{loaded:!1,loading:!1,error:null},stats:{loaded:!1,loading:!1,error:null}},s=Object.assign({"../features/fitness/FitnessModule.js":()=>A(()=>Promise.resolve().then(()=>oi),void 0),"../features/habits/HabitsModule.js":()=>A(()=>import("./HabitsModule-C12ATHgi.js"),__vite__mapDeps([0,1])),"../features/home/HomeModule.js":()=>A(()=>import("./HomeModule-CJtdgle-.js"),__vite__mapDeps([2,1]))});function i(c){var p;let u=document.getElementById(c);if(u||(u=document.createElement("div"),u.id=c,u.className="view w-full h-full flex flex-col overflow-hidden",(p=document.querySelector("main.content-area"))==null||p.appendChild(u)),u.childElementCount===0&&n[c]){const y=document.getElementById(n[c]);y&&u.appendChild(y.content.cloneNode(!0))}}async function o(c){if(a[c].loaded||a[c].loading)return;a[c].loading=!0;let u,p,y;const k={home:"../features/home/HomeModule.js",habits:"../features/habits/HabitsModule.js",fitness:"../features/fitness/FitnessModule.js",stats:"../features/stats/stats.js"};switch(c){case"home":u="home-view",p="home-loading",y="home-loading-spinner";try{const{HomeModule:E}=await s[k.home]();await E.init()}catch(E){console.error("Error loading home module:",E),a[c].error=E}break;case"habits":u="habits-view",p="habits-loading",y="habits-loading-spinner";try{const{HabitsModule:E}=await s[k.habits]();await E.init()}catch(E){console.error("Error loading habits module:",E),a[c].error=E}break;case"fitness":u="fitness-view",p=null,y=null;try{const{FitnessModule:E}=await s[k.fitness]();await E.init()}catch(E){console.error("Error loading fitness module:",E),a[c].error=E}break;case"stats":u="stats-view",p=null,y=null;try{await(await A(()=>import("./stats-B_Yw9SmN.js"),__vite__mapDeps([3,1]))).initializeStats()}catch(E){console.error("Error loading stats module:",E),a[c].error=E}break;default:return}const f=document.getElementById(u);if(f&&p&&!f.querySelector(`#${p}`)&&y){const E=document.getElementById(y);if(E){const m=E.content.cloneNode(!0).firstElementChild;f.appendChild(m),setTimeout(()=>m.remove(),500)}}a[c].loaded=!0,a[c].loading=!1}async function r(c){var p,y,k,f,E;if(i(c),requestAnimationFrame(()=>{t.forEach(m=>{m.id===c?(m.classList.add("active-view"),m.classList.remove("hidden"),m.classList.add("block")):(m.classList.remove("active-view"),m.classList.add("hidden"),m.classList.remove("block"),m.id==="fitness-view"&&m.classList.remove("search-expanded"))}),e.forEach(m=>{m.classList.toggle("active",m.dataset.view===c)})}),localStorage.setItem("activeHabitTrackerTab",c),c==="home-view"||c==="fitness-view"){const m=new Date;if(m.setHours(0,0,0,0),c==="home-view"){const b=document.querySelector('#home-view hh-calendar[state-key="selectedDate"]');(p=b==null?void 0:b.setDate)==null||p.call(b,m,{smooth:!0}),(k=(y=window.HomeModule)==null?void 0:y.refresh)==null||k.call(y)}else if(c==="fitness-view"){const{getLocalMidnightISOString:b}=await A(async()=>{const{getLocalMidnightISOString:g}=await Promise.resolve().then(()=>ie);return{getLocalMidnightISOString:g}},void 0),h=b(m);D(L.setFitnessSelectedDate(h)),(E=(f=document.querySelector('#fitness-view hh-calendar[state-key="fitnessSelectedDate"]'))==null?void 0:f.refresh)==null||E.call(f)}}c==="home-view"?await o("home"):c==="habits-view"?await o("habits"):c==="fitness-view"?await o("fitness"):c==="stats-view"&&await o("stats")}const l=localStorage.getItem("activeHabitTrackerTab")||"home-view";r(l),e.forEach(c=>{c.addEventListener("click",async u=>{const p=c.dataset.view;if(!p){console.error("No view ID found in dataset!");return}u.preventDefault(),await r(p)})});function d(c){var y;const u={home:"../features/home/HomeModule.js",habits:"../features/habits/HabitsModule.js",fitness:"../features/fitness/FitnessModule.js",stats:"../features/stats/stats.js"},p=`_${c}Prefetched`;window[p]||(y=a[c])!=null&&y.loaded||(window[p]=!0,s[u[c]]().catch(k=>{console.warn(`Failed to prefetch ${c} module:`,k),window[p]=!1}))}document.querySelectorAll(".tab-item[data-view]").forEach(c=>{const u=c.dataset.view.replace("-view","");u&&c.addEventListener("pointerenter",()=>d(u),{once:!0})}),window.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&(d("home"),d("habits"),d("fitness"),d("stats"))}),"requestIdleCallback"in window&&requestIdleCallback(()=>{d("home"),d("habits")},{timeout:2e3})}function z(e){const t=document.querySelectorAll(`#${e}`),n=t[t.length-1];if(!n)return;document.body.style.overflow="hidden",n.classList.remove("hidden"),n.classList.remove("animate-in","fade-in"),n.style.display="flex";const a=n.querySelector(".overflow-y-auto");a&&(a.scrollTop=0),n.parentNode!==document.body&&document.body.appendChild(n)}function R(e){const t=document.getElementById(e);if(!t)return;t.classList.add("hidden"),t.style.display="none",document.body.style.overflow="";const n=new CustomEvent("modalClosed",{detail:{modalId:e}});document.dispatchEvent(n)}function Kn(){const e=document.getElementById("time-picker-btn"),t=document.getElementById("time-picker-popup"),n=document.getElementById("selected-time"),a=document.getElementById("hour-select"),s=document.getElementById("minute-select"),i=document.getElementById("hour-picker"),o=document.getElementById("minute-picker");if(!e||!t||!i||!o)return;let r=a?a.value:"09",l=s?s.value:"00";function d(m,b){const h=m.getBoundingClientRect(),g=h.top+h.height/2;let S=null,w=1/0;if(m.querySelectorAll(`.${b}`).forEach(_=>{const T=_.getBoundingClientRect(),C=T.top+T.height/2,$=Math.abs(g-C);$<w&&(w=$,S=_)}),!S)return null;const I=b.replace("-option","");return S.dataset[I]??null}function c(m,b){const h=m.getBoundingClientRect(),g=h.top+h.height/2;let S=null,w=1/0;m.querySelectorAll(`.${b}`).forEach(I=>{const _=I.getBoundingClientRect(),T=_.top+_.height/2,C=Math.abs(g-T);C<w&&(w=C,S=I)}),S&&w>2&&S.scrollIntoView({behavior:"smooth",block:"center"})}function u(){const m=document.getElementById("hour-options-container");if(m&&m.childElementCount===0)for(let h=0;h<3;h++)for(let g=0;g<24;g++){const S=g.toString().padStart(2,"0"),w=document.createElement("div");w.className="hour-option py-1 text-center text-sm transition-colors",w.setAttribute("data-hour",S),w.textContent=S,m.appendChild(w)}const b=document.getElementById("minute-options-container");if(b){b.innerHTML="";for(let h=0;h<3;h++)for(let g=0;g<60;g++){const S=g.toString().padStart(2,"0"),w=document.createElement("div");w.className="minute-option py-1 text-center text-sm transition-colors",w.setAttribute("data-minute",S),w.textContent=S,b.appendChild(w)}}}function p(m,b){const g=m.scrollTop,S=b*28;g<S*.1?m.scrollTop=g+S:g>S*1.9&&(m.scrollTop=g-S)}function y(){const m=i.querySelectorAll(`[data-hour="${r}"]`);m.length>=2&&m[1].scrollIntoView({behavior:"instant",block:"center"});const b=o.querySelectorAll(`[data-minute="${l}"]`);b.length>=2&&b[1].scrollIntoView({behavior:"instant",block:"center"})}function k(){const m=d(i,"hour-option"),b=d(o,"minute-option");m!==null&&(r=m),b!==null&&(l=b),n&&(n.textContent=`${r}:${l}`)}e.addEventListener("click",m=>{m.stopPropagation(),a&&(r=a.value),s&&(l=s.value),u(),t.classList.remove("hidden"),setTimeout(y,10)}),document.addEventListener("click",m=>{!t.contains(m.target)&&!e.contains(m.target)&&(t.classList.contains("hidden")||(a&&(a.value=r),s&&(s.value=l),n&&(n.textContent=`${r}:${l}`),t.classList.add("hidden")))}),t.addEventListener("click",m=>m.stopPropagation());let f,E;i.addEventListener("scroll",()=>{p(i,24),k(),clearTimeout(f),f=setTimeout(()=>{c(i,"hour-option")},150)}),o.addEventListener("scroll",()=>{p(o,60),k(),clearTimeout(E),E=setTimeout(()=>{c(o,"minute-option")},150)})}const me=new Set;function un(){me.clear(),Array.isArray(v().holidayDates)&&v().holidayDates.forEach(e=>me.add(e))}function Xn(){un(),le()}function le(){const e=new Set(me);v().holidayPeriods.forEach(t=>{const n=new Date(t.startISO),a=new Date(t.endISO);for(;n<=a;)e.add(Y(n)),n.setDate(n.getDate()+1)}),D(L.setHolidayDates(Array.from(e)))}function Ie(e){const t=Y(e);return v().holidayDates.includes(t)?!0:v().holidayPeriods.some(n=>t>=n.startISO&&t<=n.endISO)}function Jn(e){const t=Y(e);me.has(t)?me.delete(t):me.add(t),le()}function Qn({startISO:e,endISO:t,label:n="Holiday"}){!e||!t||(t<e&&([e,t]=[t,e]),D(L.addHolidayPeriod({id:Te(),startISO:Y(e),endISO:Y(t),label:n})),le())}function Zn(e){D(L.deleteHolidayPeriod(e)),le()}function ea(e){D(L.updateHolidayPeriod(e)),le()}function ta(){D(L.deleteAllHolidayPeriods()),le()}const na=Object.freeze(Object.defineProperty({__proto__:null,addPeriod:Qn,deleteAllPeriods:ta,deletePeriod:Zn,initializeHolidays:Xn,isHoliday:Ie,recalcHolidayDates:le,syncSinglesFromState:un,toggleSingleHoliday:Jn,updatePeriod:ea},Symbol.toStringTag,{value:"Module"}));function Be(e){if(e.anchorDate){const t=new Date(e.anchorDate);if(!isNaN(t))return t}if(e.createdAt){const t=new Date(e.createdAt);if(!isNaN(t))return t}return new Date(0)}const aa={first:1,second:2,third:3,fourth:4,fifth:5};function sa(e,t){if(t==="last"){const a=new Date(e);return a.setDate(e.getDate()+7),a.getMonth()!==e.getMonth()}const n=aa[t];return n?Math.floor((e.getDate()-1)/7)+1===n:!1}function ia(e,t){if(e.paused===!0)return!1;const n=new Date(t);if(isNaN(n))return!1;const a=e.targetFrequency||e.frequency||"daily",s=typeof a=="string"?a.toLowerCase():a;if(typeof e.target=="number"&&e.target>0){if(s==="biweekly"){const r=Be(e);return Ge(r,n)%2===0}if(s==="daily"){const r=Y(n);if(Ie(r)&&!e.activeOnHolidays)return!1}return!0}const i=n.getDay(),o=Y(n);if(Ie(o)&&(s==="daily"||s==="weekly")&&!e.activeOnHolidays)return!1;if(s==="daily"||!s)return!0;if(s==="weekly")return Array.isArray(e.days)&&e.days.length>0?e.days.includes(i):!0;if(s==="biweekly"){if(Array.isArray(e.days)&&e.days.length>0&&!e.days.includes(i))return!1;const r=Be(e),l=Ge(r,n);if(l%2!==0)return!1;if(l===0){const d=r.getDay();if(i<d)return!1}return!0}if(s==="monthly"){const r=e.monthly||{},l=Math.max(1,parseInt(r.interval||1,10)),d=Be(e);if(((n.getFullYear()-d.getFullYear())*12+(n.getMonth()-d.getMonth()))%l!==0)return!1;if(!r.mode||r.mode==="each"){const u=Array.isArray(r.dates)&&r.dates.length>0?r.dates:null;return u?u.includes(n.getDate()):!0}if(r.mode==="on"){const u=Array.isArray(r.combinations)?r.combinations:[];return u.length===0?!0:u.some(p=>{const[y,k]=p.split("-");if(!y||!k)return!1;const f={sunday:0,monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6}[k.toLowerCase()];return f===void 0||f!==i?!1:sa(n,y.toLowerCase())})}return!0}if(s==="yearly"){const r=Array.isArray(e.months)&&e.months.length>0?e.months:null,l=Math.max(1,parseInt(e.yearInterval||1,10)),d=Be(e);return!((n.getFullYear()-d.getFullYear())%l!==0||r&&!r.includes(n.getMonth())||Array.isArray(e.yearlyDates)&&e.yearlyDates.length>0&&!e.yearlyDates.includes(n.getDate()))}return!0}class oa{static isDue(t,n){return ia(t,n)}}function ra(e){if(e.anchorDate){const t=new Date(e.anchorDate);if(!isNaN(t))return t}if(e.createdAt){const t=new Date(e.createdAt);if(!isNaN(t))return t}if(typeof e.id=="string"&&/^[0-9]{13}/.test(e.id)){const t=parseInt(e.id.slice(0,13),10);if(!Number.isNaN(t))return new Date(t)}return new Date(0)}function W(e,t){return oa.isDue(e,t)}function Je(e,t){const n=typeof e.target=="number"&&e.target>0,a=e.targetFrequency||e.frequency||"daily",s=typeof a=="string"?a.toLowerCase():a,i=e.frequency||e.targetFrequency||"daily",o=typeof i=="string"?i.toLowerCase():i;return t==="daily"?n?s==="daily":["daily","weekly","biweekly","monthly"].includes(o):t==="weekly"?n?s==="weekly"||s==="biweekly":!1:t==="monthly"?n?s==="monthly":o==="yearly":t==="yearly"?n&&s==="yearly":!1}function kt(e,t){const n=new Date(t),a=typeof e.target=="number"&&e.target>0,s=e.targetFrequency||e.frequency||"daily";if(!a){const i=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0");return`${i}-${o}-${r}`}if(s==="daily"){const i=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0");return`${i}-${o}-${r}`}if(s==="weekly"){const i=pe(n);return`${n.getFullYear()}-W${i}`}if(s==="monthly")return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`;if(s==="yearly")return`${n.getFullYear()}`;if(s==="biweekly"){const i=ra(e),o=Ge(i,n),r=new Date(i);r.setDate(i.getDate()+Math.floor(o/2)*14);const l=pe(r);return`${r.getFullYear()}-BW${l}`}return n.toISOString().slice(0,10)}function G(e,t){if(e.completed===!0)return!0;if(typeof e.completed!="object"||e.completed===null)return!1;const n=kt(e,t);return e.completed[n]===!0}function gn(e,t,n){const a=kt(e,t);(typeof e.completed!="object"||e.completed===null)&&(e.completed={}),e.completed[a]=n}function la(e,t){const n=G(e,t);gn(e,t,!n)}function ve(e,t=new Date){const n=t instanceof Date?t:new Date(t),a=Y(n);return Array.isArray(e.skippedDates)&&e.skippedDates.includes(a)}const yi=Object.freeze(Object.defineProperty({__proto__:null,belongsToSelectedGroup:Je,getPeriodKey:kt,isHabitCompleted:G,isHabitScheduledOnDate:W,isHabitSkippedToday:ve,setHabitCompleted:gn,toggleHabitCompleted:la},Symbol.toStringTag,{value:"Module"}));function yn(e){return e<34?getComputedStyle(document.documentElement).getPropertyValue("--danger-color").trim()||"#ff3b30":e<67?getComputedStyle(document.documentElement).getPropertyValue("--warning-color").trim()||"#ff9500":getComputedStyle(document.documentElement).getPropertyValue("--success-color").trim()||"#34c759"}function ca(e){const t=document.querySelector(".progress-ring-fg"),n=document.querySelector(".progress-number");if(!t||!n)return;const a=t.r.baseVal.value,s=2*Math.PI*a,i=s-e/100*s;t.style.strokeDashoffset=i,t.style.stroke=yn(e),n.textContent=`${Math.round(e)}%`}const da=["times","minutes","hours","steps","pages","cups","glasses","miles","kilometers","pounds","kilograms","repetitions","sets"],ua=["first","second","third","fourth","last"],ga=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],mn=["daily","weekly","biweekly","monthly","yearly"],mi=[{hex:"#EF4444",gradient:"from-red-400 to-red-600",shadow:"hover:shadow-red-500/25"},{hex:"#F97316",gradient:"from-orange-400 to-orange-600",shadow:"hover:shadow-orange-500/25"},{hex:"#EAB308",gradient:"from-amber-400 to-amber-600",shadow:"hover:shadow-amber-500/25"},{hex:"#22C55E",gradient:"from-green-400 to-green-600",shadow:"hover:shadow-green-500/25"},{hex:"#14B8A6",gradient:"from-teal-400 to-teal-600",shadow:"hover:shadow-teal-500/25"},{hex:"#06B6D4",gradient:"from-cyan-400 to-cyan-600",shadow:"hover:shadow-cyan-500/25"},{hex:"#0EA5E9",gradient:"from-sky-400 to-sky-600",shadow:"hover:shadow-sky-500/25"},{hex:"#2563EB",gradient:"from-blue-400 to-blue-600",shadow:"hover:shadow-blue-500/25"},{hex:"#4F46E5",gradient:"from-indigo-400 to-indigo-600",shadow:"hover:shadow-indigo-500/25"},{hex:"#9333EA",gradient:"from-purple-400 to-purple-600",shadow:"hover:shadow-purple-500/25"},{hex:"#EC4899",gradient:"from-pink-400 to-pink-600",shadow:"hover:shadow-pink-500/25"},{hex:"#F43F5E",gradient:"from-rose-400 to-rose-600",shadow:"hover:shadow-rose-500/25"}],fn=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],St=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ya(e){const t=["th","st","nd","rd"],n=e%100;return e+(t[(n-20)%10]||t[n]||t[0])}function ma(e=[],t){return e.length===0?"":e.length<=3?e.join(", "):`${e.length} ${t}`}function fa(e={}){if(!e)return"Monthly";const t=e.interval||1,n=t>1?`Every ${t} Months`:"Monthly";if(e.mode==="on"){const s=Array.isArray(e.combinations)?e.combinations:[];if(s.length===0)return n;const i=s.map(o=>{const[r,l]=o.split("-");return`${j(r)} ${j(l)}`});return yt(i,"dates",n)}const a=Array.isArray(e.dates)?e.dates.map(ya):[];return yt(a,"dates",n)}function pa({months:e=[],yearInterval:t=1}={}){const n=t>1?`Every ${t} Years`:"Yearly";if(!e||e.length===0)return n;const a=e.map(s=>St[s]);return yt(a,"months",n)}function yt(e,t,n){return e.length===1?`${e[0]} ${n}`.trim():e.length>1?`${e.length} ${t} ${n}`.trim():n}function ha(e){return e&&typeof e.target=="number"&&e.target>0?`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="10" stroke-width="2"/>
      <circle cx="12" cy="12" r="6" stroke-width="2"/>
      <circle cx="12" cy="12" r="2" fill="currentColor" stroke="currentColor" stroke-width="2"/>
    </svg>`:`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`}function va(e){const t=fn,n=j;let a="";switch(e.frequency){case"daily":a="Daily";break;case"weekly":case"biweekly":{const s=Array.isArray(e.days)?e.days.map(o=>t[o]):[],i=ma(s,"days");a=i?`${i} ${n(e.frequency)}`:n(e.frequency);break}case"monthly":{a=fa(e.monthly);break}case"yearly":{a=pa({months:e.months,yearInterval:e.yearInterval});break}default:a=e.frequency}if(e.target){const s=e.targetUnit&&e.targetUnit!=="none"?e.targetUnit:"",i=n(e.targetFrequency||e.frequency);a=`${e.target} ${s} ${i}`.replace(/\s+/g," ").trim()}return e.scheduledTime&&(a+=` • ${e.scheduledTime}`),e.paused&&(a+=" • Paused"),a}function Qe(e="#000000",t=1){let n=e.replace("#","");n.length===3&&(n=n.split("").map(r=>r+r).join(""));const a=parseInt(n,16),s=a>>16&255,i=a>>8&255,o=a&255;return`rgba(${s},${i},${o},${t})`}function fi(e,t=0,n=.07){const a=Math.max(0,Math.min(t,1))*100,s=Qe(e,n);return`linear-gradient(to right, ${e} ${a}%, transparent ${a}% ), ${s}`}function ba(e){const t=v().habits.find(c=>c.id===e);if(!t)return null;const n=new Date,a={totalCompletions:0,currentStreak:0,longestStreak:0,completionRate7d:0,completionRate30d:0,completionRateTotal:0,recentActivity:0,lastCompleted:null,targetProgress:null,weeklyAverage:0,daysTracked:0,totalSkipped:0,skippedPercentage:0};let s;if(typeof t.id=="string"&&/^[0-9]{13}/.test(t.id)){const c=parseInt(t.id.slice(0,13),10);Number.isNaN(c)||(s=new Date(c))}(!s||isNaN(s))&&(s=new Date);const i=Math.max(1,Math.floor((n-s)/(1e3*60*60*24))+1);a.daysTracked=i,a.completionRate7d=ot(t,7),a.completionRate30d=ot(t,30),a.completionRateTotal=ot(t,i),a.currentStreak=xa(t),a.longestStreak=Ea(t);let o=0;for(let c=0;c<Math.min(30,i);c++){const u=new Date(n);u.setDate(n.getDate()-c),!(u<s)&&W(t,u)&&G(t,u)&&(o++,(!a.lastCompleted||u>new Date(a.lastCompleted))&&(a.lastCompleted=u.toISOString()))}a.recentActivity=o;let r=0;for(let c=0;c<i;c++){const u=new Date(n);u.setDate(n.getDate()-c),!(u<s)&&W(t,u)&&(G(t,u)?a.totalCompletions++:ve(t,u)&&r++)}a.totalSkipped=r;const l=a.totalCompletions+a.totalSkipped;a.skippedPercentage=l>0?a.totalSkipped/l*100:0;const d=i/7;if(a.weeklyAverage=d>0?a.totalCompletions/d:0,t.target&&typeof t.target=="number"){const c=t.targetFrequency||t.frequency||"daily",u=G(t,n);c==="daily"&&(a.targetProgress={completed:u?1:0,target:t.target,unit:t.targetUnit||"",isComplete:u})}return a}function ot(e,t=30){const n=new Date;let a=0,s=0,i;if(typeof e.id=="string"&&/^[0-9]{13}/.test(e.id)){const r=parseInt(e.id.slice(0,13),10);Number.isNaN(r)||(i=new Date(r))}(!i||isNaN(i))&&(i=new Date);const o=Math.min(t,Math.floor((n-i)/(1e3*60*60*24))+1);for(let r=0;r<o;r++){const l=new Date(n);l.setDate(n.getDate()-r),!(l<i)&&W(e,l)&&(s++,G(e,l)&&a++)}return s>0?a/s*100:0}function xa(e){const t=new Date;let n=0,a=new Date(t),s;if(typeof e.id=="string"&&/^[0-9]{13}/.test(e.id)){const i=parseInt(e.id.slice(0,13),10);Number.isNaN(i)||(s=new Date(i))}for((!s||isNaN(s))&&(s=new Date);a>=s;){if(W(e,a))if(G(e,a))n++;else break;a.setDate(a.getDate()-1)}return n}function Ea(e){const t=new Date;let n=0,a=0,s=new Date(t),i;if(typeof e.id=="string"&&/^[0-9]{13}/.test(e.id)){const o=parseInt(e.id.slice(0,13),10);Number.isNaN(o)||(i=new Date(o))}for((!i||isNaN(i))&&(i=new Date);s>=i;)W(e,s)&&(G(e,s)?(a++,n=Math.max(n,a)):a=0),s.setDate(s.getDate()-1);return n}let N=null;function wa(e){const t=v().habits.find(a=>a.id===e);if(!t)return;const n=ba(e);ka(t,n)}function ka(e,t){const n=v().categories.find(d=>d.id===e.categoryId),a=Sa(e,t),s=`
    <div id="habit-stats-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div class="bg-white dark:bg-gray-800 rounded-xl max-w-md w-full max-h-[90vh] flex flex-col">
        <div class="flex-shrink-0 p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 rounded-full flex items-center justify-center text-xl" style="background: ${(n==null?void 0:n.color)||"#888"}; color: white;">
                ${e.icon||"📋"}
              </div>
              <div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">${e.name}</h3>
                <p class="text-sm text-gray-500 dark:text-gray-400">${(n==null?void 0:n.name)||"Uncategorized"}</p>
              </div>
            </div>
            <button id="close-habit-stats-modal" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-1">
              <span class="material-icons">close</span>
            </button>
          </div>
        </div>
        <div class="flex-1 overflow-y-auto p-6">
          ${a}
        </div>
      </div>
    </div>
  `,i=document.getElementById("habit-stats-modal");i&&i.remove(),document.body.insertAdjacentHTML("beforeend",s);const o=document.getElementById("habit-stats-modal"),r=document.getElementById("close-habit-stats-modal"),l=()=>{N&&(clearInterval(N),N=null),o&&(o.classList.add("hidden"),setTimeout(()=>o.remove(),300))};r&&r.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),l()}),o&&o.addEventListener("click",d=>{d.target===o&&l()}),o&&o.classList.remove("hidden"),setTimeout(()=>{Da(o)},300)}function Sa(e,t,n){if(!t||t.daysTracked===0)return`
      <div class="text-center py-8">
        <span class="material-icons text-4xl text-gray-400 mb-4">bar_chart</span>
        <p class="text-gray-600 dark:text-gray-400">No data available yet</p>
        <p class="text-sm text-gray-500 mt-2">Start completing this habit to see statistics</p>
      </div>
    `;let a=`
    <div class="stats-grid space-y-4">
      <!-- Overview Stats -->
      <div class="stats-section">
        <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Overview</h4>
        <div class="grid grid-cols-2 gap-4">
          <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            <div class="stat-value text-2xl font-bold text-gray-900 dark:text-white">${t.totalCompletions}</div>
            <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Total Completions</div>
          </div>
          <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            <div class="stat-value text-2xl font-bold text-gray-900 dark:text-white">${t.weeklyAverage.toFixed(1)}</div>
            <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Per Week Average</div>
          </div>
        </div>
      </div>
  `;const s=[{days:7,label:"7d",rate:t.completionRate7d},{days:30,label:"30d",rate:t.completionRate30d},{days:t.daysTracked,label:"All Time",rate:t.completionRateTotal}],i=Ia(s);a+=`
    <div class="stats-section">
      <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Completion Rates</h4>
      ${i}
      <div class="grid grid-cols-2 gap-4 mt-4">
        <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
          <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${t.daysTracked}</div>
          <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Days Tracked</div>
        </div>
        <div class="stat-card bg-orange-50 dark:bg-orange-900 p-3 rounded-lg">
          <div class="stat-value text-xl font-bold text-orange-600 dark:text-orange-300">${t.totalSkipped}</div>
          <div class="stat-label text-xs text-orange-600 dark:text-orange-300">Times Skipped</div>
          <div class="stat-sublabel text-xs text-orange-500 dark:text-orange-400 mt-1">
            ${t.skippedPercentage.toFixed(1)}% of actions
          </div>
        </div>
      </div>
    </div>
  `,a+=`
    <div class="stats-section">
      <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Streaks</h4>
      <div class="grid grid-cols-2 gap-4">
        <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
          <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${t.currentStreak}</div>
          <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Current Streak</div>
        </div>
        <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
          <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${t.longestStreak}</div>
          <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Longest Streak</div>
        </div>
      </div>
    </div>
  `;const o=t.lastCompleted?vt(t.lastCompleted):"Never";return a+=`
    <div class="stats-section">
      <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Recent Activity</h4>
      <div class="grid grid-cols-2 gap-4">
        <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
          <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${t.recentActivity}</div>
          <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Last 30 Days</div>
        </div>
        <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
          <div class="stat-value text-sm font-bold text-gray-900 dark:text-white break-words">${o}</div>
          <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Last Completed</div>
        </div>
      </div>
    </div>
  `,a+="</div>",a}function Ia(e){if(e.length===1){const a=e[0];return`
      <div class="completion-rates">
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
          <div class="text-xl font-bold text-center mb-1 text-gray-900 dark:text-white">
            ${a.rate.toFixed(1)}%
          </div>
          <div class="text-center text-xs text-gray-500 dark:text-gray-400">
            Completion Rate (${a.label})
          </div>
        </div>
      </div>
    `}const t=e.map((a,s)=>`
    <div class="carousel-slide ${s===0?"active":""}" data-slide="${s}">
      <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
        <div class="text-xl font-bold text-center mb-1 text-gray-900 dark:text-white">
          ${a.rate.toFixed(1)}%
        </div>
        <div class="text-center text-xs text-gray-500 dark:text-gray-400">
          Completion Rate (${a.label})
        </div>
      </div>
    </div>
  `).join(""),n=e.map((a,s)=>`
    <div class="carousel-dot ${s===0?"active":""}" data-slide="${s}"></div>
  `).join("");return`
    <div class="completion-rates">
      <div class="completion-carousel" id="habit-completion-carousel">
        <div class="carousel-container">
          <div class="carousel-track" id="habit-carousel-track">
            ${t}
          </div>
        </div>
        <div class="carousel-dots" id="habit-carousel-dots">
          ${n}
        </div>
      </div>
    </div>
  `}function Da(e=document){const t=e.querySelector(".completion-carousel"),n=t?t.querySelector(".carousel-track"):null,a=t?t.querySelector(".carousel-dots"):null;if(!t||!n||!a)return;const s=n.querySelectorAll(".carousel-slide"),i=a.querySelectorAll(".carousel-dot");if(s.length<=1)return;let o=0,r=0,l=0;function d(f){f<0||f>=s.length||(o=f,s.forEach((E,m)=>{E.classList.toggle("active",m===o)}),i.forEach((E,m)=>{E.classList.toggle("active",m===o)}))}function c(){const f=(o+1)%s.length;d(f)}function u(){const f=(o-1+s.length)%s.length;d(f)}i.forEach((f,E)=>{f.addEventListener("click",m=>{m.stopPropagation(),d(E)})}),t.addEventListener("touchstart",f=>{r=f.touches[0].clientX}),t.addEventListener("touchend",f=>{l=f.changedTouches[0].clientX,k()});let p=!1,y=0;t.addEventListener("mousedown",f=>{p=!0,y=f.clientX,t.style.cursor="grabbing"}),t.addEventListener("mousemove",f=>{p&&f.preventDefault()}),t.addEventListener("mouseup",f=>{if(!p)return;p=!1,t.style.cursor="grab";const E=f.clientX,m=y-E;Math.abs(m)>50&&(m>0?c():u())});function k(){const E=r-l;Math.abs(E)>50&&(E>0?c():u())}t.style.cursor="grab",N&&clearInterval(N),N=setInterval(()=>{c()},1e4),t.addEventListener("mouseenter",()=>{N&&(clearInterval(N),N=null)}),t.addEventListener("mouseleave",f=>{p&&(p=!1,t.style.cursor="grab"),N&&clearInterval(N),N=setInterval(()=>{c()},1e4)})}function pn(){const e=document.getElementById("completed-section"),t=document.getElementById("skipped-section");e&&e.classList.toggle("collapsed",v().settings.hideCompleted),t&&t.classList.toggle("collapsed",v().settings.hideSkipped);const n=new Date(v().selectedDate),s=v().habits.filter(r=>Je(r,v().selectedGroup)&&W(r,n)).filter(r=>!ve(r,n)),i=s.filter(r=>G(r,n)),o=s.length?i.length/s.length*100:0;ca(o)}function hn(e){const n=v().selectedDate.slice(0,10);D(L.toggleHabitCompleted(e,n))}function vn(e){const t=document.getElementById(`${e}-section`);if(!t)return;const n=!t.classList.toggle("collapsed");e==="completed"?D(L.toggleCompleted(n)):e==="skipped"&&D(L.toggleSkipped(n));const a=t.querySelector(".toggle-section");a&&(a.textContent=n?"Show ⌄":"Hide ⌄")}function La(e,t,n){const a=n?"rounded-b-2xl":"";function s(r){return`<span class="flex items-center gap-1 px-1.5 py-0.5 rounded-md text-black" style="background-color:${t.color}20; color:#000">${r}</span>`}const i=[];if(e.paused)i.push(s("Paused"));else{const r=va(e).split(" • ")[0];i.push(s(`${ha(e)} ${r}`)),e.scheduledTime&&i.push(s(`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg> ${e.scheduledTime}`)),e.activeOnHolidays&&i.push(s('<span class="material-icons text-base leading-none">flight</span>'))}const o=`<div class="habit-meta flex flex-wrap gap-1 text-gray-600 dark:text-gray-400 text-xs -mt-1">${i.join("")}</div>`;return`
    <div class="flex flex-row items-stretch habit-row w-full mb-1">
      <div class="habit-drag-handle drag-handle hidden w-7 h-12 flex items-center justify-center cursor-grab text-gray-400 mr-1">
        <span class="material-icons text-2xl leading-none">drag_handle</span>
      </div>
      <div class="habit-item flex items-center px-4 py-1.5 bg-white dark:bg-gray-800 border-[3px] rounded-xl ${a} flex-grow w-full" style="border-color: ${t.color}" data-habit-id="${e.id}">
        <div class="habit-icon w-8 h-8 rounded-lg flex items-center justify-center mr-4 text-xl" style="background-color: ${t.color}20;">
          ${e.icon||"📋"}
        </div>
        <div class="habit-content flex-grow">
          <div class="habit-name text-sm font-semibold text-gray-900 dark:text-white">${e.name}</div>
          ${o}
        </div>
        <div class="habit-actions flex items-center gap-2 ml-2">
          <button class="stats-habit-btn w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-600 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors" data-habit-id="${e.id}" title="View Stats">
            <span class="material-icons text-lg">bar_chart</span>
          </button>
          <button class="edit-habit-btn flex-shrink-0 w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center" data-habit-id="${e.id}">
            <svg class="w-4 h-4 text-gray-600 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke="currentColor" stroke-width="2"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2"/></svg>
          </button>
        </div>
      </div>
    </div>`}function Ta(e,t){let n="";t.length?n=t.map((i,o)=>La(i,e,o===t.length-1)).join(""):n='<div class="p-6 text-center text-gray-400 dark:text-gray-500">No habits yet</div>';const a=`<button class="expand-btn h-5 w-5 flex items-center justify-center text-black">
      <span class="material-icons transition-transform leading-none">expand_more</span>
    </button>`,s=`<button class="edit-category-btn w-8 h-8 rounded-full flex items-center justify-center" data-category-id="${e.id}" style="background-color:${e.color}">
      <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke="currentColor" stroke-width="2"/>
        <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2"/>
      </svg>
    </button>`;return`<div class="category-section mb-4" data-category-id="${e.id}">
      <div class="flex items-center gap-2">
        <div class="category-drag-handle drag-handle hidden w-7 h-12 flex items-center justify-center cursor-grab text-gray-400">
          <span class="material-icons text-2xl leading-none">drag_handle</span>
        </div>
        <div class="category-header flex items-center justify-between px-4 py-0 rounded-t-2xl cursor-pointer select-none flex-grow" style="background:${Qe(e.color,.25)};">
          <div class="category-title flex items-center gap-3">
            <span class="font-semibold text-lg leading-none text-black py-1.5">${e.name}</span>
          </div>
          ${a}
        </div>
        ${s}
      </div>
      <div class="category-habits pl-6">${n}</div>
    </div>`}function _a(e){const t=document.createElement("div");return t.id="habits-list-container",t.className="habits-list flex-grow overflow-y-auto px-4 pb-8",t._onHabitClick=e,t}function Ze(e){var s;const t=document.getElementById("habits-list-container");if(!t)return;t._onHabitClick=e,t.innerHTML="";const n=new Map;v().categories.forEach(i=>n.set(i.id,[])),v().habits.forEach(i=>{n.has(i.categoryId)&&n.get(i.categoryId).push(i)}),v().categories.forEach(i=>{const o=Ta(i,n.get(i.id));t.insertAdjacentHTML("beforeend",o)}),v().categories.length===0&&(t.insertAdjacentHTML("beforeend",`
      <div class="w-full flex flex-col items-center justify-center py-12 mt-6 text-center space-y-2" id="no-category-cta">
        <span class="material-icons text-5xl text-gray-400">create_new_folder</span>
        <h2 class="text-lg font-semibold text-gray-900 dark:text-white">No categories yet</h2>
        <p class="text-sm text-gray-600 dark:text-gray-400 max-w-xs mx-auto">Start by creating a category to organise your habits.</p>
        <button class="create-first-category-btn bg-ios-orange text-white px-4 py-3 rounded-xl font-medium hover:bg-orange-600 transition-colors">Create Your First Category</button>
      </div>`),(s=t.querySelector(".create-first-category-btn"))==null||s.addEventListener("click",()=>{A(()=>import("./categories-DPpWsi8d.js"),__vite__mapDeps([4,1])).then(o=>{o.initializeCategories(),o.openAddCategoryModal()})})),t.querySelectorAll(".habit-item").forEach(i=>{i.addEventListener("click",()=>{const o=i.dataset.habitId;o&&hn(o)})}),t.querySelectorAll(".edit-habit-btn").forEach(i=>{i.addEventListener("click",o=>{o.stopPropagation();const r=i.dataset.habitId;r&&A(()=>Promise.resolve().then(()=>es),void 0).then(l=>l.openEditHabitModal(r))})}),t.querySelectorAll(".stats-habit-btn").forEach(i=>{i.addEventListener("click",o=>{o.stopPropagation();const r=i.dataset.habitId;r&&wa(r)})});function a(i){if(!i)return;const o=i.querySelector(".category-habits");if(!o)return;const r=o.classList.toggle("hidden"),l=i.querySelector(".expand-btn .material-icons");l&&l.classList.toggle("rotate-180",r)}t.querySelectorAll(".expand-btn").forEach(i=>{i.addEventListener("click",o=>{o.stopPropagation(),a(i.closest(".category-section"))})}),t.querySelectorAll(".category-header").forEach(i=>{i.addEventListener("click",o=>{o.target.closest(".expand-btn")||o.target.closest(".edit-category-btn")||a(i.closest(".category-section"))})}),A(()=>import("./categories-DPpWsi8d.js"),__vite__mapDeps([4,1])).then(i=>i.initializeCategories())}function Aa(){pn(),Ze(),document.querySelectorAll(".toggle-section").forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".habits-section");if(t&&t.id){const n=t.id.replace("-section","");vn(n)}})})}const pi=Object.freeze(Object.defineProperty({__proto__:null,initializeHabitsList:Aa,mountHabitsList:_a,renderHabitsList:Ze,renderHomeView:pn,toggleHabitCompletion:hn,toggleSectionVisibility:vn},Symbol.toStringTag,{value:"Module"}));let It="📋";function et(){return It}function Dt(e){It=e}const Ca=["💪","🏃","🚴","🏊","🧘","⚖️","🍎","🥗","💧","☕","🥛","🍊","📚","📖","✏️","🎓","💡","🧠","💼","💻","📱","📊","📝","📋","😴","🛏️","🌙","⏰","🕐","⏱️","🎵","🎸","🎨","📷","🎮","🎯","🌱","🌳","🌸","🌞","🌍","♻️","👥","👪","❤️","🤝","📞","💬","🧼","🪥","🚿","💊","🧴","🎯","✈️","🚗","🚶","🗺️","🎒","📍","💰","💳","💎","📈","🏦","💸","⭐","🎉","🔥","⚡","✨","🚀"];let _t=!1;function At(e){if(_t)return;const t=e.querySelector("#icon-grid");if(!t){console.warn("Icon grid element not found in modal");return}t.innerHTML="";const n=document.createDocumentFragment();Ca.forEach(a=>{const s=document.createElement("button");s.className="icon-option w-12 h-12 rounded-xl bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-xl hover:bg-ios-blue hover:text-white transition-all duration-200 hover:scale-105",s.dataset.icon=a,s.textContent=a,n.appendChild(s)}),t.appendChild(n),_t=!0}function Ba(){const e=document.getElementById("icon-selector-btn"),t=document.getElementById("icon-selection-modal"),n=document.getElementById("selected-icon-display");if(!e||!t||!n)return;At(t);function a(){n.textContent=It}e.addEventListener("click",()=>{At(t);const r=t.querySelector("#icon-grid");r&&r.children.length>0?z("icon-selection-modal"):console.error("Failed to build icon grid, cannot open modal")}),t.addEventListener("click",r=>{r.target===t&&R("icon-selection-modal")});const s=document.getElementById("select-icon"),i=document.getElementById("cancel-icon");function o(){t.querySelectorAll(".icon-option").forEach(r=>r.classList.remove("ring","ring-ios-blue","ring-2"))}t.addEventListener("click",r=>{const l=r.target.closest(".icon-option");l&&(Dt(l.dataset.icon||"📋"),o(),l.classList.add("ring","ring-ios-blue","ring-2"),s.disabled=!1)}),s==null||s.addEventListener("click",()=>{a(),R("icon-selection-modal")}),i==null||i.addEventListener("click",()=>R("icon-selection-modal")),a()}const xe=new Set,Ee=new Set,ee=new Set,Z=new Set,te=new Set,oe=new Set;let Oe="each";function Ve(e){var t,n,a,s;Oe=e,Ue(),(t=document.getElementById("monthly-each-btn"))==null||t.classList.toggle("font-semibold",e==="each"),(n=document.getElementById("monthly-on-btn"))==null||n.classList.toggle("font-semibold",e==="on"),(a=document.getElementById("monthly-dates-section"))==null||a.classList.toggle("hidden",e!=="each"),(s=document.getElementById("monthly-combinations-section"))==null||s.classList.toggle("hidden",e!=="on")}function Ct(e){document.querySelectorAll(".day-button").forEach(t=>{const n=parseInt(t.dataset.day,10);e.has(n)?t.classList.add("selected"):t.classList.remove("selected")})}function Ma(e){document.querySelectorAll(".date-button").forEach(t=>{const n=parseInt(t.dataset.date,10);e.has(n)?t.classList.add("selected"):t.classList.remove("selected")})}function $a(e){document.querySelectorAll(".month-button").forEach(t=>{const n=parseInt(t.dataset.month,10);e.has(n)?t.classList.add("selected"):t.classList.remove("selected")})}function Ue(){var s;const e=(s=document.getElementById("frequency-select"))==null?void 0:s.value,t=document.getElementById("days-selection"),n=document.getElementById("monthly-details"),a=document.getElementById("yearly-details");t&&t.classList.toggle("hidden",!(e==="weekly"||e==="biweekly")),n&&n.classList.toggle("hidden",e!=="monthly"),a&&a.classList.toggle("hidden",e!=="yearly"),e==="weekly"?Ct(xe):e==="biweekly"&&Ct(Ee),e==="monthly"&&(Ma(ee),nt()),e==="yearly"&&($a(te),tt(),Ae())}function Ha(e){var i;const t=e.target.closest(".day-button");if(!t)return;const n=parseInt(t.dataset.day,10),a=(i=document.getElementById("frequency-select"))==null?void 0:i.value;if(isNaN(n)||!(a==="weekly"||a==="biweekly"))return;const s=a==="weekly"?xe:Ee;t.classList.toggle("selected")?s.add(n):s.delete(n)}function Bt(e){var a;const t=(a=document.getElementById("frequency-select"))==null?void 0:a.value;if(!(t==="weekly"||t==="biweekly"))return;const n=t==="weekly"?xe:Ee;n.clear(),document.querySelectorAll(".day-button").forEach(s=>{e?(s.classList.add("selected"),n.add(parseInt(s.dataset.day,10))):s.classList.remove("selected")})}function Oa(e){if(!e.target.classList.contains("date-button"))return;const t=parseInt(e.target.dataset.date,10);e.target.classList.toggle("selected"),e.target.classList.contains("selected")?ee.add(t):ee.delete(t),nt()}function Mt(e){ee.clear(),document.querySelectorAll(".date-button").forEach(t=>{e?(t.classList.add("selected"),ee.add(parseInt(t.dataset.date,10))):t.classList.remove("selected")}),nt()}function Pa(e){if(!e.target.classList.contains("month-button"))return;const t=parseInt(e.target.dataset.month,10);e.target.classList.toggle("selected"),e.target.classList.contains("selected")?te.add(t):te.delete(t),tt()}function Ra(e){if(!e.target.classList.contains("yearly-date-button"))return;const t=parseInt(e.target.dataset.date,10);e.target.classList.toggle("selected"),e.target.classList.contains("selected")?oe.add(t):oe.delete(t),Ae()}function $t(e){te.clear(),document.querySelectorAll(".month-button").forEach(t=>{e?(t.classList.add("selected"),te.add(parseInt(t.dataset.month,10))):t.classList.remove("selected")}),tt()}function Ht(e){oe.clear(),document.querySelectorAll(".yearly-date-button").forEach(t=>{e?(t.classList.add("selected"),oe.add(parseInt(t.dataset.date,10))):t.classList.remove("selected")}),Ae()}function qa(){var a,s;const e=(a=document.getElementById("ordinal-select"))==null?void 0:a.value,t=(s=document.getElementById("day-of-week-select"))==null?void 0:s.value;if(!e||!t)return;const n=`${e}-${t}`;Z.has(n)||(Z.add(n),be())}function be(){const e=document.getElementById("combinations-list");if(!e)return;if(e.innerHTML="",Z.size===0){const n=document.createElement("span");n.textContent="No combinations added yet",n.className="text-gray-500 text-sm",e.appendChild(n);return}const t=document.createElement("div");t.className="space-y-2",Z.forEach(n=>{const[a,s]=n.split("-"),i=document.createElement("div");i.className="flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 w-full";const o=document.createElement("span");o.className="text-gray-900 dark:text-white text-sm font-semibold",o.textContent=`${j(a)} ${j(s)}`;const r=document.createElement("button");r.className="w-5 h-5 bg-red-500 rounded-full text-white text-xs flex items-center justify-center flex-shrink-0 ml-3",r.innerHTML="×",r.onclick=()=>{Z.delete(n),be()},i.appendChild(o),i.appendChild(r),t.appendChild(i)}),e.appendChild(t)}function tt(){const e=document.getElementById("selected-months-count");e&&(e.textContent=te.size)}function nt(){const e=document.getElementById("selected-dates-count");e&&(e.textContent=ee.size)}function Ae(){const e=document.getElementById("selected-yearly-dates-count");e&&(e.textContent=oe.size)}function Fa(){var e,t,n,a,s,i,o,r,l,d,c,u,p,y,k,f;bn(),xn(),Na(),Ga(),Ya(),Pt("month-interval-select",12),Pt("year-interval-select",5),ja(),Me("month-interval-select","month-text","month","months"),Me("year-interval-select","year-text","year","years"),(e=document.getElementById("frequency-select"))==null||e.addEventListener("change",Ue),document.addEventListener("click",Ha),(t=document.getElementById("select-all-days"))==null||t.addEventListener("click",()=>Bt(!0)),(n=document.getElementById("clear-all-days"))==null||n.addEventListener("click",()=>Bt(!1)),(a=document.getElementById("monthly-each-btn"))==null||a.addEventListener("click",()=>Ve("each")),(s=document.getElementById("monthly-on-btn"))==null||s.addEventListener("click",()=>Ve("on")),document.addEventListener("click",Oa),(i=document.getElementById("select-all-dates"))==null||i.addEventListener("click",()=>Mt(!0)),(o=document.getElementById("clear-dates"))==null||o.addEventListener("click",()=>Mt(!1)),(r=document.getElementById("add-combination-btn"))==null||r.addEventListener("click",qa),(l=document.getElementById("clear-all-combinations"))==null||l.addEventListener("click",()=>{Z.clear(),be()}),document.addEventListener("click",Pa),document.addEventListener("click",Ra),(d=document.getElementById("select-all-months"))==null||d.addEventListener("click",()=>$t(!0)),(c=document.getElementById("clear-months"))==null||c.addEventListener("click",()=>$t(!1)),(u=document.getElementById("select-all-yearly-dates"))==null||u.addEventListener("click",()=>Ht(!0)),(p=document.getElementById("clear-yearly-dates"))==null||p.addEventListener("click",()=>Ht(!1)),(y=document.getElementById("yearly-specify-dates-toggle"))==null||y.addEventListener("change",Ot),Ue(),Ot(),be(),tt(),nt(),Ae(),(k=document.getElementById("month-interval-select"))==null||k.addEventListener("change",()=>Me("month-interval-select","month-text","month","months")),(f=document.getElementById("year-interval-select"))==null||f.addEventListener("change",()=>Me("year-interval-select","year-text","year","years"))}function bn(){const e=document.getElementById("monthly-date-grid");if(!e||e.childElementCount)return;const t=document.createDocumentFragment();for(let n=1;n<=31;n++){const a=document.createElement("button");a.className="date-button w-full aspect-square rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white font-medium text-sm hover:border-ios-blue hover:bg-ios-blue/5 transition-all",a.dataset.date=n,a.textContent=n,t.appendChild(a)}e.appendChild(t)}function xn(){const e=document.getElementById("yearly-month-grid");if(!e||e.childElementCount)return;const t=St,n=document.createDocumentFragment();t.forEach((a,s)=>{const i=document.createElement("button");i.className="month-button w-full py-3 rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white font-medium text-sm hover:border-ios-blue hover:bg-ios-blue/10 transition-colors selected:border-[#007AFF] selected:bg-[#007AFF] selected:text-white",i.dataset.month=s,i.textContent=a,n.appendChild(i)}),e.appendChild(n)}function Na(){const e=document.getElementById("yearly-date-grid");if(!e||e.childElementCount)return;const t=document.createDocumentFragment();for(let n=1;n<=31;n++){const a=document.createElement("button");a.className="yearly-date-button w-full aspect-square rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white font-medium text-sm hover:border-ios-blue hover:bg-ios-blue/10 transition-colors selected:border-[#007AFF] selected:bg-[#007AFF] selected:text-white",a.dataset.date=n,a.textContent=n,t.appendChild(a)}e.appendChild(t)}function Ga(){const e=document.getElementById("weekly-day-grid");if(!e||e.childElementCount)return;const t=["S","M","T","W","T","F","S"],n=document.createDocumentFragment();t.forEach((a,s)=>{const i=document.createElement("button");i.className="day-button flex-1 h-12 rounded-lg border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-medium text-sm hover:border-ios-blue transition-colors",i.dataset.day=s,i.textContent=a,n.appendChild(i)}),e.appendChild(n)}function Ot(){var t,n;const e=((t=document.getElementById("yearly-specify-dates-toggle"))==null?void 0:t.checked)??!1;(n=document.getElementById("yearly-dates-section"))==null||n.classList.toggle("hidden",!e),e||(oe.clear(),document.querySelectorAll(".yearly-date-button.selected").forEach(a=>a.classList.remove("selected")),Ae())}function Pt(e,t){const n=document.getElementById(e);if(!(!n||n.dataset.enhanced)){for(let a=1;a<=t;a++){const s=document.createElement("option");s.value=a,s.textContent=a,n.appendChild(s)}n.dataset.enhanced="1"}}function Me(e,t,n,a){var o;const s=parseInt(((o=document.getElementById(e))==null?void 0:o.value)||"1",10),i=document.getElementById(t);i&&(i.textContent=s===1?n:a)}function ja(){const e=document.getElementById("ordinal-select"),t=document.getElementById("day-of-week-select");e&&!e.dataset.enhanced&&(e.innerHTML="",ua.forEach(n=>{const a=document.createElement("option");a.value=n,a.textContent=j(n),e.appendChild(a)}),e.dataset.enhanced="1"),t&&!t.dataset.enhanced&&(t.innerHTML="",ga.forEach(n=>{const a=document.createElement("option");a.value=n,a.textContent=j(n),t.appendChild(a)}),t.dataset.enhanced="1")}function Ya(){const e=document.getElementById("frequency-select");!e||e.dataset.enhanced||(e.innerHTML="",mn.forEach(t=>{const n=document.createElement("option");n.value=t,n.textContent=j(t),e.appendChild(n)}),e.dataset.enhanced="1")}function Va(){const e=document.getElementById("target-unit-select");!e||e.dataset.enhanced||(da.forEach(t=>{const n=document.createElement("option");n.value=t,n.textContent=j(t),e.appendChild(n)}),e.dataset.enhanced="1")}function Ua(){const e=document.getElementById("target-frequency-select");!e||e.dataset.enhanced||(e.innerHTML="",mn.forEach(t=>{const n=document.createElement("option");n.value=t,n.textContent=j(t),e.appendChild(n)}),e.dataset.enhanced="1")}function Pe(){var i,o,r;const e=document.getElementById("target-example-text");if(!e)return;const t=((i=document.getElementById("target-frequency-select"))==null?void 0:i.value)||"daily",n=((o=document.getElementById("target-value-input"))==null?void 0:o.value)||"1",a=((r=document.getElementById("target-unit-select"))==null?void 0:r.value)||"none",s=a==="none"?"":` ${a}`;e.textContent=`Example: ${n}${s} each ${t}`}function za(){Ua(),Va(),["target-frequency-select","target-value-input","target-unit-select"].forEach(e=>{var t,n;(t=document.getElementById(e))==null||t.addEventListener("input",Pe),(n=document.getElementById(e))==null||n.addEventListener("change",Pe)}),Pe()}function En({title:e="Are you sure?",message:t="",okText:n="OK",cancelText:a="Cancel",onOK:s}={}){let i=document.getElementById("global-confirm-modal");i||(i=document.createElement("div"),i.id="global-confirm-modal",i.className="modal-overlay fixed inset-0 bg-black/70 backdrop-blur-sm z-[1100] hidden items-center justify-center p-4",document.body.appendChild(i));const o=!a;i.innerHTML=`<div class="modal-content bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-sm w-full p-6 text-center">
      <h2 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">${e}</h2>
      <p class="text-sm text-gray-600 dark:text-gray-400 mb-6">${t}</p>
      <div class="flex ${o?"justify-center":"gap-3"}">
        ${o?"":`<button class='confirm-cancel-btn flex-1 py-2 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors'>${a}</button>`}
        <button class='confirm-ok-btn ${o?"w-full":"flex-1"} py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 transition-colors'>${n}</button>
      </div>
    </div>`,i.querySelector(".confirm-ok-btn").onclick=()=>{R("global-confirm-modal"),typeof s=="function"&&s()};const r=i.querySelector(".confirm-cancel-btn");r&&(r.onclick=()=>R("global-confirm-modal")),z("global-confirm-modal")}const Wa=Object.freeze(Object.defineProperty({__proto__:null,showConfirm:En},Symbol.toStringTag,{value:"Module"}));let re=null;function wn(){if(v().categories.length===0){A(async()=>{const{showConfirm:t}=await Promise.resolve().then(()=>Wa);return{showConfirm:t}},void 0).then(({showConfirm:t})=>{t({title:"No Categories",message:"You need to create at least one category before adding habits. Would you like to create a category now?",okText:"Create Category",cancelText:"Cancel",onOK:()=>{A(()=>import("./categories-DPpWsi8d.js"),__vite__mapDeps([4,1])).then(n=>{n.initializeCategories(),n.openAddCategoryModal()})}})});return}re=null,kn();const e=document.getElementById("delete-habit-btn");e&&e.classList.add("hidden"),z("add-habit-modal")}function at(){R("add-habit-modal"),re=null}function Ka(e){var i;const t=v().habits.find(o=>o.id===e);if(!t)return;re=e,kn();const n=Qa();n&&n.classList.remove("hidden"),document.getElementById("habit-modal-title").textContent="Edit Habit",document.getElementById("habit-modal-desc").textContent="Update habit details",document.getElementById("habit-name-input").value=t.name,document.getElementById("frequency-select").value=t.frequency;const a=document.getElementById("frequency-select");if(a){const o=typeof t.target=="number"&&t.target>0;a.value=o?"daily":t.frequency}if(t.days){const o=t.frequency==="biweekly"?Ee:xe;t.days.forEach(r=>o.add(r)),document.querySelectorAll(".day-button").forEach(r=>{t.days.includes(parseInt(r.dataset.day,10))&&r.classList.add("selected")})}if(t.monthly&&(Ve(t.monthly.mode||"each"),document.getElementById("month-interval-select").value=t.monthly.interval||1,t.monthly.mode==="each"&&t.monthly.dates?(t.monthly.dates.forEach(o=>ee.add(o)),document.querySelectorAll(".date-button").forEach(o=>{t.monthly.dates.includes(parseInt(o.dataset.date,10))&&o.classList.add("selected")})):t.monthly.mode==="on"&&t.monthly.combinations&&(t.monthly.combinations.forEach(o=>Z.add(o)),be())),t.months&&(t.months.forEach(o=>te.add(o)),document.querySelectorAll(".month-button").forEach(o=>{t.months.includes(parseInt(o.dataset.month,10))&&o.classList.add("selected")}),document.getElementById("year-interval-select").value=t.yearInterval||1),t.scheduledTime){document.getElementById("anytime-toggle").checked=!1;const[o,r]=t.scheduledTime.split(":");document.getElementById("hour-select").value=o,document.getElementById("minute-select").value=r,document.getElementById("selected-time").textContent=t.scheduledTime,document.getElementById("time-selection").classList.remove("hidden")}document.getElementById("pause-habit-toggle").checked=!!t.paused,document.getElementById("holidays-toggle").checked=!!t.activeOnHolidays,Dt(t.icon||"📋");const s=document.getElementById("selected-icon-display");if(s&&(s.textContent=et()),t.target){document.getElementById("completion-target-section").classList.remove("hidden"),document.getElementById("target-frequency-select").value=t.targetFrequency||t.frequency,document.getElementById("target-value-input").value=t.target,document.getElementById("target-unit-select").value=t.targetUnit||"none";const o=document.getElementById("default-increment-input");o&&(o.value=t.defaultIncrement||1),(i=document.getElementById("completion-target-tab"))==null||i.click()}A(()=>import("./categories-DPpWsi8d.js"),__vite__mapDeps([4,1])).then(o=>{o.populateCategoryDropdown();const r=document.getElementById("habit-category-select");r&&(r.value=t.categoryId,Re())}),Ue(),Pe(),setTimeout(()=>{var r;const o=(r=document.getElementById("frequency-select"))==null?void 0:r.value;if(o==="monthly"){const l=document.querySelectorAll(".date-button.selected"),d=document.getElementById("selected-dates-count");d&&(d.textContent=l.length)}if(o==="yearly"){const l=document.querySelectorAll(".month-button.selected"),d=document.querySelectorAll(".yearly-date-button.selected"),c=document.getElementById("selected-months-count"),u=document.getElementById("selected-yearly-dates-count");c&&(c.textContent=l.length),u&&(u.textContent=d.length)}},100),z("add-habit-modal")}function kn(){var t;document.getElementById("habit-modal-title").textContent="New Habit",document.getElementById("habit-modal-desc").textContent="Add a new habit to track your progress",document.getElementById("habit-name-input").value="",document.getElementById("habit-category-select").value="",document.getElementById("frequency-select").value="daily",document.getElementById("anytime-toggle").checked=!0,document.getElementById("time-selection").classList.add("hidden"),document.getElementById("selected-time").textContent="09:00",document.getElementById("hour-select").value="09",document.getElementById("minute-select").value="00",xe.clear(),Ee.clear(),ee.clear(),Z.clear(),te.clear(),oe.clear(),document.querySelectorAll(".day-button, .date-button, .month-button, .yearly-date-button").forEach(n=>n.classList.remove("selected")),be(),Ve("each"),document.getElementById("month-interval-select").value="1",document.getElementById("year-interval-select").value="1",document.getElementById("completion-target-section").classList.add("hidden"),document.getElementById("target-frequency-select").value="daily",document.getElementById("target-value-input").value="1",document.getElementById("target-unit-select").value="none",document.getElementById("default-increment-input").value="1",document.getElementById("pause-habit-toggle").checked=!1,document.getElementById("holidays-toggle").checked=!1,Dt("📋");const e=document.getElementById("selected-icon-display");if(e&&(e.textContent=et()),(t=document.getElementById("schedule-tab"))==null||t.click(),window._preselectCategoryId){const n=document.getElementById("habit-category-select");n&&(n.value=window._preselectCategoryId),window._preselectCategoryId=void 0}A(()=>import("./categories-DPpWsi8d.js"),__vite__mapDeps([4,1])).then(n=>n.populateCategoryDropdown())}function Sn(){var l,d,c;A(()=>import("./categories-DPpWsi8d.js"),__vite__mapDeps([4,1])).then(u=>u.populateCategoryDropdown()),Kn(),bn(),xn(),document.addEventListener("click",u=>{const p=u.target.closest(".new-habit-btn");if(p){if(u.preventDefault(),p.disabled)return;wn()}}),(l=document.getElementById("cancel-habit"))==null||l.addEventListener("click",at),(d=document.getElementById("save-habit"))==null||d.addEventListener("click",Ja);const e=document.getElementById("habit-name-input"),t=document.getElementById("habit-category-select");e==null||e.addEventListener("input",Re),t==null||t.addEventListener("change",Re),Fa(),za();function n(){var p,y;const u=((p=document.getElementById("anytime-toggle"))==null?void 0:p.checked)??!0;(y=document.getElementById("time-selection"))==null||y.classList.toggle("hidden",u)}(c=document.getElementById("anytime-toggle"))==null||c.addEventListener("change",n),n();const a=document.getElementById("schedule-tab"),s=document.getElementById("completion-target-tab"),i=document.getElementById("schedule-section"),o=document.getElementById("completion-target-section");function r(u){if(!a||!s||!i||!o)return;const p=["bg-white","dark:bg-gray-600","text-gray-900","dark:text-white","shadow-sm"],y=["text-gray-600","dark:text-gray-400"];u==="schedule"?(a.classList.add(...p),a.classList.remove(...y),s.classList.remove(...p),s.classList.add(...y),i.classList.remove("hidden"),o.classList.add("hidden")):(s.classList.add(...p),s.classList.remove(...y),a.classList.remove(...p),a.classList.add(...y),o.classList.remove("hidden"),i.classList.add("hidden"))}a==null||a.addEventListener("click",()=>r("schedule")),s==null||s.addEventListener("click",()=>r("target")),r("schedule"),Re(),Ba()}function Re(){const e=document.getElementById("save-habit"),t=document.getElementById("habit-name-input"),n=document.getElementById("habit-category-select");if(!e||!t||!n)return;const a=t.value.trim().length>0&&n.value!=="";e.disabled=!a,e.classList.toggle("opacity-50",!a)}function Xa(){var e,t,n,a,s,i,o,r,l,d;return{name:(e=document.getElementById("habit-name-input"))==null?void 0:e.value.trim(),categoryId:((t=document.getElementById("habit-category-select"))==null?void 0:t.value)||null,frequency:((n=document.getElementById("frequency-select"))==null?void 0:n.value)||"daily",anytime:((a=document.getElementById("anytime-toggle"))==null?void 0:a.checked)??!0,hour:((s=document.getElementById("hour-select"))==null?void 0:s.value)||"09",minute:((i=document.getElementById("minute-select"))==null?void 0:i.value)||"00",monthInterval:parseInt(((o=document.getElementById("month-interval-select"))==null?void 0:o.value)||"1",10),yearInterval:parseInt(((r=document.getElementById("year-interval-select"))==null?void 0:r.value)||"1",10),paused:((l=document.getElementById("pause-habit-toggle"))==null?void 0:l.checked)??!1,activeOnHolidays:((d=document.getElementById("holidays-toggle"))==null?void 0:d.checked)??!1,icon:et(),progress:{},skippedDates:[]}}async function Ja(){var l,d,c;const e=Xa();if(!e.name||!e.categoryId)return;const t=document.getElementById("completion-target-section"),n=document.getElementById("target-value-input"),a=t&&!t.classList.contains("hidden")&&n&&parseInt(n.value||"0",10)>0,s=document.getElementById("default-increment-input"),i=s?parseInt(s.value||"1",10):1,{getLocalMidnightISOString:o}=await A(async()=>{const{getLocalMidnightISOString:u}=await Promise.resolve().then(()=>ie);return{getLocalMidnightISOString:u}},void 0),r={id:Te(),name:e.name,categoryId:e.categoryId,frequency:e.frequency,createdAt:o(new Date),days:e.frequency==="weekly"?Array.from(xe):e.frequency==="biweekly"?Array.from(Ee):void 0,scheduledTime:e.anytime?null:`${e.hour}:${e.minute}`,monthly:e.frequency==="monthly"?{interval:e.monthInterval,mode:Oe,dates:Oe==="each"?Array.from(ee):void 0,combinations:Oe==="on"?Array.from(Z):void 0}:void 0,months:e.frequency==="yearly"?Array.from(te):void 0,yearInterval:e.frequency==="yearly"?e.yearInterval:void 0,completed:!1,paused:e.paused,activeOnHolidays:e.activeOnHolidays,icon:et(),progress:e.progress,skippedDates:e.skippedDates};a?(r.target=parseInt(((l=document.getElementById("target-value-input"))==null?void 0:l.value)||"1",10),r.targetFrequency=((d=document.getElementById("target-frequency-select"))==null?void 0:d.value)||void 0,r.targetUnit=((c=document.getElementById("target-unit-select"))==null?void 0:c.value)||"none",r.defaultIncrement=i,delete r.days,delete r.monthly,delete r.months,delete r.yearInterval):(delete r.target,delete r.targetFrequency,delete r.targetUnit,delete r.defaultIncrement),D(re?L.updateHabit(re,r):L.addHabit(r)),at(),Ze()}function Qa(){const e=document.getElementById("delete-habit-btn");return e?(e.dataset.listenerAttached||(e.addEventListener("click",Za),e.dataset.listenerAttached="true"),e):null}function Za(){re&&En({title:"Delete Habit?",message:"This habit will be permanently removed. This action cannot be undone.",okText:"Delete",onOK:()=>{D(L.deleteHabit(re)),at(),Ze()}})}const es=Object.freeze(Object.defineProperty({__proto__:null,closeAddHabitModal:at,initializeHabitsForm:Sn,openAddHabitModal:wn,openEditHabitModal:Ka},Symbol.toStringTag,{value:"Module"}));let ae=null;function ts(){if(document.getElementById("install-banner"))return;const e=document.createElement("div");e.id="install-banner",e.className="fixed inset-x-4 bottom-4 md:inset-x-auto md:right-4 md:bottom-4 z-50 flex items-center justify-between gap-4 px-4 py-3 rounded-xl shadow-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700";const t=document.createElement("span");t.className="text-sm font-medium text-gray-900 dark:text-gray-100",t.textContent="Add Healthy Habits Tracker to your Home Screen?";const n=document.createElement("div");n.className="flex items-center gap-2";const a=document.createElement("button");a.id="install-btn",a.className="px-3 py-1.5 rounded-lg text-sm font-semibold text-white bg-ios-blue hover:bg-ios-blue/90 focus:outline-none focus:ring-2 focus:ring-ios-blue/50",a.textContent="Install";const s=document.createElement("button");s.id="dismiss-install-btn",s.className="px-3 py-1.5 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-400/50",s.textContent="Not now",n.appendChild(a),n.appendChild(s),e.appendChild(t),e.appendChild(n),document.body.appendChild(e),a.addEventListener("click",async()=>{if(ae){e.remove(),ae.prompt();try{await ae.userChoice}finally{ae=null}}}),s.addEventListener("click",()=>{e.remove(),ae=null})}function ns(){const e=document.getElementById("install-banner");e&&e.remove()}function as(){"beforeinstallprompt"in window&&(window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),ae=e,ts()}),window.addEventListener("appinstalled",()=>{ns(),ae=null}))}function ss(e={}){const{title:t="",showBack:n=!1,extraButtons:a=[],callbacks:s={}}=e,i=document.createElement("div");i.className="app-header flex justify-between items-center h-11 px-4 sm:px-6 lg:px-8 border-b border-gray-200 dark:border-gray-700 border-opacity-50 w-full pt-1.5";let o="";if(n&&(o+=`
      <button class="back-btn bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 px-3 py-1.5 rounded-lg font-medium flex items-center gap-1.5">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        Back
      </button>
    `),t?o+=`<h1 class="app-title text-black dark:text-white text-[36px] font-extrabold leading-none flex items-end">${t}</h1>`:o+=`
      <div></div>
      <h1 class="app-title text-center flex-grow text-[36px] font-extrabold leading-none flex items-end">Fitness</h1>
      <div></div>
    `,a.length>0){const r=a.map(l=>`
      <button class="${l.className||"bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-300 px-3 py-1.5 rounded-lg font-medium flex items-center gap-1.5"}" data-button-id="${l.id||""}">
        ${l.icon||""}
        ${l.text||""}
      </button>
    `).join("");o+=r}if(i.innerHTML=o,n&&s.onBack){const r=i.querySelector(".back-btn");r&&r.addEventListener("click",s.onBack)}return a.forEach(r=>{if(r.id&&s[`on${r.id.charAt(0).toUpperCase()+r.id.slice(1)}`]){const l=i.querySelector(`[data-button-id="${r.id}"]`);l&&l.addEventListener("click",s[`on${r.id.charAt(0).toUpperCase()+r.id.slice(1)}`])}}),i}let q={isRunning:!1,elapsedSeconds:0,startTime:null,pausedTime:0},se=null,ze=null;function U(){return{...q}}function is(e){q.isRunning||(q.isRunning=!0,q.startTime=Date.now()-q.elapsedSeconds*1e3,se=setInterval(()=>{const t=Date.now();q.elapsedSeconds=Math.floor((t-q.startTime)/1e3),ze&&ze()},1e3),e&&e())}function In(e){q.isRunning&&(q.isRunning=!1,se&&(clearInterval(se),se=null),e&&e())}function os(e){q.isRunning&&In(),q.elapsedSeconds=0,q.startTime=null,q.pausedTime=0,e&&e()}function rs(e){ze=e}function ls(){q={isRunning:!1,elapsedSeconds:0,startTime:null,pausedTime:0},se&&(clearInterval(se),se=null),ze=null}function cs(e={}){const{type:t="habits",callbacks:n={}}=e,a=document.createElement("div");if(a.className="action-buttons flex gap-3 mb-1 px-4 pt-1",t==="habits"){a.innerHTML=`
      <button class="new-category-btn flex-1 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 py-2 px-4 rounded-xl font-medium flex items-center justify-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-5l-2-2H5a2 2 0 00-2 2z" stroke="currentColor" stroke-width="2"/>
        </svg>
        New Category
      </button>
      <button class="new-habit-btn flex-1 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 py-2 px-4 rounded-xl font-medium flex items-center justify-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M12 6v6m0 0v6m0-6h6m-6 0H6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        New Habit
      </button>
    `,a.querySelectorAll(".new-category-btn, .new-habit-btn").forEach(r=>{r.classList.add("font-semibold")});const s=a.querySelector(".new-category-btn"),i=a.querySelector(".new-habit-btn");s&&n.onNewCategory&&s.addEventListener("click",n.onNewCategory),i&&n.onNewHabit&&i.addEventListener("click",n.onNewHabit);const o=()=>{if(!i)return;const r=v().categories.length>0;i.disabled=!r,r?(i.classList.remove("opacity-50","cursor-not-allowed"),i.title=""):(i.classList.add("opacity-50","cursor-not-allowed"),i.title="Create a category first before adding habits")};o(),_e(()=>{o()})}else if(t==="fitness"){a.innerHTML=`
      <button id="new-activity-btn" class="flex-1 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 py-1.5 px-4 rounded-xl font-medium flex items-center justify-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M12 6v6m0 0v6m0-6h6m-6 0H6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        New Activity
      </button>
      <button id="start-timer-btn" class="flex-1 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 py-1.5 px-4 rounded-xl font-medium flex items-center justify-center gap-2">
        <span class="material-icons text-xl">schedule</span>
        Timer
      </button>
    `,a.querySelectorAll("#new-activity-btn, #start-timer-btn").forEach(o=>{o.classList.add("font-semibold")});const s=a.querySelector("#new-activity-btn"),i=a.querySelector("#start-timer-btn");s&&n.onNewActivity&&s.addEventListener("click",n.onNewActivity),i&&n.onTimer&&i.addEventListener("click",n.onTimer),ls(),rs(()=>{Rt(i)}),Rt(i)}return a}function Rt(e){if(!e)return;U().isRunning?(e.classList.remove("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"),e.classList.add("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300")):(e.classList.remove("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300"),e.classList.add("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"))}let J=!1,ue=0,fe=null,ge=!1,qe=!1;function ds(e,t,n){const a=document.createElement("div");a.className="search-container px-4",a.style.position="relative",a.innerHTML=`
    <div class="search-input relative border-2 border-gray-300 dark:border-gray-500 rounded-xl bg-gray-100 dark:bg-gray-700 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-400">
      <svg class="w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <input id="fitness-activity-search" type="text" placeholder="Search activities..." class="w-full pl-10 pr-10 py-3 bg-transparent text-gray-700 dark:text-gray-300 rounded-xl border-none outline-none focus:ring-0 transition-colors cursor-pointer placeholder-gray-500 dark:placeholder-gray-400" autocomplete="off" spellcheck="false">
      <button id="close-search-btn" class="absolute right-3 top-1/2 transform -translate-y-1/2 w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors hidden rounded-full hover:bg-gray-200 dark:hover:bg-gray-600">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M6 18L18 6M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>
  `;const s=a.querySelector("#fitness-activity-search"),i=a.querySelector("#close-search-btn"),o=l=>{if(l.preventDefault(),l.stopPropagation(),J&&qe){ge=!0,s.focus();return}ue++,fe&&clearTimeout(fe),fe=setTimeout(()=>{ue=0,ge=!1},400),ue===1?(J?(qe=!0,s.classList.add("temp-focus")):(qt(t),qe=!0,s.classList.add("temp-focus")),ge=!1,s.blur()):ue===2&&(ge=!0,s.classList.remove("temp-focus"),s.focus())},r=l=>{if(!ge&&(ue>0||s.classList.contains("temp-focus"))){l.preventDefault(),s.blur();return}J||qt(t)};return s.addEventListener("click",o),s.addEventListener("focus",r),s.addEventListener("input",l=>{const d=l.target.value;J&&e&&e(d)}),i&&i.addEventListener("click",l=>{l.stopPropagation(),l.preventDefault(),s.value="",rt(n)}),document.addEventListener("click",l=>{var d;if(J&&!s.contains(l.target)&&!((d=document.querySelector("#activities-search-section"))!=null&&d.contains(l.target))){if(l.target.closest(".modal")||l.target.closest("[data-modal]")||l.target.closest(".modal-backdrop")||l.target.closest(".modal-content")||l.target.closest(".color-picker")||l.target.closest(".color-option")||l.target.closest("[data-color]"))return;rt(n)}}),s.addEventListener("keydown",l=>{if(l.key==="Escape")rt(n),s.blur();else if(l.key==="ArrowDown"&&J){l.preventDefault();const d=document.querySelector("#activities-search-section .search-activity-item");d&&d.focus()}}),a}function qt(e){const t=document.getElementById("close-search-btn"),n=document.getElementById("fitness-view");t&&t.classList.remove("hidden"),n&&n.classList.add("search-expanded"),J=!0,e&&e()}function rt(e){const t=document.getElementById("close-search-btn"),n=document.getElementById("fitness-activity-search"),a=document.getElementById("fitness-view");t&&t.classList.add("hidden"),a&&a.classList.remove("search-expanded"),n&&n.value!==""&&(n.value=""),n&&n.classList.remove("temp-focus"),ue=0,ge=!1,qe=!1,fe&&(clearTimeout(fe),fe=null),J=!1,e&&e()}function We(){const e=document.getElementById("fitness-activity-search");return e?e.value:""}function Ke(){return J}function us(){const e=document.createElement("div");return e.id="activities-search-section",e.className="activities-search-section hidden",e.innerHTML=`
    <div class="activities-search-content">
      <!-- Content will be populated dynamically -->
    </div>
  `,e}function gs(){const e=document.getElementById("activities-search-section");if(!e)return;e.classList.remove("hidden"),e.offsetHeight,e.classList.add("expanded");const a=window.innerHeight-83-40,s=e.querySelector(".activities-search-content");s&&(s.style.maxHeight=`${a}px`)}function ys(){const e=document.getElementById("activities-search-section");e&&(e.classList.remove("expanded"),setTimeout(()=>{e.classList.add("hidden")},400))}function ms(e){const t=document.querySelector("#activities-search-section .activities-search-content");t&&(t.innerHTML=e)}function fs(){return document.querySelector("#activities-search-section .activities-search-content")}function ps(e){return e.split("_").map(t=>j(t)).join(" ")}function Dn(e){return`<div class="muscle-header pl-3 py-1 text-sm font-semibold text-gray-700 dark:text-gray-300">${ps(e)}</div>`}function $e(e,t=null,n=null){const a=`search-category-${e.id}`,s=`
    <button class="search-expand-btn h-5 w-5 flex items-center justify-center text-black" data-category-id="${e.id}">
      <span class="material-icons transition-transform leading-none">expand_more</span>
    </button>
  `,i=`
    <button class="search-edit-category-btn w-8 h-8 rounded-full flex items-center justify-center ml-2" data-category-id="${e.id}" style="background-color:${e.color}">
      <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke="currentColor" stroke-width="2"/>
        <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2"/>
      </svg>
    </button>
  `;let o="";return n?o=Object.entries(n).map(([r,l])=>`
      <div class="muscle-group mb-2">
        ${Dn(r)}
        <div class="category-activities pl-6">
          ${l.map(d=>Ft(d,e)).join("")}
        </div>
      </div>
    `).join(""):t&&(o=`
      <div class="category-activities pl-6">
        ${t.map(r=>Ft(r,e)).join("")}
      </div>
    `),`
    <div class="search-category-section mb-4" data-category-id="${e.id}" id="${a}">
      <div class="search-category-header-wrapper flex items-center">
        <div class="search-category-header flex items-center justify-between px-4 py-1 rounded-t-xl cursor-pointer select-none flex-grow" style="background:${e.color}20;">
          <div class="category-title flex items-center gap-2">
            <span class="text-lg" aria-hidden="true">${e.icon}</span>
            <span class="font-semibold text-gray-900 dark:text-white">${e.name}</span>
          </div>
          ${s}
        </div>
        <div class="-ml-2">${i}</div>
      </div>
      <div class="search-category-content">
        ${o}
      </div>
    </div>
  `}function Ft(e,t){return`
    <div style="margin-bottom: 0.25rem;">
      <div class="search-activity-item activity-card flex items-center px-3 py-2 rounded-xl w-full transition-colors focus:outline-none focus:ring-2 focus:ring-ios-blue focus:ring-offset-2 dark:focus:ring-offset-gray-800" style="border: 3px solid ${t.color}; background-color: ${Qe(t.color,.05)};" data-activity-id="${e.id}">
        <div class="activity-icon w-9 h-9 flex-shrink-0 rounded-full flex items-center justify-center mr-3 text-xl" style="border: 2px solid ${t.color}; color: ${t.color};" aria-hidden="true">
          ${e.icon||t.icon}
        </div>
        <div class="activity-content flex-grow text-left">
          <div class="activity-name font-semibold leading-tight text-gray-900 dark:text-white">${e.name}</div>
        </div>
        <div class="activity-actions flex items-center gap-2 ml-3">
          <button class="stats-btn w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-600 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors" data-activity-id="${e.id}" title="View Stats">
            <span class="material-icons text-lg">bar_chart</span>
          </button>
          <button class="edit-activity-btn w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors" data-activity-id="${e.id}" title="Edit Activity">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke="currentColor" stroke-width="2"/>
              <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  `}function Nt(e){const t=document.querySelector(`#search-category-${e}`);if(!t)return;const n=t.querySelector(".search-category-content"),a=t.querySelector(".search-expand-btn .material-icons");if(!n||!a)return;t.classList.contains("collapsed")?(n.style.maxHeight="0px",n.style.overflow="hidden",n.classList.remove("hidden"),n.offsetHeight,n.style.maxHeight=n.scrollHeight+"px",a.style.transform="rotate(0deg)",t.classList.remove("collapsed"),setTimeout(()=>{t.classList.contains("collapsed")||(n.style.maxHeight="",n.style.overflow="")},300)):(n.style.maxHeight=n.scrollHeight+"px",n.style.overflow="hidden",n.offsetHeight,n.style.maxHeight="0px",a.style.transform="rotate(-90deg)",t.classList.add("collapsed"),setTimeout(()=>{t.classList.contains("collapsed")&&n.classList.add("hidden")},300))}function hs(e,t){e&&(e.querySelectorAll(".search-expand-btn").forEach(n=>{n.addEventListener("click",a=>{a.stopPropagation(),Nt(n.dataset.categoryId)})}),e.querySelectorAll(".search-category-header").forEach(n=>{n.addEventListener("click",a=>{if(a.target.closest(".search-expand-btn")||a.target.closest(".search-edit-category-btn"))return;const s=n.closest(".search-category-section").dataset.categoryId;Nt(s)})}),e.querySelectorAll(".search-edit-category-btn").forEach(n=>{n.addEventListener("click",a=>{a.stopPropagation(),t&&t(n)})}))}function vs(e,t,n,a){e&&(e.querySelectorAll(".stats-btn").forEach(s=>{s.addEventListener("click",i=>{i.stopPropagation(),n&&n(s.dataset.activityId)})}),e.querySelectorAll(".edit-activity-btn").forEach(s=>{s.addEventListener("click",i=>{i.stopPropagation(),a&&a(s.dataset.activityId)})}),e.querySelectorAll(".search-activity-item").forEach(s=>{s.addEventListener("click",i=>{if(i.target.closest(".activity-actions"))return;const o=s.dataset.activityId;t&&t(o)})}))}function bs(e){const t=document.querySelectorAll("#activities-search-section .search-activity-item");t.forEach((n,a)=>{n.setAttribute("tabindex","0"),n.addEventListener("keydown",s=>{switch(s.key){case"ArrowDown":s.preventDefault();const i=t[a+1];i&&i.focus();break;case"ArrowUp":if(s.preventDefault(),a===0){const r=document.getElementById("fitness-activity-search");r&&r.focus()}else{const r=t[a-1];r&&r.focus()}break;case"Enter":case" ":s.preventDefault(),n.click();break;case"Escape":s.preventDefault(),e&&e();const o=document.getElementById("fitness-activity-search");o&&o.focus();break}}),n.addEventListener("focus",()=>{n.style.outline="2px solid #3B82F6",n.style.outlineOffset="2px"}),n.addEventListener("blur",()=>{n.style.outline="",n.style.outlineOffset=""})})}function xs(e,t){const n=e.dataset.categoryId,a=document.querySelector(".category-color-picker");a&&a.remove();const s=document.createElement("div");s.className="category-color-picker bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700",s.style.cssText=`
    position: absolute;
    z-index: 1000;
    border-radius: 12px;
    padding: 12px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    width: 180px;
    max-width: 180px;
  `;const i=[{hex:"#ef4444",gradient:"from-red-500 to-red-600",shadow:"hover:shadow-red-500/25"},{hex:"#f97316",gradient:"from-orange-500 to-orange-600",shadow:"hover:shadow-orange-500/25"},{hex:"#eab308",gradient:"from-yellow-500 to-yellow-600",shadow:"hover:shadow-yellow-500/25"},{hex:"#22c55e",gradient:"from-green-500 to-green-600",shadow:"hover:shadow-green-500/25"},{hex:"#06b6d4",gradient:"from-cyan-500 to-cyan-600",shadow:"hover:shadow-cyan-500/25"},{hex:"#3b82f6",gradient:"from-blue-500 to-blue-600",shadow:"hover:shadow-blue-500/25"},{hex:"#8b5cf6",gradient:"from-violet-500 to-violet-600",shadow:"hover:shadow-violet-500/25"},{hex:"#ec4899",gradient:"from-pink-500 to-pink-600",shadow:"hover:shadow-pink-500/25"},{hex:"#64748b",gradient:"from-slate-500 to-slate-600",shadow:"hover:shadow-slate-500/25"},{hex:"#374151",gradient:"from-gray-700 to-gray-800",shadow:"hover:shadow-gray-500/25"},{hex:"#7c2d12",gradient:"from-red-900 to-red-950",shadow:"hover:shadow-red-900/25"},{hex:"#166534",gradient:"from-green-800 to-green-900",shadow:"hover:shadow-green-800/25"}],o=e.style.backgroundColor,r=ws(o);i.forEach(({hex:p,gradient:y,shadow:k})=>{const f=document.createElement("button");f.className=`color-option w-10 h-10 rounded-xl bg-gradient-to-br ${y} shadow-lg hover:scale-110 transition-all duration-200 ${k}`,p===r&&f.classList.add("ring-2","ring-black","dark:ring-white","ring-offset-2","ring-offset-white","dark:ring-offset-gray-800"),f.addEventListener("click",()=>{t&&t(n,p,e),s.remove()}),s.appendChild(f)});const l=e.getBoundingClientRect(),d=document.querySelector("#activities-search-section"),c=d.getBoundingClientRect();s.style.top=`${l.top-c.top}px`,s.style.right=`${c.right-l.left+8}px`,d.appendChild(s);const u=p=>{!s.contains(p.target)&&p.target!==e&&(s.remove(),document.removeEventListener("click",u))};setTimeout(()=>{document.addEventListener("click",u)},100)}function Es(e,t){e.style.backgroundColor=t}function ws(e){if(!e)return"";if(e.startsWith("#"))return e;const t=e.match(/\d+/g);if(!t||t.length<3)return"";const n=parseInt(t[0]),a=parseInt(t[1]),s=parseInt(t[2]);return`#${((1<<24)+(n<<16)+(a<<8)+s).toString(16).slice(1)}`}async function ks(e){var a;const{getLocalMidnightISOString:t}=await A(async()=>{const{getLocalMidnightISOString:s}=await Promise.resolve().then(()=>ie);return{getLocalMidnightISOString:s}},void 0),n={id:Te(),name:e.name,categoryId:e.categoryId,icon:e.icon||((a=v().activityCategories.find(s=>s.id===e.categoryId))==null?void 0:a.icon)||"🎯",createdAt:t(new Date),...e};return D(L.addActivity(n)),n}function Ss(e,t,n={}){const a=v().activities.find(o=>o.id===e);if(!a)return null;const s=t.slice(0,10),i={id:Te(),activityId:e,activityName:a.name,categoryId:a.categoryId,date:s,timestamp:new Date().toISOString(),duration:n.duration||null,intensity:n.intensity||null,notes:n.notes||"",...n};return D(L.recordActivity(e,t,n)),i}function Is(e){const t=e.slice(0,10);return v().recordedActivities[t]||[]}function Ds(){const e={};return v().activityCategories.forEach(t=>{e[t.id]={category:t,activities:v().activities.filter(n=>n.categoryId===t.id)}}),e}function Ls(e){if(!e||e.trim()==="")return v().activities;const t=e.toLowerCase().trim();return v().activities.filter(n=>n.name.toLowerCase().includes(t))}function Gt(e,t){const n=t.slice(0,10);D((a,s)=>{const o={...s().recordedActivities};o[n]&&(o[n]=o[n].filter(r=>r.id!==e),o[n].length===0&&delete o[n]),a(L.importData({recordedActivities:o}))})}function Ts(e,t,n={}){const a=t.slice(0,10);D((s,i)=>{const r={...i().recordedActivities};if(r[a]){const l=r[a].findIndex(d=>d.id===e);l!==-1&&(r[a][l]={...r[a][l],...n})}s(L.importData({recordedActivities:r}))})}function De(e){return v().activityCategories.find(t=>t.id===e)}function V(e){return v().activities.find(t=>t.id===e)}function mt(e){const t={};return e.forEach(n=>{let a=n.muscleGroup;if(!a&&n.activityId){const s=V(n.activityId);a=s==null?void 0:s.muscleGroup}a||(a="Other"),t[a]||(t[a]=[]),t[a].push(n)}),t}function _s(e){D(L.deleteActivity(e))}function As(e,t){D(L.updateActivity(e,t))}function Cs(e={}){const t=document.createElement("div");t.className="search-panel";const n=ds(Bs,Ms,Lt),a=us();n.appendChild(a),t.appendChild(n),t._callbacks=e;const s=_e(()=>{if(Ke()){const i=We();Le(i)}});return t._unsubscribe=s,document.addEventListener("ActivityDeleted",()=>{if(Ke()){const i=We();Le(i)}}),Ps(),t}function Bs(e){Le(e)}function Ms(){gs();const e=We();Le(e)}function Lt(){ys()}function Le(e=""){let t="";if(e.trim()===""){const n=Ds();Object.values(n).forEach(({category:a,activities:s})=>{if(s.length!==0)if(a.id==="strength"){const i=mt(s);t+=$e(a,null,i)}else t+=$e(a,s)})}else{const n=Ls(e);if(n.length>0){const a={};n.forEach(s=>{const i=De(s.categoryId);a[i.id]||(a[i.id]={category:i,activities:[]}),a[i.id].activities.push(s)}),Object.values(a).forEach(({category:s,activities:i})=>{if(s.id==="strength"){const o=mt(i);t+=$e(s,null,o)}else t+=$e(s,i)})}}t===""&&(e.trim()===""?t=`
        <div class="flex flex-col items-center justify-center py-8 text-center space-y-2">
          <span class="material-icons text-4xl text-gray-400">fitness_center</span>
          <p class="text-gray-600 dark:text-gray-400">No activities available</p>
          <p class="text-sm text-gray-500">Tap "New Activity" to create your first activity</p>
        </div>
      `:t=`
        <div class="flex flex-col items-center justify-center py-8 text-center space-y-2">
          <span class="material-icons text-4xl text-gray-400">search_off</span>
          <p class="text-gray-600 dark:text-gray-400">No activities found</p>
          <p class="text-sm text-gray-500">Try a different search term or create a new activity</p>
        </div>
      `),ms(t),$s()}function $s(){const e=fs();if(!e)return;const t=document.querySelector(".search-panel"),n=(t==null?void 0:t._callbacks)||{};hs(e,Hs),vs(e,n.onActivityClick,n.onStatsClick,n.onEditClick),bs(Lt)}function Hs(e){xs(e,(t,n,a)=>{Os(t,n),Es(a,n)})}function Os(e,t){if(D(L.updateActivityCategoryColor(e,t)),Ke()){const n=We();Le(n)}}function Ps(){document.addEventListener("modalClosed",e=>{var a;const t=(a=e.detail)==null?void 0:a.modalId;["activity-stats-modal"].includes(t)&&Ke()&&Lt()})}function Rs(e,{instant:t=!1}={}){if(!e)return;const n=e.parentElement;requestAnimationFrame(()=>requestAnimationFrame(()=>{const a=e.offsetLeft-(n.clientWidth-e.clientWidth)/2,s=n.scrollWidth-n.clientWidth;let i=Math.max(0,Math.min(a,s));a<0&&e.offsetLeft<n.clientWidth/2&&(i=0),n.scrollTo({left:i,behavior:t?"auto":"smooth"})}))}function jt(e,t,n){Rs(e.querySelector(t),n)}const Yt="fitnessRestDays";try{const e=localStorage.getItem(Yt);if(e&&typeof e=="string"){const t=JSON.parse(e);Array.isArray(t)&&D((n,a)=>{const i={...a().restDays};t.forEach(o=>{i[o]=!0}),n(L.importData({restDays:i}))}),localStorage.removeItem(Yt)}}catch{}function ft(e){var t;return!!((t=v().restDays)!=null&&t[e])}function hi(e){D((t,n)=>{const s={...n().restDays};s[e]?delete s[e]:s[e]=!0,t(L.importData({restDays:s}))})}function qs({container:e,stateKey:t="currentDate",onDateChange:n}={}){if(!e)throw new Error("[calendar] mountCalendar: container is required");const a={};let s=e.querySelector(".week-days");s||(s=document.createElement("div"),s.className="week-days",e.appendChild(s));let i;const o=new Promise(b=>{i=b});function r(){return new Date(v()[t])}function l(b){D(t==="fitnessSelectedDate"?L.setFitnessSelectedDate(Q(b)):L.setSelectedDate(Q(b))),typeof n=="function"&&n(b)}function d(b){jt(s,".day-item.current-day",{instant:!1})}function c({instant:b=!1}={}){s.querySelector(".day-item.current-day")&&jt(s,".day-item.current-day",{instant:b})}function u(b){l(b),y(),c({instant:!0})}function p(){s.innerHTML="";const b=r(),h=t==="fitnessSelectedDate"?"daily":v().selectedGroup||"daily";function g(){if(t==="fitnessSelectedDate"){const M=r();return M&&!isNaN(M)?new Date(M):new Date}return(v().habits||[]).reduce((M,B)=>{let ne=null;if(B.createdAt)ne=new Date(B.createdAt);else if(typeof B.id=="string"&&/^\d{13}/.test(B.id)){const we=parseInt(B.id.slice(0,13),10);if(!Number.isNaN(we)){const K=new Date(we);ne=new Date(K.getFullYear(),K.getMonth(),K.getDate())}}return!M||ne&&ne<M?ne:M},null)||new Date}const S=g(),w=Vt(S,h);a[h]=new Date(w);const I=new Date(a[h]),T={daily:t==="fitnessSelectedDate"?270:180,weekly:156,monthly:36,yearly:40}[h]||180;let C=new Date(I);for(let O=0;O<T;O++){const M=t==="fitnessSelectedDate"?He(C,"daily"):He(C),B=document.createElement("div");B.className="day-item",h==="yearly"&&(B.style.paddingTop="16px",B.style.paddingBottom="16px"),B.dataset.date=Q(C),B.innerHTML=`<span class="day-name block text-xs">${M.name}</span>
                      <span class="day-number block text-lg font-semibold">${M.number}</span>
                      <span class="day-month text-xs mt-0.5 ${M.month?"":"hidden"}">${M.month}</span>`;const ne=ye(C,new Date,h),we=ye(C,b,h);if(we?B.classList.add("current-day"):ne&&B.classList.add("today"),Ut(B,h,we),t!=="fitnessSelectedDate"){const K=h==="daily"&&Ie(Y(C));B.classList.toggle("holiday",K);const ce=!!B.querySelector(".holiday-icon");K&&!ce?B.insertAdjacentHTML("beforeend",'<span class="material-icons holiday-icon">flight</span>'):!K&&ce&&B.querySelector(".holiday-icon").remove()}if(t==="fitnessSelectedDate"){const K=Se(C),ce=ft(K);B.classList.toggle("rest-day",ce);const st=B.querySelector(".rest-icon");ce&&!st?B.insertAdjacentHTML("beforeend",'<span class="material-icons rest-icon block mt-0.5 text-lg">bed</span>'):!ce&&st&&st.remove()}s.appendChild(B),en(C,h,1)}s.scrollLeft=0;const $=s.querySelector(".day-item");if($){let O=e.getBoundingClientRect().width;!O&&e.parentElement&&(O=e.parentElement.getBoundingClientRect().width),!O&&typeof window<"u"&&(O=window.innerWidth);const M=$.getBoundingClientRect().width;s.style.paddingLeft=`${Math.max(0,O/2-M/2)}px`}}function y(){const b=t==="fitnessSelectedDate"?"daily":v().selectedGroup||"daily";s.querySelectorAll(".day-item").forEach(h=>{const g=new Date(h.dataset.date),S=ye(g,r(),b),w=ye(g,new Date,b);h.classList.toggle("current-day",S),h.classList.toggle("today",w&&!S);const I=t==="fitnessSelectedDate"?He(new Date(h.dataset.date),"daily"):He(new Date(h.dataset.date)),_=h.querySelector(".day-name"),T=h.querySelector(".day-number"),C=h.querySelector(".day-month");if(_&&(_.textContent=I.name,_.style.display=I.name?"":"none"),T&&(T.textContent=I.number),C&&(C.textContent=I.month,C.style.display=I.month?"":"none"),b==="daily"&&C&&(g.getDate()===1||S||w?(C.textContent=new Date(g).toLocaleString("en-US",{month:"short"}),C.style.display=""):C.style.display="none"),t!=="fitnessSelectedDate"){const $=b==="daily"&&Ie(Y(g));h.classList.toggle("holiday",$);const O=!!h.querySelector(".holiday-icon");$&&!O?h.insertAdjacentHTML("beforeend",'<span class="material-icons holiday-icon">flight</span>'):!$&&O&&h.querySelector(".holiday-icon").remove()}if(t==="fitnessSelectedDate"){const $=Se(g),O=ft($);h.classList.toggle("rest-day",O);const M=h.querySelector(".rest-icon");O&&!M?h.insertAdjacentHTML("beforeend",'<span class="material-icons rest-icon block mt-0.5 text-lg">bed</span>'):!O&&M&&M.remove()}if(b==="yearly"){const $=S?22:16;h.style.paddingTop=$+"px",h.style.paddingBottom=$+"px"}Ut(h,b,S)})}function k(b){const h=b.target.closest(".day-item");if(!h)return;const g=new Date(h.dataset.date);l(g),y(),d()}async function f(){p(),y(),await document.fonts.ready,await new Promise(b=>setTimeout(b,50)),i(),c({instant:!0})}f(),s.addEventListener("click",k),e.querySelectorAll(".nav-arrow").forEach(b=>{b.addEventListener("click",()=>{let h=r();const g=t==="fitnessSelectedDate"?"daily":v().selectedGroup||"daily",S=b.classList.contains("prev-week"),w=b.classList.contains("next-week");if(S||w){const T=S?-1:1;switch(g){case"weekly":h.setDate(h.getDate()+T*28);break;case"monthly":h.setMonth(h.getMonth()+T*6);break;case"yearly":h.setFullYear(h.getFullYear()+T*5);break;case"daily":default:h.setDate(h.getDate()+T*7);break}}else if(b.classList.contains("prev-day")||b.classList.contains("next-day")){const T=b.classList.contains("prev-day")?-1:1;if(t==="fitnessSelectedDate")h.setDate(h.getDate()+T);else switch(g){case"weekly":h.setDate(h.getDate()+T*7);break;case"monthly":h.setMonth(h.getMonth()+T);break;case"yearly":h.setFullYear(h.getFullYear()+T);break;case"daily":default:h.setDate(h.getDate()+T)}}const I=a[g]?new Date(a[g]):null;I&&h<I&&(h=new Date(I)),l(h),y(),s.querySelector(".day-item.current-day")&&d()})});const E=e.querySelector(".today-btn");E&&E.addEventListener("click",()=>{l(new Date),y(),s.querySelector(".day-item.current-day")&&d()});let m=t==="fitnessSelectedDate"?"daily":v().selectedGroup;return document.addEventListener("visibilitychange",()=>{document.hidden||c({instant:!0})}),{ready:o,setDate:u,scrollToSelected:c,destroy:()=>{s.removeEventListener("click",k)},refresh:()=>{if(t==="fitnessSelectedDate")parseFloat(s.style.paddingLeft||"0")||p(),y(),s.querySelector(".day-item.current-day")&&d();else{const b=v().selectedGroup;if(b!==m){const g=(v().habits||[]).reduce((S,w)=>{let I=null;if(w.createdAt)I=new Date(w.createdAt);else if(typeof w.id=="string"&&/^\d{13}/.test(w.id)){const _=parseInt(w.id.slice(0,13),10);if(!Number.isNaN(_)){const T=new Date(_);I=new Date(T.getFullYear(),T.getMonth(),T.getDate())}}return!S||I&&I<S?I:S},null)||new Date;a[b]=Vt(g,b),p(),m=b}y(),s.querySelector(".day-item.current-day")&&d()}}}}function He(e,t=null){const n=t||v().selectedGroup||"daily",a=e.getFullYear(),s=String(a).slice(-2),i=St[e.getMonth()];switch(n){case"weekly":return{name:String(a),number:`W${pe(e)}`,month:""};case"monthly":return{name:i,number:s,month:""};case"yearly":return{name:"",number:s,month:""};case"daily":default:return{name:fn[e.getDay()],number:e.getDate(),month:e.getDate()===1?i:""}}}function Vt(e,t=v().selectedGroup||"daily"){const n=new Date(e);switch(t){case"weekly":{const s=(n.getDay()+6)%7;return n.setDate(n.getDate()-s),n.setHours(0,0,0,0),n}case"monthly":return n.setDate(1),n.setHours(0,0,0,0),n;case"yearly":return n.setMonth(0,1),n.setHours(0,0,0,0),n;case"daily":default:return n.setHours(0,0,0,0),n}}function Ut(e,t,n=!1){if(e&&t!=="daily"){if(t==="weekly"){const a=n?16:12;e.style.paddingTop=a+"px",e.style.paddingBottom=a+"px";return}if(t==="monthly"){const a=n?16:12;e.style.paddingTop=a+"px",e.style.paddingBottom=a+"px";return}if(t==="yearly"){const a=n?"22px":"18px";e.style.paddingTop=a,e.style.paddingBottom=a}}}function vi(e){e.ready,e.setDate,e.scrollToSelected,typeof window<"u"&&(window._homeCalendarApi=e)}class Fs extends HTMLElement{constructor(){super(),this._api=null,this._readyPromise=new Promise(t=>this._resolveReady=t)}static get observedAttributes(){return["selected-key"]}connectedCallback(){if(this._initialised)return;this._initialised=!0;const t=document.createElement("div");t.className="week-calendar",this.appendChild(t);const n=this.getAttribute("state-key")||"currentDate";this._api=qs({container:t,stateKey:n,onDateChange:a=>{this.dispatchEvent(new CustomEvent("select",{detail:{date:a},bubbles:!0,composed:!0}))}}),this._api&&this._api.ready?this._api.ready.then(()=>{this._addNavigation(),this._resolveReady(),this._autoScrolled||(requestAnimationFrame(()=>{var a,s;(s=(a=this._api)==null?void 0:a.scrollToSelected)==null||s.call(a,{instant:!1})}),this._autoScrolled=!0)}):(this._addNavigation(),this._resolveReady())}_addNavigation(){var a;if(this.querySelector(".calendar-nav"))return;const t=this.querySelector(".week-days");if(!t)return;const n=document.createElement("div");n.className="calendar-nav flex justify-center items-center gap-4 lg:gap-6",n.innerHTML=`
      <button class="nav-arrow prev-week text-ios-blue p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors spring font-bold lg:p-3 lg:text-lg">‹‹</button>
      <button class="nav-arrow prev-day text-ios-blue p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors spring font-bold lg:p-3 lg:text-lg">‹</button>
      <button class="today-btn bg-ios-blue text-white rounded-full font-medium hover:bg-blue-600 transition-colors spring lg:px-6 lg:text-lg">Today</button>
      <button class="nav-arrow next-day text-ios-blue p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors spring font-bold lg:p-3 lg:text-lg">›</button>
      <button class="nav-arrow next-week text-ios-blue p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors spring font-bold lg:p-3 lg:text-lg">››</button>
    `,t.insertAdjacentElement("afterend",n),n.querySelectorAll(".nav-arrow").forEach(s=>{s.addEventListener("click",async()=>{var u,p;const i=this.getAttribute("state-key")||"currentDate";let o=new Date(v()[i]);const r=i==="fitnessSelectedDate"?"daily":v().selectedGroup||"daily",l=s.classList.contains("prev-week"),d=s.classList.contains("next-week");if(l||d){const y=l?-1:1;switch(r){case"weekly":o.setDate(o.getDate()+y*28);break;case"monthly":o.setMonth(o.getMonth()+y*6);break;case"yearly":o.setFullYear(o.getFullYear()+y*5);break;default:o.setDate(o.getDate()+y*7)}}else if(s.classList.contains("prev-day")||s.classList.contains("next-day")){const y=s.classList.contains("prev-day")?-1:1;if(i==="fitnessSelectedDate")o.setDate(o.getDate()+y);else switch(r){case"weekly":o.setDate(o.getDate()+y*7);break;case"monthly":o.setMonth(o.getMonth()+y);break;case"yearly":o.setFullYear(o.getFullYear()+y);break;default:o.setDate(o.getDate()+y)}}const{getLocalMidnightISOString:c}=await A(async()=>{const{getLocalMidnightISOString:y}=await Promise.resolve().then(()=>ie);return{getLocalMidnightISOString:y}},void 0);D(i==="fitnessSelectedDate"?L.setFitnessSelectedDate(c(o)):L.setSelectedDate(c(o))),(p=(u=this._api)==null?void 0:u.refresh)==null||p.call(u),requestAnimationFrame(()=>{var y,k;(k=(y=this._api)==null?void 0:y.scrollToSelected)==null||k.call(y,{instant:!1})})})}),(a=n.querySelector(".today-btn"))==null||a.addEventListener("click",async()=>{const s=new Date;await this.setDate(s,{smooth:!0})}),this._applyVirtualWindow(),this._setupResizeObserver()}_applyVirtualWindow(){const t=this.querySelector(".week-days");if(!t)return;const n=this.getAttribute("state-key")||"currentDate",a=new Date(v()[n]);if(isNaN(a))return;const s=n==="fitnessSelectedDate"?"daily":v().selectedGroup||"daily",o={daily:90,weekly:540,monthly:3650,yearly:36500}[s]||365,r=new Date(a);r.setDate(r.getDate()-o);const l=new Date(a);l.setDate(l.getDate()+o),t.querySelectorAll(".day-item").forEach(d=>{const c=new Date(d.dataset.date),u=c<r||c>l;d.style.display=u?"none":""})}_setupResizeObserver(){this.querySelector(".week-days")&&(this._ro||(this._ro=new ResizeObserver(()=>this._recalcPadding()),this._ro.observe(this)))}_recalcPadding(){const t=this.querySelector(".week-days");if(!t)return;const n=t.querySelector(".day-item");if(!n)return;let a=this.getBoundingClientRect().width;!a&&typeof window<"u"&&(a=window.innerWidth);const s=n.getBoundingClientRect().width;t.style.paddingLeft=`${Math.max(0,a/2-s/2)}px`}async setDate(t,{smooth:n=!1}={}){var i,o;const a=this.getAttribute("state-key")||"currentDate",{getLocalMidnightISOString:s}=await A(async()=>{const{getLocalMidnightISOString:r}=await Promise.resolve().then(()=>ie);return{getLocalMidnightISOString:r}},void 0);D(a==="fitnessSelectedDate"?L.setFitnessSelectedDate(s(t)):L.setSelectedDate(s(t))),(o=(i=this._api)==null?void 0:i.refresh)==null||o.call(i),this._applyVirtualWindow(),n&&requestAnimationFrame(()=>{var r,l;(l=(r=this._api)==null?void 0:r.scrollToSelected)==null||l.call(r,{instant:!1})})}refresh(){var t,n;(n=(t=this._api)==null?void 0:t.refresh)==null||n.call(t),this._applyVirtualWindow(),this._recalcPadding()}invalidate(){this.refresh()}get ready(){return this._readyPromise}scrollToSelected(t={}){var n,a;(a=(n=this._api)==null?void 0:n.scrollToSelected)==null||a.call(n,t)}disconnectedCallback(){var t,n;(n=(t=this._api)==null?void 0:t.destroy)==null||n.call(t)}}customElements.get("hh-calendar")||customElements.define("hh-calendar",Fs);let Fe=null;const P={ready:null,setDate:null,scrollToSelected:null,destroy:()=>{Fe&&(Fe.destroy(),Fe=null)}};function Ns(e){Fe=e,P.ready=e.ready,P.setDate=e.setDate,P.scrollToSelected=e.scrollToSelected}function Gs(e={}){var a,s;if(!document.getElementById("fitness-view"))return;const n=document.createElement("hh-calendar");return n.className="week-calendar overflow-x-auto no-scrollbar m-0 p-0",n.id="fitness-calendar",n.setAttribute("state-key","fitnessSelectedDate"),n.style.minHeight="120px",n.style.overflowY="visible",n.style.overflowX="auto",n.style.width="100%",n.addEventListener("select",i=>{typeof e.onDateChange=="function"&&e.onDateChange(i.detail.date)}),Ns(n),window.fitnessCalendarApi=n,typeof window<"u"&&((s=(a=n.ready)==null?void 0:a.then)==null||s.call(a,()=>{var i;return(i=n.refresh)==null?void 0:i.call(n)})),n}function js(){const e=document.querySelector("#fitness-view .search-container");if(!e)return 500;const t=e.getBoundingClientRect(),n=window.innerHeight,a=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--tab-bar-height").replace("px",""))||83,s=parseInt(getComputedStyle(document.documentElement).getPropertyValue("padding-bottom").replace("px",""))||0,i=t.bottom,o=n-i-a-s-20;return Math.max(300,Math.min(o,700))}function Ln(){if(typeof window>"u")return;const e=document.querySelector("#activities-list");if(!e)return;const t=e.getBoundingClientRect();let n=0;const a=document.querySelector("#fitness-view").closest(".content-area");if(a){const i=window.getComputedStyle(a);n=parseFloat(i.paddingBottom)||0}const s=window.innerHeight-t.top-n;s>0&&(e.style.maxHeight=s+"px",e.style.overflowY="auto")}function zt(){const e=document.querySelector("#activities-search-section .activities-search-content");if(!e)return;const a=window.innerHeight-83-40;e.style.maxHeight=`${a}px`}function Ys(e,t,n,{onRestore:a=()=>{}}={}){var k;let s=0,i=0,o=0,r=!1,l=0,d=null;function c(f){t.style.transform=`translateX(${f}px)`}function u(f){const E=f.touches?f.touches[0]:f;s=E.clientX,i=E.clientY,o=0,r=!1,l=e.offsetWidth*.2,d=f.pointerId!==void 0?f.pointerId:null,f.pointerId!==void 0&&t.setPointerCapture&&t.setPointerCapture(f.pointerId)}function p(f){if(d!==null&&f.pointerId!==d)return;const E=f.touches?f.touches[0]:f,m=E.clientX-s,b=E.clientY-i;if(!r)if(Math.abs(m)>12&&Math.abs(m)>Math.abs(b))r=!0,t.style.transition="none";else return;o=m,o>0&&(o=0),o<-l&&(o=-l),c(o)}function y(f){d!==null&&f.pointerId!==d||r&&(r=!1,t.style.transition="transform 0.2s",Math.abs(o)>l/2?c(-l):c(0),f.pointerId!==void 0&&t.releasePointerCapture&&t.releasePointerCapture(f.pointerId),d=null)}t.style.cursor="grab",t.style.touchAction="pan-y",t.addEventListener("pointerdown",u),t.addEventListener("pointermove",p),t.addEventListener("pointerup",y),t.addEventListener("touchmove",f=>{r&&f.preventDefault()},{passive:!1}),(k=e.querySelector(".restore-btn"))==null||k.addEventListener("click",()=>{a(),c(0)})}function Vs(e,t){return e.sets&&e.sets.length>0?Us(e,t):zs(e,t)}function Us(e,t){const n=e.sets.length,a=Math.ceil(n/2),s=[];for(let o=0;o<a;o++){s.push(o);const r=a+o;r<n&&s.push(r)}return`<div class="set-pills grid grid-cols-2 gap-1">${s.map(o=>{const r=e.sets[o];let l=`Set ${o+1}: ${r.reps} reps`;if(r.value&&r.unit&&r.unit!=="none"){let d="";r.unit==="seconds"?d="s":r.unit==="minutes"?d=" Mins":r.unit==="kg"?d="kg":d=r.unit,l+=` × ${r.value}${d}`}else r.value&&(l+=` × ${r.value}`);return`<span class="inline-block text-white text-xs px-2 py-1 rounded-lg mr-1 mb-1 font-medium" style="background-color: ${t.color};">${l}</span>`}).join("")}</div>`}function zs(e,t){let n=[];if(e.duration){const a=e.durationUnit||"minutes";let s="";a==="minutes"?s=e.duration>1?"Mins":"Min":a==="hours"?s=e.duration>1?"Hrs":"Hr":s="s",n.push(`<span class="inline-block text-white text-xs px-2 py-1 rounded-lg mr-1 mb-1 font-medium" style="background-color: ${t.color};">${e.duration} ${s}</span>`)}if(e.intensity){const a=e.intensity.charAt(0).toUpperCase()+e.intensity.slice(1);n.push(`<span class="inline-block text-white text-xs px-2 py-1 rounded-lg mr-1 mb-1 font-medium" style="background-color: ${t.color};">${a}</span>`)}return n.join("")}const lt={build(e,t,n={}){const a=new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),s=n.getActivity?n.getActivity(e.activityId):null,i=(s==null?void 0:s.icon)||t.icon,o=Vs(e,t);return`
      <div class="swipe-container relative overflow-visible" data-record-id="${e.id}">
        <button class="restore-btn absolute top-0 right-0 h-full bg-red-600 text-white font-semibold rounded-xl w-1/5 touch-manipulation" aria-label="Delete ${e.activityName} activity">Delete</button>
        <div class="swipe-slide transition-transform bg-white dark:bg-gray-800 rounded-xl w-full relative z-1 touch-pan-y">
          <div class="activity-card relative flex items-start px-3 py-2 rounded-xl w-full mb-0" style="border: 3px solid ${t.color}; background-color: ${Qe(t.color,.05)};">
            <div class="activity-icon w-9 h-9 flex-shrink-0 rounded-full flex items-center justify-center mr-3 text-xl" style="border: 2px solid ${t.color}; color: ${t.color};" aria-hidden="true">
              ${i}
            </div>
            <div class="activity-content flex-grow text-left">
              <div class="activity-name font-semibold leading-tight text-gray-900 dark:text-white mb-1">${e.activityName}</div>
              ${e.notes?`<div class="activity-notes text-xs text-gray-500 dark:text-gray-400 my-1 p-2 bg-gray-100 dark:bg-gray-700 rounded-lg w-fit max-w-full">${e.notes}</div>`:""}
              ${o}
            </div>
            <!-- Time placed absolutely so it doesn't restrict content width -->
            <div class="activity-meta absolute top-2 right-3 text-xs text-gray-500 dark:text-gray-400" aria-label="Activity recorded at ${a}">${a}</div>
          </div>
        </div>
      </div>
    `},bindEvents(e,t,n={}){e&&e.querySelectorAll(".swipe-container").forEach(a=>{const s=a.querySelector(".swipe-slide"),i=a.dataset.recordId,o=t.find(r=>r.id===i);if(s&&o){Ys(a,s,o,{onRestore:()=>{n.onActivityDelete&&n.onActivityDelete(i)}});const r=s.querySelector(".activity-card");r&&o.activityId&&(r.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),n.onActivityClick&&n.onActivityClick(o.activityId,o)}),r.style.cursor="pointer")}})}},Wt={build(e,t,n={}){if(t.length===0)return"";if(e.id==="strength"){const a=mt(t);return`
        <div class="category-group mb-4">
          <div class="category-header flex items-center gap-2 px-4 py-2 rounded-t-xl" style="background:${e.color}20;">
            <div class="category-title flex items-center gap-2">
              <span class="text-lg" aria-hidden="true">${e.icon}</span>
              <span class="font-semibold text-gray-900 dark:text-white">${e.name}</span>
            </div>
          </div>
          ${Object.entries(a).map(([s,i])=>`
            <div class="muscle-group mb-2">
              ${Dn(s)}
              <div class="category-activities pl-6">
                ${i.map(o=>lt.build(o,e,n)).join("")}
              </div>
            </div>
          `).join("")}
        </div>
      `}else return`
        <div class="category-group mb-4" style="overflow: visible;">
          <div class="category-header flex items-center gap-2 px-4 py-2 rounded-t-xl" style="background:${e.color}20;">
            <div class="category-title flex items-center gap-2">
              <span class="text-lg" aria-hidden="true">${e.icon}</span>
              <span class="font-semibold text-gray-900 dark:text-white">${e.name}</span>
            </div>
          </div>
          <div class="category-activities pl-6" style="overflow: visible;">
            ${t.map(a=>`<div style="margin-bottom: 0.25rem; overflow: visible;">${lt.build(a,e,n)}</div>`).join("")}
          </div>
        </div>
      `},bindEvents(e,t,n={}){e&&lt.bindEvents(e,t,n)}};function Ws(e){const t=document.createElement("div");return t.className="activities-container flex-grow overflow-y-auto px-4 pb-8",t.style.overflowX="visible",t.id="activities-list",t._onActivityClick=e,t}function pt(e){const t=document.getElementById("activities-list");if(!t)return;const n=v().fitnessSelectedDate||new Date().toISOString(),a=Se(n),s=ft(a),i=Is(a);if(i.length===0){s?t.innerHTML=`
        <div class="flex flex-col items-center justify-center py-20 text-center space-y-2">
          <span class="material-icons text-5xl text-orange-500">bed</span>
          <h2 class="text-lg font-bold text-gray-900 dark:text-white">Enjoy your rest day</h2>
        </div>
      `:t.innerHTML=`
        <div class="flex flex-col items-center justify-center py-20 text-center space-y-2">
          <span class="material-icons text-5xl text-gray-400">fitness_center</span>
          <h2 class="text-lg font-semibold text-gray-900 dark:text-white">No activities recorded</h2>
          <p class="text-sm text-gray-600 dark:text-gray-400">Tap "Record Activity" to log your fitness activities for this day.</p>
        </div>
      `;return}const o={};i.forEach(l=>{const d=De(l.categoryId);o[d.id]||(o[d.id]={category:d,records:[]}),o[d.id].records.push(l)});let r="";Object.values(o).forEach(({category:l,records:d})=>{d.length!==0&&(r+=Wt.build(l,d,{onActivityClick:e||t._onActivityClick,onActivityDelete:c=>{Gt(c,a),pt(e||t._onActivityClick)},getActivity:V}))}),t.innerHTML=r,Wt.bindEvents(t,i,{onActivityClick:e||t._onActivityClick,onActivityDelete:l=>{Gt(l,a),pt(e||t._onActivityClick)},getActivity:V}),Ln()}const Ks={update(){const e=document.getElementById("start-timer-btn");if(!e)return;U().isRunning?(e.classList.remove("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"),e.classList.add("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300")):(e.classList.remove("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300"),e.classList.add("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"))}},ke={_sessionLapTimes:[],clearLaps(){this._sessionLapTimes=[]},recordLap(){const e=U();if(!e.isRunning&&e.elapsedSeconds===0)return;const t=e.elapsedSeconds,n=this._sessionLapTimes.reduce((i,o)=>i+o.duration,0),a=t-n,s={number:this._sessionLapTimes.length+1,duration:a,totalTime:t,timestamp:new Date().toISOString()};this._sessionLapTimes.push(s),this.render()},deleteLap(e){e<0||e>=this._sessionLapTimes.length||(this._sessionLapTimes.splice(e,1),this._sessionLapTimes.forEach((t,n)=>{t.number=n+1}),this.render())},getCurrentLapTime(){const e=U(),t=this._sessionLapTimes.reduce((n,a)=>n+a.duration,0);return e.elapsedSeconds-t},getTotalSessionTime(){return U().elapsedSeconds},render(){const e=document.getElementById("lap-times-container"),t=document.getElementById("lap-times-list"),n=document.getElementById("total-session-time");if(!e||!t)return;if(n){const r=this.getTotalSessionTime();n.textContent=je(r)}if(this._sessionLapTimes.length===0){e.classList.add("hidden");return}e.classList.remove("hidden"),t.innerHTML="";const a=this._sessionLapTimes.length,s=Math.ceil(a/2),i=[];for(let r=0;r<s;r++){i.push(r);const l=s+r;l<a&&i.push(l)}const o=document.createElement("div");o.className="lap-times-grid grid grid-cols-2 gap-2",i.forEach(r=>{const l=this._sessionLapTimes[r],d=document.createElement("div");d.className="flex justify-between items-center py-2 px-3 bg-white dark:bg-gray-600 rounded-lg border border-gray-200 dark:border-gray-500",d.innerHTML=`
        <span class="text-sm font-medium text-gray-700 dark:text-gray-200">Lap ${l.number}</span>
        <div class="flex items-center gap-2">
          <span class="text-sm font-mono text-gray-900 dark:text-white">${je(l.duration)}</span>
          <button class="delete-lap-btn text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 p-1 rounded transition-colors" data-lap-index="${r}">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path d="M6 18L18 6M6 6l12 12" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
      `,o.appendChild(d)}),t.appendChild(o),setTimeout(()=>{if(t.scrollHeight>t.clientHeight){if(!t.querySelector(".scroll-fade")){const l=document.createElement("div");l.className="scroll-fade absolute bottom-0 left-0 right-0 h-6 bg-gradient-to-t from-gray-50 dark:from-gray-700 to-transparent pointer-events-none",t.appendChild(l)}}else{const l=t.querySelector(".scroll-fade");l&&l.remove()}},0)},bindEvents(){const e=document.getElementById("record-lap-btn");e&&e.addEventListener("click",()=>this.recordLap());const t=document.getElementById("lap-times-list");t&&t.addEventListener("click",n=>{if(n.target.closest(".delete-lap-btn")){n.stopPropagation();const a=n.target.closest(".delete-lap-btn"),s=parseInt(a.dataset.lapIndex);this.deleteLap(s)}})}},Kt={update(){const e=U(),t=document.getElementById("timer-start-stop-btn"),n=document.getElementById("record-lap-btn");if(t){const a=t.querySelector(".material-icons");e.isRunning?(a.textContent="pause",t.classList.remove("bg-ios-blue"),t.classList.add("bg-red-500")):(a.textContent="play_arrow",t.classList.remove("bg-red-500"),t.classList.add("bg-ios-blue"))}n&&(n.disabled=e.elapsedSeconds===0)},bindEvents(e){const t=document.getElementById("timer-start-stop-btn");t&&t.addEventListener("click",()=>{U().isRunning?In(()=>{e&&e(),ct()}):is(()=>{e&&e(),ct()})});const n=document.getElementById("timer-reset-btn");n&&n.addEventListener("click",()=>{os(()=>{ke.clearLaps(),e&&e(),ct()})})}};function ct(){const e=document.getElementById("start-timer-btn");if(!e)return;U().isRunning?(e.classList.remove("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"),e.classList.add("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300")):(e.classList.remove("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300"),e.classList.add("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"))}const dt={_updateInterval:null,open(){U().elapsedSeconds===0&&ke.clearLaps(),this.updateDisplay(),z("timer-modal"),this._startUpdateInterval()},close(){this._stopUpdateInterval();const e=document.getElementById("timer-modal");e&&e._escapeHandler&&(document.removeEventListener("keydown",e._escapeHandler),e._escapeHandler=null),this._updateTimerButton(),R("timer-modal")},_startUpdateInterval(){this._stopUpdateInterval(),this.updateDisplay(),this._updateInterval=setInterval(()=>{this.updateDisplay()},1e3)},_stopUpdateInterval(){this._updateInterval&&(clearInterval(this._updateInterval),this._updateInterval=null)},updateDisplay(){const e=U(),t=document.getElementById("timer-time-display"),n=document.getElementById("timer-status");if(t){const a=ke.getCurrentLapTime();t.textContent=je(a)}n&&(e.isRunning?n.textContent="Running...":e.elapsedSeconds>0?n.textContent="Paused":n.textContent="Ready to start"),Kt.update(),ke.render(),this._updateTimerButton()},_updateTimerButton(){const e=document.getElementById("start-timer-btn");if(!e)return;U().isRunning?(e.classList.remove("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"),e.classList.add("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300")):(e.classList.remove("bg-orange-100","dark:bg-orange-900","text-orange-600","dark:text-orange-300"),e.classList.add("bg-blue-100","dark:bg-blue-900","text-blue-600","dark:text-blue-300"))},bindEvents(){const e=document.getElementById("close-timer-modal");e&&e.addEventListener("click",()=>this.close()),Kt.bindEvents(()=>{this.updateDisplay()}),ke.bindEvents();const t=document.getElementById("timer-modal");t&&t.addEventListener("click",a=>{a.target===t&&this.close()});const n=a=>{if(a.key==="Escape"){const s=document.getElementById("timer-modal");s&&!s.classList.contains("hidden")&&this.close()}};document.addEventListener("keydown",n),t&&(t._escapeHandler=n)}},ht={updateButton(){Ks.update()},openModal(){dt.open()},closeModal(){dt.close()},bindEvents(){dt.bindEvents()}},X={async mount(e,t={}){if(!e)return null;e.innerHTML="";const n=ss({});e.appendChild(n);const a=cs({type:"fitness",callbacks:{onNewActivity:t.onNewActivity,onTimer:()=>ht.openModal()}});e.appendChild(a);const s=Cs({onActivityClick:t.onSearchActivityClick,onStatsClick:t.onStatsClick,onEditClick:t.onEditClick});e.appendChild(s);const i=this._buildCalendarWrapper(t.onDateChange);e.appendChild(i);const o=await A(()=>import("./RestToggle-CtrWkNZJ.js"),__vite__mapDeps([5,1])).then(l=>l.mountRestToggle(t.onRestToggle));e.appendChild(o);const r=Ws(t.onActivityClick);return e.appendChild(r),e},renderActivities(e){pt(e)},updateTimerButton(){ht.updateButton()},updateRestToggle(){A(async()=>{const{updateRestToggle:e}=await import("./RestToggle-CtrWkNZJ.js");return{updateRestToggle:e}},__vite__mapDeps([5,1])).then(({updateRestToggle:e})=>{e()})},_buildCalendarWrapper(e){const t=document.createElement("div");t.className="calendar-wrapper mb-2";const n=Gs(e);return t.appendChild(n),t},setupResponsiveBehavior(){typeof window<"u"&&(window.addEventListener("resize",()=>{Ln(),zt(),setTimeout(()=>{const e=document.querySelector("#activities-search-section .activities-search-content");if(e){const t=js();e.style.maxHeight=`${t}px`}},100)}),window.addEventListener("orientationchange",()=>{setTimeout(()=>{zt()},500)}))}},Xt={_validateForm:null,openAddMode(){this._setupEventHandlers();const e=document.getElementById("add-activity-form");e&&e.reset();const t=document.getElementById("delete-activity-btn");t&&t.classList.add("hidden");const n=document.querySelector("#add-activity-modal h2");n&&(n.textContent="New Activity");const a=document.getElementById("save-add-activity");a&&(a.textContent="Add");const s=document.getElementById("add-activity-modal");s&&(delete s.dataset.editActivityId,delete s.dataset.editMode),this._setSelectedActivityIcon("🏃‍♂️",!1),this._userManuallySelectedIcon=!1;let i=document.getElementById("activity-selected-icon-display");i&&(i.textContent=this._getSelectedActivityIcon());const o=document.getElementById("muscle-group-section"),r=document.getElementById("muscle-group-select");o&&o.classList.add("hidden"),r&&(r.value="");const l=document.getElementById("units-section"),d=document.getElementById("units-select");l&&l.classList.add("hidden"),d&&(d.value="none");const c=document.getElementById("activity-category-select");c&&(c.innerHTML='<option value="" disabled selected>Select a category</option>'+v().activityCategories.map(u=>`<option value="${u.id}">${u.icon} ${u.name}</option>`).join("")),z("add-activity-modal"),setTimeout(()=>{this._setupActivityIconPicker(),this._initializeTrackingTypeToggles(),this._setupFormValidation()},50),this._validateForm&&this._validateForm()},openEditMode(e){const t=V(e);if(!t){console.error("Activity not found:",e);return}const n=document.getElementById("add-activity-form");n&&n.reset();const a=document.getElementById("activity-name-input"),s=document.getElementById("activity-category-select"),i=document.getElementById("muscle-group-select"),o=document.getElementById("muscle-group-section");a&&(a.value=t.name),s&&(s.innerHTML='<option value="" disabled>Select a category</option>'+v().activityCategories.map(m=>`<option value="${m.id}" ${m.id===t.categoryId?"selected":""}>${m.icon} ${m.name}</option>`).join("")),t.categoryId==="strength"&&t.muscleGroup?(o&&o.classList.remove("hidden"),i&&(i.value=t.muscleGroup)):o&&o.classList.add("hidden");const r=t.icon||"🏃‍♂️",d=v().activityCategories.find(m=>m.id===t.categoryId),c=d&&r!==d.icon;this._setSelectedActivityIcon(r,c),this._userManuallySelectedIcon=c;const u=document.getElementById("activity-selected-icon-display");u&&(u.textContent=this._getSelectedActivityIcon());const p=t.trackingType||"time";if(this._setSelectedTrackingType(p),p==="sets-reps"){const m=document.getElementById("units-section"),b=document.getElementById("units-select");m&&m.classList.remove("hidden"),b&&(b.value=t.units||"none")}else{const m=document.getElementById("units-section"),b=document.getElementById("units-select");m&&m.classList.add("hidden"),b&&(b.value="none")}const y=document.getElementById("delete-activity-btn");y&&(y.classList.remove("hidden"),y.dataset.listenerAttached||(y.addEventListener("click",m=>{m.preventDefault(),this._handleDeleteActivity(e)}),y.dataset.listenerAttached="true"));const k=document.querySelector("#add-activity-modal h2");k&&(k.textContent="Edit Activity");const f=document.getElementById("save-add-activity");f&&(f.textContent="Update");const E=document.getElementById("add-activity-modal");E&&(E.dataset.editActivityId=e,E.dataset.editMode="true"),z("add-activity-modal"),setTimeout(()=>{this._setupEventHandlers(),this._setupActivityIconPicker(),this._initializeTrackingTypeToggles(),this._setupFormValidation()},50),this._validateForm&&this._validateForm()},_setupEventHandlers(){const e=document.getElementById("cancel-add-activity");e&&!e.dataset.listenerAttached&&(e.addEventListener("click",()=>{R("add-activity-modal")}),e.dataset.listenerAttached="true"),this._setupActivityIconPicker(),this._setupFormValidation()},_setupActivityIconPicker(){const e=document.getElementById("activity-icon-selector-btn"),t=document.getElementById("icon-selection-modal");let n=document.getElementById("activity-selected-icon-display");if(!e||!t||!n)return;const a=e.cloneNode(!0);e.parentNode.replaceChild(a,e),n=a.querySelector("#activity-selected-icon-display")||document.getElementById("activity-selected-icon-display"),a.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),this._buildActivityIconGrid(t),z("icon-selection-modal")}),t.addEventListener("click",l=>{l.target===t&&R("icon-selection-modal")});const i=document.getElementById("select-icon"),o=document.getElementById("cancel-icon"),r=()=>{t.querySelectorAll(".icon-option").forEach(l=>l.classList.remove("ring","ring-ios-blue","ring-2"))};t.addEventListener("click",l=>{const d=l.target.closest(".icon-option");if(!d)return;const c=d.dataset.icon||"🏃‍♂️";this._setSelectedActivityIcon(c,!0),n.textContent=c,r(),d.classList.add("ring","ring-ios-blue","ring-2"),i&&(i.disabled=!1)}),i&&i.addEventListener("click",()=>{n.textContent=this._getSelectedActivityIcon(),R("icon-selection-modal")}),o&&o.addEventListener("click",()=>{R("icon-selection-modal")})},_setupFormValidation(){const e=document.getElementById("add-activity-form"),t=document.getElementById("activity-name-input"),n=document.getElementById("activity-category-select"),a=document.getElementById("save-add-activity");this._validateForm=()=>{const i=t&&t.value.trim().length>0,o=n&&n.value,r=n&&n.value==="strength",l=document.getElementById("muscle-group-select"),d=!r||l&&l.value,c=i&&o&&d;a&&(a.disabled=!c,a.classList.toggle("opacity-50",a.disabled))},t&&t.addEventListener("input",this._validateForm),n&&(n.addEventListener("change",this._validateForm),n.addEventListener("change",()=>this._updateActivityIconFromCategory()),n.addEventListener("change",()=>this._initializeTrackingTypeToggles()),n.addEventListener("change",()=>this._handleMuscleGroupVisibility()));const s=document.getElementById("muscle-group-select");s&&s.addEventListener("change",this._validateForm),a&&!a.dataset.listenerAttached&&(a.addEventListener("click",i=>{i.preventDefault(),this._handleFormSubmit()}),a.dataset.listenerAttached="true"),e&&!e.dataset.listenerAttached&&(e.addEventListener("submit",i=>{i.preventDefault(),this._handleFormSubmit()}),e.dataset.listenerAttached="true")},_handleFormSubmit(){var p;const e=document.getElementById("activity-name-input"),t=document.getElementById("activity-category-select"),n=document.getElementById("muscle-group-select");if(!e||!t)return;const a=e.value.trim(),s=t.value,i=this._getSelectedActivityIcon(),o=s==="strength"&&n?n.value:null,r=this._getSelectedTrackingType(),l=r==="sets-reps"?((p=document.getElementById("units-select"))==null?void 0:p.value)||"none":null,d={name:a,categoryId:s,icon:i,muscleGroup:o,trackingType:r,units:l},c=document.getElementById("add-activity-modal"),u=c==null?void 0:c.dataset.editActivityId;u?As(u,d):ks(d),R("add-activity-modal")},_selectedActivityIcon:"🏃‍♂️",_selectedTrackingType:"time",_userManuallySelectedIcon:!1,_getSelectedActivityIcon(){return this._selectedActivityIcon},_setSelectedActivityIcon(e,t=!1){this._selectedActivityIcon=e,t&&(this._userManuallySelectedIcon=!0)},_getSelectedTrackingType(){return this._selectedTrackingType},_setSelectedTrackingType(e){this._selectedTrackingType=e},_buildActivityIconGrid(e){const t=["💪","🏃","🚴","🏊","🧘","⚖️","🍎","🥗","💧","☕","🥛","🍊","📚","📖","✏️","🎓","💡","🧠","💼","💻","📱","📊","📝","📋","😴","🛏️","🌙","⏰","🕐","⏱️","🎵","🎸","🎨","📷","🎮","🎯","🌱","🌳","🌸","🌞","🌍","♻️","👥","👪","❤️","🤝","📞","💬","🧼","🪥","🚿","💊","🧴","🎯","✈️","🚗","🚶","🗺️","🎒","📍","💰","💳","💎","📈","🏦","💸","⭐","🎉","🔥","⚡","✨","🚀"],n=e.querySelector("#activity-icon-grid");n&&(n.innerHTML="",t.forEach(a=>{const s=document.createElement("button");s.className="icon-option w-12 h-12 rounded-xl bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-xl hover:bg-ios-blue hover:text-white transition-all duration-200 hover:scale-105",s.dataset.icon=a,s.textContent=a,s.addEventListener("click",()=>{this._setSelectedActivityIcon(a,!0);const i=document.getElementById("activity-selected-icon-display");i&&(i.textContent=a)}),n.appendChild(s)}))},_updateActivityIconFromCategory(){const e=document.getElementById("activity-category-select");if(!(!e||!e.value)&&!this._userManuallySelectedIcon){const t=e.value;A(async()=>{const{getState:n}=await Promise.resolve().then(()=>Rn);return{getState:n}},void 0).then(({getState:n})=>{const s=n().activityCategories.find(i=>i.id===t);if(s&&s.icon){this._setSelectedActivityIcon(s.icon,!1);const i=document.getElementById("activity-selected-icon-display");i&&(i.textContent=s.icon)}})}},_initializeTrackingTypeToggles(){const e=document.getElementById("sets-reps-toggle"),t=document.getElementById("time-toggle"),n=document.getElementById("activity-category-select"),a=document.getElementById("units-section");if(!e||!t)return;const s=()=>{const i=n==null?void 0:n.value,o=this._getSelectedTrackingType();i==="sports"?(this._setSelectedTrackingType("time"),e.disabled=!0,t.disabled=!0,e.classList.add("opacity-50","cursor-not-allowed"),t.classList.add("opacity-50","cursor-not-allowed")):i==="strength"&&o==="time"?(this._setSelectedTrackingType("sets-reps"),e.disabled=!1,t.disabled=!1,e.classList.remove("opacity-50","cursor-not-allowed"),t.classList.remove("opacity-50","cursor-not-allowed")):(e.disabled=!1,t.disabled=!1,e.classList.remove("opacity-50","cursor-not-allowed"),t.classList.remove("opacity-50","cursor-not-allowed")),o==="sets-reps"?(e.classList.add("bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","border","border-gray-200","dark:border-gray-600","shadow-sm"),e.classList.remove("text-gray-600","dark:text-gray-400"),t.classList.remove("bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","border","border-gray-200","dark:border-gray-600","shadow-sm"),t.classList.add("text-gray-600","dark:text-gray-400"),a&&a.classList.remove("hidden")):(t.classList.add("bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","border","border-gray-200","dark:border-gray-600","shadow-sm"),t.classList.remove("text-gray-600","dark:text-gray-400"),e.classList.remove("bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","border","border-gray-200","dark:border-gray-600","shadow-sm"),e.classList.add("text-gray-600","dark:text-gray-400"),a&&a.classList.add("hidden"))};e.dataset.listenerAttached||(e.addEventListener("click",()=>{(n==null?void 0:n.value)!=="sports"&&(this._setSelectedTrackingType("sets-reps"),s())}),e.dataset.listenerAttached="true"),t.dataset.listenerAttached||(t.addEventListener("click",()=>{(n==null?void 0:n.value)!=="sports"&&(this._setSelectedTrackingType("time"),s())}),t.dataset.listenerAttached="true"),n&&!n.dataset.toggleListenerAttached&&(n.addEventListener("change",s),n.dataset.toggleListenerAttached="true"),s()},_handleDeleteActivity(e){if(confirm("Are you sure you want to delete this activity? This action cannot be undone.")){_s(e),R("add-activity-modal");const t=new CustomEvent("ActivityDeleted",{detail:{activityId:e}});document.dispatchEvent(t)}},_handleMuscleGroupVisibility(){const e=document.getElementById("activity-category-select"),t=document.getElementById("muscle-group-section"),n=document.getElementById("muscle-group-select");if(!e||!t)return;e.value==="strength"?(t.classList.remove("hidden"),n&&(n.required=!0)):(t.classList.add("hidden"),n&&(n.required=!1,n.value=""))}},Jt={open(e){const t=V(e);if(!t)return;const n=De(t.categoryId);this._populateActivityInfo(t,n),this._setupTrackingSection(t),this._storeActivityId(e),this._setupEventHandlers(),this._resetForm(),z("activity-details-modal")},openWithRecord(e,t){const n=V(e);if(!n)return;const a=De(n.categoryId);this._populateActivityInfo(n,a),this._setupTrackingSection(n),this._storeActivityId(e),this._storeRecordId(t.id),this._setEditMode(!0),this._populateRecordData(t),this._setupEventHandlers(),z("activity-details-modal")},_populateActivityInfo(e,t){const n=document.getElementById("activity-details-icon"),a=document.getElementById("activity-details-name"),s=document.getElementById("activity-details-category");n&&(n.textContent=e.icon||t.icon,n.style.backgroundColor=`${t.color}20`),a&&(a.textContent=e.name),s&&(s.textContent=t.name)},_setupTrackingSection(e){const t=document.getElementById("sets-reps-tracking-section"),n=document.getElementById("time-tracking-section");e.trackingType==="sets-reps"?(t&&t.classList.remove("hidden"),n&&n.classList.add("hidden")):(t&&t.classList.add("hidden"),n&&n.classList.remove("hidden"))},_storeActivityId(e){const t=document.getElementById("activity-details-modal");t&&(t.dataset.activityId=e)},_storeRecordId(e){const t=document.getElementById("activity-details-modal");t&&(t.dataset.recordId=e)},_setEditMode(e){const t=document.getElementById("activity-details-modal");t&&(t.dataset.editMode=e.toString())},_populateRecordData(e){if(e.sets&&e.sets.length>0)this._clearSets(),e.sets.forEach((n,a)=>{if(a===0){this._addNewSet(n.unit||"none");const s=document.querySelector('[data-set-id="set-1"]');if(s){const i=s.querySelector('input[name="reps-set-1"]'),o=s.querySelector('input[name="value-set-1"]'),r=s.querySelector('select[name="unit-set-1"]');i&&(i.value=n.reps||""),o&&(o.value=n.value||""),r&&(r.value=n.unit||"none")}}else{this._addNewSet(n.unit||"none");const s=`set-${a+1}`,i=document.querySelector(`[data-set-id="${s}"]`);if(i){const o=i.querySelector(`input[name="reps-${s}"]`),r=i.querySelector(`input[name="value-${s}"]`),l=i.querySelector(`select[name="unit-${s}"]`);o&&(o.value=n.reps||""),r&&(r.value=n.value||""),l&&(l.value=n.unit||"none")}}});else{const n=document.getElementById("activity-duration-input"),a=document.getElementById("duration-unit-select"),s=document.getElementById("activity-intensity-select");n&&(n.value=e.duration||""),a&&(a.value=e.durationUnit||"minutes"),s&&(s.value=e.intensity||"")}const t=document.getElementById("activity-notes-input");t&&(t.value=e.notes||"")},_resetForm(){const e=document.getElementById("activity-details-form");e&&e.reset(),this._clearSets();const t=document.getElementById("activity-details-modal"),n=t==null?void 0:t.dataset.activityId;if(n){const a=V(n);a&&a.trackingType==="sets-reps"&&this._addNewSet(a.units||"none")}},_bindSaveHandler(){const e=document.getElementById("save-activity-details");e&&!e.dataset.listenerAttached&&(e.addEventListener("click",t=>{t.preventDefault(),this._handleSave()}),e.dataset.listenerAttached="true")},_bindCancelHandler(){const e=document.getElementById("cancel-activity-details");e&&e.addEventListener("click",()=>{R("activity-details-modal")})},_bindSetsHandlers(){const e=document.getElementById("add-set-btn");e&&e.addEventListener("click",()=>{const n=document.getElementById("activity-details-modal"),a=n?n.dataset.activityId:null;if(!a)return;const s=V(a);s?this._addNewSet(s.units||"none"):this._addNewSet("none")});const t=document.getElementById("sets-container");t&&t.addEventListener("click",n=>{if(n.target.classList.contains("remove-set-btn")){const a=n.target.dataset.setId;this._removeSet(a)}})},_handleSave(){const e=document.getElementById("activity-details-modal");if(!e)return;const t=e.dataset.activityId,n=e.dataset.recordId,a=e.dataset.editMode==="true",s=V(t);if(!s)return;const i=this._collectRecordData(s);if(!i){console.warn("No valid data collected, not saving activity");return}A(async()=>{const{getLocalISODate:o}=await Promise.resolve().then(()=>ie);return{getLocalISODate:o}},void 0).then(({getLocalISODate:o})=>{const r=v().fitnessSelectedDate||new Date().toISOString(),l=o(r);a&&n?Ts(n,l,i):Ss(t,l,i),R("activity-details-modal");const d=new CustomEvent("ActivityRecorded",{detail:{activityId:t,recordData:i}});document.dispatchEvent(d)})},_collectRecordData(e){var n,a,s,i;const t={timestamp:new Date().toISOString(),notes:((n=document.getElementById("activity-notes-input"))==null?void 0:n.value)||""};if(e.trackingType==="sets-reps"){if(t.sets=this._collectSetsData(),!t.sets||t.sets.length===0)return console.warn("No valid sets found for sets-reps activity"),null}else{const o=(a=document.getElementById("activity-duration-input"))==null?void 0:a.value,r=(s=document.getElementById("duration-unit-select"))==null?void 0:s.value,l=(i=document.getElementById("activity-intensity-select"))==null?void 0:i.value;if(o&&o.trim()!=="")t.duration=o,t.durationUnit=r||"minutes";else return console.warn("No duration provided for time-based activity"),null;l&&(t.intensity=l)}return t},_collectSetsData(){const e=[];return document.querySelectorAll(".set-item").forEach((n,a)=>{const s=`set-${a+1}`,i=n.querySelector(`input[name="reps-${s}"]`),o=n.querySelector(`input[name="value-${s}"]`),r=n.querySelector(`select[name="unit-${s}"]`),l=i&&i.value?parseInt(i.value):null,d=o&&o.value?parseFloat(o.value):null,c=r?r.value:"none";l&&e.push({reps:l,value:d,unit:c})}),e},_clearSets(){const e=document.getElementById("sets-container");e&&(e.innerHTML="")},_addNewSet(e="none"){const t=document.getElementById("sets-container");if(!t)return;const n=t.children.length+1,a=`set-${n}`,s=document.createElement("div");s.className="set-item p-4 bg-gray-50 dark:bg-gray-700 rounded-xl space-y-3",s.dataset.setId=a,s.innerHTML=`
      <div class="flex items-center justify-between">
        <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Set ${n}</label>
        ${n>1?`<button type="button" class="remove-set-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-200 p-1" data-set-id="${a}">
          <span class="material-icons text-red-600 text-base">delete</span>
        </button>`:""}
      </div>
      <div class="grid grid-cols-3 gap-2">
        <div>
          <label class="block text-xs text-gray-600 dark:text-gray-400 mb-1">Reps</label>
          <input type="number" name="reps-${a}" min="1" max="999" placeholder="12" class="w-full px-3 py-2 bg-white dark:bg-gray-600 border border-gray-200 dark:border-gray-500 rounded-lg text-gray-900 dark:text-white text-sm focus:outline-none focus:ring-2 focus:ring-ios-blue/50 h-10 text-center">
        </div>
        <div>
          <label class="block text-xs text-gray-600 dark:text-gray-400 mb-1">Value</label>
          <input type="number" name="value-${a}" min="0" step="0.1" placeholder="50" class="w-full px-3 py-2 bg-white dark:bg-gray-600 border border-gray-200 dark:border-gray-500 rounded-lg text-gray-900 dark:text-white text-sm focus:outline-none focus:ring-2 focus:ring-ios-blue/50 h-10 text-center">
        </div>
        <div>
          <label class="block text-xs text-gray-600 dark:text-gray-400 mb-1">Unit</label>
          <select name="unit-${a}" class="w-full px-3 py-2 bg-white dark:bg-gray-600 border border-gray-200 dark:border-gray-500 rounded-lg text-gray-900 dark:text-white text-sm focus:outline-none focus:ring-2 focus:ring-ios-blue/50 h-10" style="text-align: center; text-align-last: center;">
            <option value="none" ${e==="none"?"selected":""}>None</option>
            <option value="kg" ${e==="kg"?"selected":""}>Kg</option>
            <option value="seconds" ${e==="seconds"?"selected":""}>s</option>
            <option value="minutes" ${e==="minutes"?"selected":""}>Mins</option>
          </select>
        </div>
      </div>
    `,t.appendChild(s);const i=s.querySelector(".remove-set-btn");i&&i.addEventListener("click",()=>{this._removeSet(a)})},_removeSet(e){const t=document.querySelector(`[data-set-id="${e}"]`);t&&(t.remove(),this._renumberSets())},_renumberSets(){const e=document.getElementById("sets-container");if(!e)return;e.querySelectorAll(".set-item").forEach((n,a)=>{const s=a+1,i=`set-${s}`;n.dataset.setId=i;const o=n.querySelector("label");o&&(o.textContent=`Set ${s}`);const r=n.querySelector('input[name^="reps-"]'),l=n.querySelector('input[name^="value-"]'),d=n.querySelector('select[name^="unit-"]');r&&(r.name=`reps-${i}`),l&&(l.name=`value-${i}`),d&&(d.name=`unit-${i}`);const c=n.querySelector(".remove-set-btn");c&&(c.dataset.setId=i),s===1?c&&(c.style.display="none"):c&&(c.style.display="block")})},_setupEventHandlers(){this._bindSaveHandler(),this._bindCancelHandler(),this._bindSetsHandlers()}};function Xs(e){const t=V(e);if(!t)return null;const n=[];if(Object.values(v().recordedActivities||{}).forEach(c=>{c.forEach(u=>{u.activityId===e&&n.push(u)})}),n.length===0)return{totalSessions:0,totalDuration:0,totalSets:0,totalReps:0,totalVolume:0,averageDuration:0,averageSets:0,averageReps:0,mostCommonIntensity:null,lastPerformed:null,bestSession:null,recentFrequency:0,weeklyAverage:0};n.sort((c,u)=>new Date(c.timestamp)-new Date(u.timestamp));const a={totalSessions:n.length,totalDuration:0,totalSets:0,totalReps:0,totalVolume:0,averageDuration:0,averageSets:0,averageReps:0,mostCommonIntensity:null,lastPerformed:n[n.length-1].timestamp,bestSession:null,recentFrequency:0,weeklyAverage:0};if(t.trackingType==="sets-reps"){let c=0,u=null;n.forEach(p=>{p.sets&&p.sets.length>0&&(a.totalSets+=p.sets.length,p.sets.forEach(y=>{if(y.reps&&(a.totalReps+=parseInt(y.reps)||0),y.value&&y.unit&&y.unit!=="none"){const k=parseFloat(y.value)||0,f=parseInt(y.reps)||0,E=k*f;a.totalVolume+=E,E>c&&(c=E,u=p)}}))}),a.averageSets=a.totalSets/a.totalSessions,a.averageReps=a.totalReps/a.totalSessions,a.bestSession=u}else{const c={};let u=0,p=null;n.forEach(y=>{if(y.duration){let k=parseInt(y.duration)||0;y.durationUnit==="hours"?k*=60:y.durationUnit==="seconds"&&(k/=60),a.totalDuration+=k,k>u&&(u=k,p=y)}y.intensity&&(c[y.intensity]=(c[y.intensity]||0)+1)}),a.averageDuration=a.totalDuration/a.totalSessions,a.bestSession=p,Object.keys(c).length>0&&(a.mostCommonIntensity=Object.entries(c).sort(([,y],[,k])=>k-y)[0][0])}const s=new Date;s.setDate(s.getDate()-30);const i=n.filter(c=>new Date(c.timestamp)>s);a.recentFrequency=i.length;const o=new Date(n[0].timestamp),d=Math.max(1,(new Date-o)/(1e3*60*60*24))/7;return a.weeklyAverage=a.totalSessions/d,a}function Js(e,t,n){if(t.totalSessions===0)return`
      <div class="text-center py-8">
        <span class="material-icons text-4xl text-gray-400 mb-4">bar_chart</span>
        <p class="text-gray-600 dark:text-gray-400">No recorded sessions yet</p>
        <p class="text-sm text-gray-500 mt-2">Start tracking this activity to see statistics</p>
      </div>
    `;let a=`
    <div class="stats-grid space-y-4">
      <!-- Overview Stats -->
      <div class="stats-section">
        <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Overview</h4>
        <div class="grid grid-cols-2 gap-4">
          <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            <div class="stat-value text-2xl font-bold text-gray-900 dark:text-white">${t.totalSessions}</div>
            <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Total Sessions</div>
          </div>
          <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            <div class="stat-value text-2xl font-bold text-gray-900 dark:text-white">${t.weeklyAverage.toFixed(1)}</div>
            <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Per Week Average</div>
          </div>
        </div>
      </div>
  `;if(e.trackingType==="sets-reps"){a+=`
      <div class="stats-section">
        <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Strength Metrics</h4>
        <div class="grid grid-cols-2 gap-4">
          <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${t.totalSets}</div>
            <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Total Sets</div>
          </div>
          <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${t.totalReps}</div>
            <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Total Reps</div>
          </div>
          <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${t.averageSets.toFixed(1)}</div>
            <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Avg Sets/Session</div>
          </div>
          <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${t.averageReps.toFixed(1)}</div>
            <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Avg Reps/Session</div>
          </div>
        </div>
        ${t.totalVolume>0?`
        <div class="mt-4">
          <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${t.totalVolume.toFixed(1)}</div>
            <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Total Volume (weight × reps)</div>
          </div>
        </div>
      `:""}
      </div>
    `;const s=ei(e.id);s.length>1&&(a+=`
        <div class="mt-6">
          <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Progression</h4>
          <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            ${ti(s,n.color,e)}
          </div>
        </div>`)}else a+=`
      <div class="stats-section">
        <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Duration Metrics</h4>
        <div class="grid grid-cols-2 gap-4">
          <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${gt(t.totalDuration)}</div>
            <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Total Duration</div>
          </div>
          <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
            <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${gt(t.averageDuration)}</div>
            <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Avg Duration</div>
          </div>
        </div>
        ${t.mostCommonIntensity?`
          <div class="mt-4">
            <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
              <div class="stat-value text-lg font-bold text-gray-900 dark:text-white capitalize">${t.mostCommonIntensity}</div>
              <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Most Common Intensity</div>
            </div>
          </div>
        `:""}
      </div>
    `;return a+=`
    <div class="stats-section">
      <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Recent Activity</h4>
      <div class="grid grid-cols-2 gap-4">
        <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
          <div class="stat-value text-xl font-bold text-gray-900 dark:text-white">${t.recentFrequency}</div>
          <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Last 30 Days</div>
        </div>
        <div class="stat-card bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
          <div class="stat-value text-sm font-bold text-gray-900 dark:text-white">${vt(t.lastPerformed)}</div>
          <div class="stat-label text-xs text-gray-500 dark:text-gray-400">Last Performed</div>
        </div>
      </div>
    </div>
  `,t.bestSession&&(a+=`
      <div class="stats-section">
        <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Best Session</h4>
        <div class="stat-card bg-gradient-to-r from-${n.color.slice(1)} to-${n.color.slice(1)} bg-opacity-10 p-4 rounded-lg border-2" style="border-color: ${n.color}40;">
          ${Qs(t.bestSession,e)}
          <div class="text-xs text-gray-500 dark:text-gray-400 mt-2">
            ${new Date(t.bestSession.timestamp).toLocaleDateString()}
          </div>
        </div>
      </div>
    `),a+="</div>",a}function Qs(e,t){var n,a;if(t.trackingType==="sets-reps"&&e.sets){const s=e.sets.reduce((o,r)=>{const l=parseFloat(r.value)||0,d=parseInt(r.reps)||0;return o+l*d},0),i=Math.max(...e.sets.map(o=>parseFloat(o.value)||0));return`
      <div class="text-sm font-semibold text-gray-900 dark:text-white">
        ${e.sets.length} sets • ${s.toFixed(1)} volume
      </div>
      <div class="text-xs text-gray-600 dark:text-gray-300">
        Max weight: ${i}${((n=e.sets[0])==null?void 0:n.unit)!=="none"&&((a=e.sets[0])==null?void 0:a.unit)||""}
      </div>
    `}else{let s="";if(e.duration){let i=e.duration,o=e.durationUnit||"minutes";o==="hours"?(i=i*60,o="minutes"):o==="seconds"&&(i=Math.round(i/60),o="minutes"),s=`${i} ${o==="minutes"?"min":o}`}return`
      <div class="text-sm font-semibold text-gray-900 dark:text-white">
        ${s}${e.intensity?` • ${e.intensity} intensity`:""}
      </div>
      <div class="text-xs text-gray-600 dark:text-gray-300">
        Longest duration session
      </div>
    `}}function Zs(e){const t=[];Object.values(v().recordedActivities||{}).forEach(n=>{n.forEach(a=>{a.activityId===e&&a.sets&&t.push(a)})});for(let n=t.length-1;n>=0;n--){const a=t[n];if(a.sets&&a.sets.length>0){const s=a.sets.find(i=>i.unit&&i.unit!=="none");if(s&&s.unit)return s.unit}}return"lbs"}function ei(e){const t=V(e);if(!t||t.trackingType!=="sets-reps")return[];const n=[];if(Object.values(v().recordedActivities||{}).forEach(s=>{s.forEach(i=>{i.activityId===e&&n.push(i)})}),n.length===0)return[];n.sort((s,i)=>new Date(s.timestamp)-new Date(i.timestamp));const a=[];return n.forEach(s=>{if(!s.sets||s.sets.length===0)return;const i=Math.max(...s.sets.map(r=>{const l=parseFloat(r.value);return isNaN(l)?0:l}),0),o=s.date;a.push({date:o,value:i})}),a}function ti(e,t="#3b82f6",n=null){if(!e||e.length<2)return"";const a=320,s=200,i={top:20,right:30,bottom:50,left:70},o=a-i.left-i.right,r=s-i.top-i.bottom,l=Math.max(...e.map(w=>w.value)),d=Math.min(...e.map(w=>w.value)),c=l===d?1:l-d,u=Math.max(0,d-c*.1),y=l+c*.1-u,k=4,f=[];for(let w=0;w<=k;w++){const I=u+w*y/k;f.push(Math.round(I*10)/10)}const E=e.map((w,I)=>{const _=i.left+I/(e.length-1)*o,T=i.top+r-(w.value-u)/y*r;return`${_.toFixed(1)},${T.toFixed(1)}`}).join(" "),m=e.map((w,I)=>{const _=i.left+I/(e.length-1)*o,T=i.top+r-(w.value-u)/y*r;return`<circle cx="${_}" cy="${T}" r="4" fill="${t}" stroke="white" stroke-width="2"/>`}).join(""),b=f.map((w,I)=>{const _=i.top+r-I/(f.length-1)*r;return`
        <line x1="${i.left}" y1="${_}" x2="${i.left+o}" y2="${_}" stroke="#e5e7eb" stroke-width="1" opacity="0.5"/>
        <text x="${i.left-8}" y="${_+4}" text-anchor="end" font-size="11" font-weight="500" fill="currentColor" class="text-gray-700 dark:text-gray-300">${w}</text>
      `}).join(""),h=e.length>8?Math.ceil(e.length/6):1,g=e.map((w,I)=>{if(I%h!==0&&I!==e.length-1&&I!==0)return"";const _=i.left+I/(e.length-1)*o,T=i.top+r+20,C=new Date(w.date),$=`${C.getDate().toString().padStart(2,"0")}/${(C.getMonth()+1).toString().padStart(2,"0")}`;return`
        <line x1="${_}" y1="${i.top+r}" x2="${_}" y2="${i.top+r+6}" stroke="currentColor" stroke-width="1" class="text-gray-400"/>
        <text x="${_}" y="${T}" text-anchor="middle" font-size="10" font-weight="500" fill="currentColor" class="text-gray-700 dark:text-gray-300">${$}</text>
      `}).join(""),S=n?Zs(n.id):"lbs";return`
    <div class="w-full">
      <svg viewBox="0 0 ${a} ${s}" class="w-full h-40 text-gray-600 dark:text-gray-400">
        <!-- Y-axis grid lines and labels -->
        ${b}
        
        <!-- X-axis -->
        <line x1="${i.left}" y1="${i.top+r}" x2="${i.left+o}" y2="${i.top+r}" stroke="currentColor" stroke-width="2" class="text-gray-500"/>
        
        <!-- Y-axis -->
        <line x1="${i.left}" y1="${i.top}" x2="${i.left}" y2="${i.top+r}" stroke="currentColor" stroke-width="2" class="text-gray-500"/>
        
        <!-- X-axis labels and tick marks -->
        ${g}
        
        <!-- Y-axis label (vertical) -->
        <text x="15" y="${i.top+r/2}" text-anchor="middle" font-size="11" font-weight="600" fill="currentColor" class="text-gray-700 dark:text-gray-300" transform="rotate(-90, 15, ${i.top+r/2})">Max Weight (${S})</text>
        
        <!-- X-axis label (horizontal) -->
        <text x="${i.left+o/2}" y="${s-10}" text-anchor="middle" font-size="11" font-weight="600" fill="currentColor" class="text-gray-700 dark:text-gray-300">Session Dates</text>
        
        <!-- Data line with gradient effect -->
        <defs>
          <linearGradient id="lineGradient-${(n==null?void 0:n.id)||"default"}" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" style="stop-color:${t};stop-opacity:0.8" />
            <stop offset="100%" style="stop-color:${t};stop-opacity:1" />
          </linearGradient>
        </defs>
        
        <!-- Data line -->
        <polyline
          fill="none"
          stroke="url(#lineGradient-${(n==null?void 0:n.id)||"default"})"
          stroke-width="3"
          stroke-linecap="round"
          stroke-linejoin="round"
          points="${E}"/>
        
        <!-- Data points -->
        ${m}
      </svg>
    </div>
  `}const ni={open(e){const t=this._getActivity(e);if(!t)return;const n=Xs(e),a=De(t.categoryId);this._createModal(t,n,a),this._bindCloseHandlers(),this._showModal()},_getActivity(e){var t;return(t=v().activities)==null?void 0:t.find(n=>n.id===e)},_createModal(e,t,n){const a=`
      <div id="activity-stats-modal" class="modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="modal-content bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] flex flex-col">
          <div class="modal-header flex-shrink-0 flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700">
            <div class="flex items-center gap-3">
              <div class="activity-icon w-10 h-10 rounded-full flex items-center justify-center text-xl" style="background-color: ${n.color}20; color: ${n.color};">
                ${e.icon||n.icon}
              </div>
              <div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">${e.name}</h3>
                <p class="text-sm text-gray-500 dark:text-gray-400">Activity Statistics</p>
              </div>
            </div>
            <button id="close-stats-modal" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M6 18L18 6M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </button>
          </div>
          
          <div class="modal-body flex-1 overflow-y-auto p-4">
            ${Js(e,t,n)}
          </div>
        </div>
      </div>
    `,s=document.getElementById("activity-stats-modal");s&&s.remove(),document.body.insertAdjacentHTML("beforeend",a)},_bindCloseHandlers(){const e=document.getElementById("activity-stats-modal"),t=document.getElementById("close-stats-modal"),n=()=>{e&&(e.classList.add("hidden"),setTimeout(()=>e.remove(),300))};t&&t.addEventListener("click",n),e&&e.addEventListener("click",a=>{a.target===e&&n()})},_showModal(){const e=document.getElementById("activity-stats-modal");e&&e.classList.remove("hidden")}},F={openAddActivity(){Xt.openAddMode()},openEditActivity(e){Xt.openEditMode(e)},openActivityDetails(e){Jt.open(e)},openActivityDetailsWithRecord(e,t){Jt.openWithRecord(e,t)},openStats(e){ni.open(e)}};let Qt=!1;async function Tt(){if(Qt)return;Qt=!0,ai(),si();const e=new Date;e.setHours(0,0,0,0);const t=Q(e);D(L.setFitnessSelectedDate(t));const n=document.getElementById("fitness-view");if(!n)return;await X.mount(n,{onNewActivity:()=>F.openAddActivity(),onSearchActivityClick:s=>F.openActivityDetails(s),onStatsClick:s=>F.openStats(s),onEditClick:s=>F.openEditActivity(s),onActivityClick:s=>F.openActivityDetails(s),onDateChange:s=>{D(L.setFitnessSelectedDate(Q(s))),P.ready&&P.scrollToSelected&&P.ready.then(()=>{P.scrollToSelected({instant:!0})}),X.updateRestToggle()},onRestToggle:()=>{P.ready&&P.scrollToSelected&&P.ready.then(()=>{P.scrollToSelected({instant:!0})}),X.renderActivities((s,i)=>{i?F.openActivityDetailsWithRecord(s,i):F.openActivityDetails(s)})}}),P.ready&&P.scrollToSelected&&(await P.ready,P.scrollToSelected({instant:!0}));let a=v().fitnessSelectedDate;_e(()=>{X.renderActivities((s,i)=>{i?F.openActivityDetailsWithRecord(s,i):F.openActivityDetails(s)}),X.updateTimerButton(),v().fitnessSelectedDate!==a&&(a=v().fitnessSelectedDate,X.updateRestToggle())}),X.renderActivities((s,i)=>{i?F.openActivityDetailsWithRecord(s,i):F.openActivityDetails(s)}),X.setupResponsiveBehavior(),ht.bindEvents(),document.addEventListener("ActivityRecorded",()=>{X.renderActivities((s,i)=>{i?F.openActivityDetailsWithRecord(s,i):F.openActivityDetails(s)})})}function ai(){localStorage.getItem("habitsAppFitnessMigrationV1")!=="true"&&(D((e,t)=>{const a=t().categories.filter(i=>!i.id.startsWith("fitness-")),s=[{id:"cardio",name:"Cardio",icon:"❤️",color:"#ef4444"},{id:"strength",name:"Strength",icon:"💪",color:"#3b82f6"},{id:"stretching",name:"Stretching",icon:"🧘‍♀️",color:"#10b981"},{id:"sports",name:"Sports",icon:"⚽",color:"#f59e0b"},{id:"other",name:"Other",icon:"🎯",color:"#eab308"}];e(L.importData({categories:a,activityCategories:s}))}),localStorage.setItem("habitsAppFitnessMigrationV1","true"))}function si(){if(localStorage.getItem("habitsAppFitnessMigrationV1")==="true")return;const e=["Running","Push-ups","Squats","Yoga","Basketball","Swimming"];D((t,n)=>{const s=n().activities.filter(i=>!e.includes(i.name));t(L.importData({activities:s}))}),localStorage.setItem("habitsAppFitnessMigrationV1","true")}async function Tn(){await Tt()}const ii={init:Tn},oi=Object.freeze(Object.defineProperty({__proto__:null,FitnessModule:ii,init:Tn,initializeFitness:Tt},Symbol.toStringTag,{value:"Module"}));let de={selectedDate:null,selectedGroup:null,habitsHash:null,holidayHash:null,result:null};function ri(e,{start:t,end:n}){if(typeof e.target=="number"&&e.target>0){let o=!1,r=0;for(const l of ut(t,n)){const d=new Date(l);if(W(e,d)&&!ve(e,d)&&(o=!0,G(e,d))){r=1;break}}return{completed:r,active:o?1:0}}let s=0,i=0;for(const o of ut(t,n)){const r=new Date(o);if(W(e,r)&&!ve(e,r)&&(i++,G(e,r)&&s++,i>0&&s===i))break}return{completed:s,active:i}}function li(e,t=new Date){const a={daily:"day",weekly:"week",monthly:"month",yearly:"year"}[e];if(!a)throw new Error(`Unknown group: ${e}`);const s=tn(a,t),i=v().habits.filter(d=>Je(d,e));let o=0,r=0;for(const d of i){const{completed:c,active:u}=ri(d,s);o+=c,r+=u}return{percentage:r>0?Math.round(o/r*100):0,completed:o,active:r}}function bi(){const e=new Date(v().selectedDate),t=JSON.stringify(v().habits.map(r=>({id:r.id,completed:r.completed,skipped:r.skipped}))),n=JSON.stringify(v().holidayDates);if(de.selectedDate===v().selectedDate&&de.selectedGroup===v().selectedGroup&&de.habitsHash===t&&de.holidayHash===n)return de.result;const s=v().habits.filter(r=>Je(r,v().selectedGroup)&&W(r,e)).filter(r=>!ve(r,e)),i=s.filter(r=>G(r,e)),o=s.length?i.length/s.length*100:0;return de={selectedDate:v().selectedDate,selectedGroup:v().selectedGroup,habitsHash:t,holidayHash:n,result:o},o}const ci=["daily","weekly","monthly","yearly"];function di(){const e=document.querySelector("#home-view .progress-section");if(!e)return;let t=e.querySelector(".progress-pills");t||(t=document.createElement("div"),t.className="progress-pills absolute right-4 top-1/2 -translate-y-1/2 flex flex-col items-center gap-1",e.appendChild(t)),t.innerHTML="";const n=new Date;ci.forEach(a=>{if(a===v().selectedGroup)return;const s=li(a,n);if(s.active===0)return;const i=document.createElement("span");i.setAttribute("data-group",a),i.className="progress-pill relative overflow-hidden py-1.5 rounded-full text-xs font-medium",i.textContent=`${j(a)} (${s.percentage}%)`;const o=yn(s.percentage),r="#e5e5e7";i.style.background=`linear-gradient(to right, ${o} ${s.percentage}%, ${r} ${s.percentage}%)`,i.style.color="#000",i.style.border="1px solid #4B5563",i.style.width="110px",i.style.minWidth="110px",i.style.maxWidth="110px",i.style.whiteSpace="nowrap",i.style.textAlign="center",i.style.fontSize="11px",i.style.lineHeight="1.2",i.style.paddingLeft="0",i.style.paddingRight="0",t.appendChild(i)}),t.style.display=t.children.length?"flex":"none"}function ui(){di()}function _n(){const e=v(),t=new Date,n=e.selectedGroup||"daily",a=new Date(e.selectedDate);ye(t,a,n)||A(async()=>{const{getLocalMidnightISOString:o}=await Promise.resolve().then(()=>ie);return{getLocalMidnightISOString:o}},void 0).then(({getLocalMidnightISOString:o})=>{D(L.setSelectedDate(o(t))),ui()});const i=nn(t,n).getTime()-t.getTime()+1e3;setTimeout(_n,i)}_n();typeof window<"u"&&new URLSearchParams(window.location.search).get("test")==="true"&&(window.process=window.process||{},window.process.env=window.process.env||{},window.process.env.NODE_ENV="test");async function Zt(){try{await jn(),await Un(),await Wn(),await Sn(),await A(()=>Promise.resolve().then(()=>na),void 0).then(t=>t.initializeHolidays()),await Tt(),await A(()=>import("./stats-B_Yw9SmN.js"),__vite__mapDeps([3,1])).then(t=>t.initializeStats()),await as();const e=document.getElementById("theme-toggle");e&&e.addEventListener("click",zn),A(async()=>{const{removeLoadingState:t}=await Promise.resolve().then(()=>Cn);return{removeLoadingState:t}},void 0).then(({removeLoadingState:t})=>t())}catch(e){console.error("Bootstrap failed:",e)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Zt):Zt();export{L as A,R as B,mi as C,Te as D,En as E,Se as F,Is as G,hi as H,pt as I,ta as J,On as K,Zn as L,Qn as M,ea as N,ie as O,Rn as P,na as Q,pi as R,Wa as S,es as T,Ie as a,Je as b,ft as c,W as d,cs as e,gt as f,v as g,_a as h,G as i,j,Y as k,D as l,ss as m,vi as n,bi as o,di as p,kt as q,Ze as r,_e as s,Ys as t,ca as u,ui as v,yi as w,Qe as x,fi as y,z};
